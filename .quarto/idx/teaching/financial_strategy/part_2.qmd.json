{"title":"Estratégia Financeira","markdown":{"yaml":{"title":"Estratégia Financeira","subtitle":" **Part 2 - ch.10 Capital Markets and the Pricing of Risk** ","author":[{"name":" **Henrique C. Martins** ","affiliation":"**[![](figs/background6.png){width=300px}](https://eaesp.fgv.br/en)**"}],"date":"last-modified","date-format":"DD-MM-YYYY","title-block-banner":true,"format":{"revealjs":{"slide-number":true,"theme":"simple","chalkboard":true,"preview-links":"auto","logo":"figs/background8.png","css":"logo.css","footer":" **[**Henrique C. Martins**] [[henrique.martins@fgv.br](mailto:henrique.martins@fgv.br)] [[Teaching Resources](https://henriquemartins.net/teaching/)] [[Comments](https://henriquemartins.net/teaching/financial_strategy/part_2.html#/comments)]** ","multiplex":true,"scrollable":true}},"title-slide-attributes":{"data-background-color":"#b1cafa"},"include-after":"<script type=\"text/javascript\">\n  Reveal.on('ready', event => {\n    if (event.indexh === 0) {\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n  });\n  Reveal.addEventListener('slidechanged', (event) => {\n    if (event.indexh === 0) {\n      Reveal.configure({ slideNumber: null });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n    if (event.indexh === 1) {\n      Reveal.configure({ slideNumber: 'c' });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = null;\n    }\n  });\n</script>\n"},"headingText":"library(reticulate)","containsRefs":false,"markdown":"\n\n\n```{r setup}\n#| include: false\n#| warning: false\napi_key <- \"kfqxH5NsN8Nhe_U1NADB\"\n# use_python(\"C:/Users/hcmrt/AppData/Local/Programs/Python/Python310/python.exe\")\nlibrary(reticulate)\n#reticulate::py_install(\"matplotlib\")\n#reticulate::py_install(\"seaborn\")\n#reticulate::py_install(\"pyfinance\")\n#reticulate::py_install(\"xlrd\")\n#reticulate::py_install(\"quandl\")\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n```\n\n\n\n\n# Intro {visibility=\"hidden\"}\n\n## {background-image=\"figs/ch10.png\" background-size=\"1300px\"}\n\n\n\n\n\n\n## Chapter outline \n\n10.1 Risk and Return: Insights from History\n\n10.2 Common Measures of Risk and Return\n\n10.3 Historical Returns of Stocks and Bonds\n\n10.4 The Historical Trade-Off Between Risk and Return\n\n10.6 Diversification in Stock Portfolios\n\n10.7 Measuring Systematic Risk\n\n10.8 Beta and the Cost of Capital\n\n\n\n\n\n\n\n\n\n\n# 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n![](figs/bm_10_1.png){width=\"105%\"}\n\n\n\n\n\n\n\n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n**Some Insights:**\n\n- Small stocks had the highest long-term return, while T-Bills had the lowest.\n\n- Small stocks had the largest fluctuations in price, while T-Bills had the lowest.\n  - **Higher risk requires a higher return.**\n\n. . .\n\n- **But, few people ever make an investment for so many years**.\n\n- More realistic **investment horizons** and different initial investment dates can greatly influence each investment's risk and return.\n\n. . .\n\nNotice the volatility next slide.\n\n\n\n\n\n\n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n![](figs/bm_10_2.png){width=\"105%\"}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (1995-2023).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n#Ibov\nstock<-'^BVSP' \nstart<-'1995-01-01' \nend   <- Sys.Date() \nibov <- yf_get(tickers = stock,first_date = start,last_date = end)\nibov<- ibov[order(as.numeric(ibov$ref_date)),]\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices -1\n\n#Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date , format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252* 100)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic)<- \"selic_return\"\nfor(i in (2:nrow(selic))) {\nreturn_selic[i,1] <- Return.cumulative( selic$selic[1:i] )\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov ,selic, by=c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\ngeom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\ngeom_line(aes(y = selic_return, colour = \"Selic\")) +\nlabs(y='Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns  Ibov, and Selic (1995-2023)\")\nggplotly(p)\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\n\nstock = \"^BVSP\"\nstart = \"1995-01-01\"\nend = pd.Timestamp.now()\n\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Value': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (1995-2023)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (2002-2007).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n# Ibov\nstock <- '^BVSP'\nstart <- '2002-01-01'  # Adjusted start date\nend <- '2007-12-31'   # Adjusted end date\nibov <- yf_get(tickers = stock, first_date = start, last_date = end)\nibov <- ibov[order(as.numeric(ibov$ref_date)),]\n\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices - 1\n\n# Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date, format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252 * 100)\n\n# Filter Selic data for the desired period (2010-2020)\nselic <- selic %>% filter(ref_date >= start & ref_date <= end)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic) <- \"selic_return\"\nfor (i in (2:nrow(selic))) {\n  return_selic[i, 1] <- Return.cumulative(selic$selic[1:i])\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov, selic, by = c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\n  geom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\n  geom_line(aes(y = selic_return, colour = \"Selic\")) +\n  labs(y = 'Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns Ibov, and Selic (2002-2007)\")\nggplotly(p)\n\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\n\nstock = \"^BVSP\"\nstart = \"2002-01-01\"\nend = \"2007-12-31\"\n\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Adj Close': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Ibovespa\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n\n# Filter Selic data for the desired period\nselic = selic[(selic['ref_date'] >= start) & (selic['ref_date'] <= end)]\n\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (2002-2007)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n\n\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (2010-2018).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n# Ibov\nstock <- '^BVSP'\nstart <- '2010-01-01'  # Adjusted start date\nend <- '2018-12-31'   # Adjusted end date\nibov <- yf_get(tickers = stock, first_date = start, last_date = end)\nibov <- ibov[order(as.numeric(ibov$ref_date)),]\n\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices - 1\n\n# Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date, format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252 * 100)\n\n# Filter Selic data for the desired period (2010-2020)\nselic <- selic %>% filter(ref_date >= start & ref_date <= end)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic) <- \"selic_return\"\nfor (i in (2:nrow(selic))) {\n  return_selic[i, 1] <- Return.cumulative(selic$selic[1:i])\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov, selic, by = c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\n  geom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\n  geom_line(aes(y = selic_return, colour = \"Selic\")) +\n  labs(y = 'Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns Ibov, and Selic (2010-2018)\")\nggplotly(p)\n\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\nstock = \"^BVSP\"\nstart = \"2010-01-01\"\nend = \"2018-12-31\"\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Adj Close': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Ibovespa\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n# Filter Selic data for the desired period\nselic = selic[(selic['ref_date'] >= start) & (selic['ref_date'] <= end)]\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (2010-2018)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n# 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nWhen an investment is risky, it may earn **different returns**. \n\nEach possible return has some **likelihood of occurring**. \n\nThis information is summarized with a **probability distribution**, which assigns a probability, $P_r$ , that each possible return, $R$, will occur.\n\n. . .\n\nAssume BFI stock currently trades for 100 per share. In one year, there is a 25% chance the share price will be 140, a 50% chance it will be 110, and a 25% chance it will be 80. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nThis insight will lead to this kind of graph.\n\n![](figs/bm_10_3.jpg){width=\"90%\"}\n\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Let's see how to compute the expected return on this asset.**\n\n$$Expected\\;return = E[R] = \\sum_{R} P_R \\times R$$\n\n$$E[R_{BFI}] = 25\\%(−0.20) + 50\\%(0.10) + 25\\%(0.40) = 10\\%$$\n\n. . .\n\nVery important: there is an **underlying assumption** that the **past is good enough to teach us about the future.**\n\nThat is, we are computing the historical average return and **using this number as the best estimate of the expected return.**\n\n**Keep that assumption in mind.**\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Now risk: variance and standard deviation.**\n\n$$Var(R) = E[(R-E[R])^2]   = \\sum_{R} P_R \\times (R-E[R])^2 $$\n\n$$SD(R) = \\sqrt{Var(R)}$$\n\n. . .\n\n$$V(R)  = 0.25 × (−0.2 − 0.1)^2  + 0.5 × (0.1 − 0.1)^2 + 0.25 × (0.4 − 0.1)^2  = 0.045$$\n\n\n$$SD(R_{BFI}) = \\sqrt{0.045} = 21.2\\%$$\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nSuppose AMC stock is equally likely to have a 45% return or a −25% return. What are the expected return and volatility?\n\n. . .\n\n$$E[R] = 50\\%×0.45+50\\%×(−0.25)=10.0\\%$$\n\n. . .\n\n$$Var[R] = 50\\%×(0.45−0.10)^2+50\\%×(−0.25−0.10)^2=0.1225$$\n\n. . .\n\n$$SD[R] = (0.1225) ^{0.5} = 35\\%$$\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**It is clear that riskier assets have heavier tails.**\n\n![](figs/bm_10_4.png){width=\"110%\"}\n\n\n\n. . .\n\n**Warning: Standard deviation and variance are correct measures of total risk _if the returns are normally distributed_**.\n\n\n\n\n\n\n\n\n## {.smaller  background=\"#cff5ce\"}\n\n**IBOV returns seem to follow a normal distribution.**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot(ibov,aes(ibov$ret_closing_prices))+\n        geom_histogram(color='#006600',\n                       bins = 100) + \n        labs(x = \"\",\n             y='Daily return', \n             title=\"IBOV\") +   theme_solarized()\nggplotly(p)\n```\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Value': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nplt.close()\nplt.hist(ibov['return'], bins=100, color='grey')\nplt.title('IBOV', fontsize=20)\nplt.ylabel('Daily return', fontsize=16 )\nplt.show()\n\n```\n\n\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Standard deviation through time. It changes.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nibov$sd <- roll_sd(ibov$ret_closing_prices,  \n                     width = 100,  \n                     min_obs = 100 ) * sqrt(250)\np<-ggplot(ibov,aes(ref_date,sd))+\n        geom_line(color='#2986cc') + \n        labs(x = \"\",\n             y='Standard deviation using 100 daily returns', \n             title=\"IBOV (Daily returns since 2010)\") +   theme_solarized()\nggplotly(p)\n```\n\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport yfinance as yf\nstock = \"^BVSP\"\nstart = \"2010-01-01\"\nend = pd.Timestamp.now()\nibov = yf.download(stock, start=start, end=end)\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nibov['rolling_sd'] = ibov['return'].rolling(window=100, min_periods=100).std() * (250 ** 0.5)\nplt.close()\nfig, ax = plt.subplots(figsize=(20,10))\nax.plot(ibov.index, ibov['rolling_sd'], color='#2986cc')\nax.set_xlabel('')\nax.set_ylabel('Standard deviation using 100 daily returns', fontsize=13)\nax.set_title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Standard deviation through time. Riskier is riskier.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstocks <-c('AMER3.SA' ) \namer <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end)\namer<-amer[complete.cases(amer),]\namer$sd <- roll_sd(amer$ret_closing_prices,  \n                     width = 100,  \n                     min_obs = 100 ) * sqrt(250)\nibov <- subset(ibov, ref_date >= as.Date(\"2010-01-05\"))\n\np<-ggplot() + \n  geom_line(data=amer, aes(ref_date, sd), color='#801e00') +\n  geom_line(data=ibov, aes(ref_date, sd), color='#2986cc') +\n          labs(x = \"\",y='Standard deviation using 100 daily returns', \n             title=\"IBOV vs AMER3 (Daily returns since 2010)\") +   theme_solarized()\nggplotly(p)\n```\n\n\n###  Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nstock = \"AMER3.SA\"\n# Get data for IBOV\namer = yf.download(stock, start=start, end=end)\namer = amer.reset_index()\namer = amer.sort_values(\"Date\")\namer = amer.rename(columns={'Date': 'ref_date', 'Value': 'Americanas'})\namer[\"return\"] = amer[\"Adj Close\"].pct_change() \namer = amer.dropna()\namer['sd'] = amer['return'].rolling(window=100, min_periods=100).std() \namer['sd'] = amer['sd'] * np.sqrt(250)\n\nplt.close()\nfig, ax = plt.subplots(figsize=(20,10))\nax.plot(ibov.index, ibov['sd'], color='#2986cc')\nax.plot(amer.index, amer['sd'], color='darkred')\nax.set_xlabel('')\nax.set_ylabel('Standard deviation using 100 daily returns', fontsize=15)\nax.set_title('IBOV vs AMER3 (Daily returns since 2010)', fontsize=14)\nplt.show()\n```\n\n\n\n:::\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Daily returns IBOV.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot(ibov,aes(ibov$ref_date,ibov$ret_closing_prices))+\n        geom_line(color='#2986cc') + \n        labs(x = \"\",\n             y='Daily returns', \n             title=\"IBOV (Daily returns since 2010)\")   +   theme_solarized()  \nggplotly(p)\n```\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nplt.close()\nplt.plot(ibov['ref_date'], ibov['return'], color='#2986cc')\nplt.xlabel('')\nplt.ylabel('Daily returns', fontsize=14)\nplt.title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Daily returns Americanas.**\n\n::: {.panel-tabset}\n\n### R \n\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot() +\n  geom_line(data=amer, aes(amer$ref_date, amer$ret_closing_prices), color='#801e00') +\n  geom_line(data=ibov, aes(ibov$ref_date, ibov$ret_closing_prices), color='#2986cc') +\n  labs(x = \"\", y='Daily returns') +\n  ggtitle(\"IBOV vs AMER3 (Daily returns since 2010)\") +\n  theme_solarized()\nggplotly(p)      \n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nplt.close()\nplt.plot(amer['ref_date'], amer['return'], color='#801e00')\nplt.plot(ibov['ref_date'], ibov['return'], color='#2986cc')\nplt.xlabel('')\nplt.ylabel('Daily returns', fontsize=14)\nplt.title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Americanas seems riskier than ITUB.** Some stocks have heavier tails than others. The stock with the heavier tail is riskier.\n\n::: {.panel-tabset}\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstocks <-c('AMER3.SA', 'ITUB3.SA') \nstart <-'2012-01-01' \nend   <- Sys.Date() \ndata <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end)\ndata<-data[complete.cases(data),] \np<-ggplot(data, aes(ret_closing_prices,  fill = ticker)) + \n        geom_histogram(bins = 100, alpha = 0.35, position='identity') + \n        labs(x = \"\",\n             y='Daily returns', \n             title=\"Daily returns (2012-2023)\",\n             subtitle = start)+\n      xlim(-0.1,0.1) +   theme_solarized()\nggplotly(p)\n```\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nstart = '2012-01-01'\nend = pd.Timestamp.now()\nasset1 = yf.download('AMER3.SA', start=start, end=end)\nasset1 = asset1.dropna()\nasset1['return'] = asset1[\"Adj Close\"].pct_change()\nasset2 = yf.download('ITUB3.SA', start=start, end=end)\nasset2 = asset2.dropna()\nasset2['return'] = asset2[\"Adj Close\"].pct_change()\ndf = pd.merge(asset1[['return']], asset2[['return']], on=\"Date\")\n#plot\nplt.close()\nplt.figure(figsize=(20,10))\nplt.hist(df['return_x'], bins=400, alpha=0.5, label=\"AMER3.SA\", density=True)\nplt.hist(df['return_y'], bins=400, alpha=0.5, label=\"ITUB3.SA\", density=True)\nplt.title('Daily returns (2012-2023)', fontsize=25)\nplt.ylabel('Daily returns', fontsize=20)\nplt.legend(loc='upper left', fontsize=20)\nplt.xlim(-0.1, 0.1)\nplt.show()\n```\n\n\n:::\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Keep in mind:** There is variation (heterogeneity) in the level of **standard deviation** across countries.\n\n![](figs/bre13901_0707.jpg){width=\"85%\"}\n\nSource: Brealey, Myers and Allen (13ed)\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nThe previous problem was a simple one-time-ahead example (i.e., we computed the expected return one period ahead). \n\nA more realistic one is to **compute historical returns**:\n\n$$R_{t+1} = \\frac{Div_{t+1} + P_{t+1}}{P_t} - 1$$ \n\nThis is:\n\n**Dividend Yield + Capital Gain Rate**\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\n**Calculating realized annual returns**\n\nIf a stock pays dividends at the end of each quarter (with realized returns RQ1, RQ2, RQ3, and RQ4 each quarter), then its annual realized return, $R_{annual}$, is computed as follows:\n\n$$(1 + 𝑅_{annual})   = (1+𝑅_{Q1})\\times(1+𝑅_{Q2})\\times(1+ 𝑅_{Q3})\\times (1+𝑅_{Q4})$$\n\n- You can also compute using a daily time horizon (not manually, but by software).\n\n. . .\n\n**One important piece of information you need:**\n\n- You should know whether the return is calculated adjusted by dividends (they usually are, but always ask).\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nCompute the annual returns of this stock.\n\n![](figs/bm_10_ex1.png){width=\"100%\"}\n\n. . .\n\n$$𝑅_{2012}=(1.0513)(1.0449)(0.7626)(1.1375)(0.9714)−1=−7.43\\%$$\n\n$$𝑅_{2016}=(0.8499)(0.8409)(1.0811)(0.440)−1=−66.0\\%$$\n\n**Notice that the first example is not quarterly.**\n\n\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nCompute the annual returns of this stock.\n\n![](figs/bm_10_ex1.png){width=\"100%\"} \n\n**Also notice that, since the firm did not pay dividends in 2016, you can compute:**\n\n$$\\frac{2.29}{6.73}-1 = -66\\%$$\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" visibility=\"hidden\"}\n\n![](figs/bm_10_5.jpg){width=\"80%\"}\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Average annual return**\n\nThe average annual return of an investment during some historical period is simply the average of the realized returns for each year.\n\n$$\\tilde{R}  =  \\frac{1}{T} (𝑅_1  + 𝑅_2  + ⋯ + 𝑅_𝑇)  =  \\frac{1}{T} \\sum_{t=1}^{T} R_t$$\n\n. . .\n\n**Variance estimate using realized returns**\n\n$$Var[R] =  \\frac{1}{T-1} \\sum_{t=1}^{T} (R_t- \\tilde{R})^2 $$\n$$SD(R) = \\sqrt{Var(R)}$$\n\n**Warning: because you are using a sample of historical returns (instead of the population) there is a T-1 in the variance formula**.\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Historical Returns: standard error** \n\nWe can use a security’s historical average return to estimate its actual expected return. However, the average return is just an estimate of the expected return.\n\n- **Standard Error**\n  - A statistical measure of the degree of estimation error of a statistical estimate\n\n_The average return is just an estimate of the true expected return, and is subject to estimation error._\n\nYou can compute the standard error as\n\n$$SE = \\frac{Standard\\; deviation}{\\sqrt{n\\;of\\; observations}}$$\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Historical Returns: standard error** \n\nUsing BM p.367 example. \n\n**For example, from 1926 to 2017 the average return of the S&P 500 was 12.0% with a volatility of 19.8%.**\n\n$$E[R] \\pm 2\\times SE = 12\\% \\pm \\frac{19.8\\%}{\\sqrt{92}}= 12\\% \\pm 4.1\\%$$\n**This means that, with 95% confidence interval, the expected return of the S&P 500 during this period ranges from 7.9% and 16.1%.**\n\nThe longer the period, the more accurate you are. But even with 92 years of data, you are not very accurate to predict the expected return of the SP500.\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\nSome analysts prefer to use a geometric average instead of arithmetic average.\n\nAlso called **Compound Annual Growth Rate (CAGR)**.\n\n$$CAGR = [(1+R_1)\\times(1+R_2)\\times ...\\times (1+R_T)]^{\\frac{1}{T}}-1$$\n\n$$CAGR = [\\frac{Final\\;value}{Initial\\;value}]^\\frac{1}{T}-1$$\n\nUsing Figure 10.1 of BM: geometric return of SP500 from 1926-2017 is\n\n$$CAGR = [\\frac{664,567}{100}]^\\frac{1}{92}-1 = 10.04\\%$$\n\nRemember the (arithmetic) average was 12% (in previous slide).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**Investors are assumed to be risk averse:**\n\n- To assume risk, they need extra return for that risk.\n\n- They demand excess return.\n\n**Excess returns**\n\n- The difference between: \n\n  - 1) the average return for an investment with risk, and \n  - 2) the average return for risk-free assets.\n\n\n\n\n\n\n\n\n\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**That is why riskier assets are expected to have higher returns.**\n\n**In other words, risk and return have a positive correlation.**\n\n![](figs/bm_10_6.png){ width=\"95%\"}\n\n\n\n\n\n\n\n\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**But the association is not linear as one might expect. See stocks below.**\n\n![](figs/bm_10_7.png){ width=\"95%\"}\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#f5d5d5\" }\n\n**Risk vs return of selected Brazilian stocks.** There is a line, but not really...\n\n\n::: {.panel-tabset}\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstart <-'2010-01-01' \nend   <- Sys.Date() \nasset <- yf_collection_get(\"IBOV\", \n                         first_date = start,\n                         last_date = end,\n                         thresh_bad_data = 0.5,\n                         freq_data =\"yearly\")\nasset<-asset[complete.cases(asset),] \nstocks <-c('^BVSP' ) \nibov <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end,\n                         freq_data =\"yearly\")\nibov<-ibov[complete.cases(ibov),]\ndata<-rbind(asset,ibov)\nmean_sd  <- data %>%                          \n            group_by(ticker) %>%\n            summarise_at(vars(ret_adjusted_prices),\n                         list(mean = mean,\n                              sd = sd)) %>% \n            as.data.frame()\np<-ggplot(mean_sd, aes(x=sd, y=mean)) + \n    ggrepel::geom_text_repel(data = mean_sd, aes(label = ticker) , size = 2.5 ,  max.overlaps = Inf)+\n      geom_point(size = 4)  +   xlim(0, 1) + ylim(0, 0.35) + \n        labs(x = \"Average standard deviation (annual returns)\",\n             y='Average return (annual returns)', \n             title=\"Historical return vs. Historical volatility (yearly returns since 2010)\") +   theme_solarized() +\n  geom_point(data = mean_sd[mean_sd$ticker == '^BVSP',], color = \"#2986cc\", size = 5)\np\n```       \n\n\n\n\n\n\n\n\n\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n\nstart = '2010-01-01'\nend = pd.Timestamp.now()\nstocks = [\"^BVSP\",\"ABEV3.SA\",\"ALPA4.SA\",\"AMER3.SA\",\"B3SA3.SA\",\"BBAS3.SA\",\"BBDC3.SA\",\"BBDC4.SA\",\"BEEF3.SA\",\"BPAN4.SA\",\"BRAP4.SA\",\"BRFS3.SA\",\"BRKM5.SA\",\"BRML3.SA\",\"CCRO3.SA\",\"CIEL3.SA\",\"CMIG4.SA\",\"COGN3.SA\",\"CPFE3.SA\",\"CPLE6.SA\",\"CSAN3.SA\",\"CSNA3.SA\",\"CYRE3.SA\",\"DXCO3.SA\",\"ECOR3.SA\",\"EGIE3.SA\",\"ELET3.SA\",\"ELET6.SA\",\"EMBR3.SA\",\"ENBR3.SA\",\"ENEV3.SA\",\"ENGI11.SA\",\"EQTL3.SA\",\"EZTC3.SA\",\"FLRY3.SA\",\"GGBR4.SA\",\"GOAU4.SA\",\"GOLL4.SA\",\"HYPE3.SA\",\"ITSA4.SA\",\"ITUB4.SA\",\"JBSS3.SA\",\"JHSF3.SA\",\"LREN3.SA\",\"MGLU3.SA\",\"MRFG3.SA\",\"MRVE3.SA\",\"MULT3.SA\",\"PCAR3.SA\",\"PETR3.SA\",\"PETR4.SA\",\"PRIO3.SA\",\"QUAL3.SA\",\"RADL3.SA\",\"RENT3.SA\",\"SANB11.SA\",\"SBSP3.SA\",\"SULA11.SA\",\"SUZB3.SA\",\"TAEE11.SA\",\"TIMS3.SA\",\"TOTS3.SA\",\"UGPA3.SA\",\"USIM5.SA\",\"VALE3.SA\",\"VIIA3.SA\",\"VIVT3.SA\",\"WEGE3.SA\",\"YDUQ3.SA\"]\nresults = []\nfor ticker in stocks:\n    asset = yf.download(ticker, start=start, end=end)\n    asset['return'] = asset['Adj Close'].pct_change()\n    asset = asset.dropna()\n    mean_return = asset['return'].mean()\n    std_return = asset['return'].std()\n    data = pd.DataFrame({'ticker': [ticker], 'average_return': [mean_return], 'standard_deviation': [std_return]})\n    results.append(data)\ndf = pd.concat(results).reset_index(drop=True)\n\nplt.close()\nfig, ax = plt.subplots(figsize=(20, 10))\nfor i in range(len(df)):\n    if df.loc[i, 'ticker'] == '^BVSP':\n        color = 'darkblue'\n    else:\n        color = 'black'\n    ax.scatter(x=df.loc[i, 'standard_deviation'], y=df.loc[i, 'average_return'], s=50, color=color)\nplt.title(\"Historical return vs. Historical volatility (daily returns since 2010)\", fontsize=20)\nplt.xlabel(\"Average standard deviation (daily returns)\", fontsize=15)\nplt.ylabel(\"Average return (daily returns)\", fontsize=15)\nplt.show()\n```\n\n\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**When you have a portfolio containing assets, the risk you incurred is less than the (weighted average) of the assets' risk.** Let's understand why.\n\n. . .\n\nFirst, we need to separate two types of risk:\n\n- **Firm-specific risk (or news):**\n  - good or bad news about the company itself. For example, a firm might announce that it has been successful in gaining market share within its industry.\n  - this type of risk is independent across firms.\n  - *also called firm-specific, idiosyncratic, unique, or diversifiable risk.*\n\n- **Market-wide risk (or news):** \n  - news about the economy as a whole, affects all stocks. For instance, changes in the interest rates.\n  - this type of risk is common to all firms.\n  - *also called systematic, undiversifiable, or market risk.*\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n  \n**Firm-Specific Versus Systematic Risk**\n\n- When many stocks are combined in a large portfolio, the firm-specific risks for each stock will average out and be diversified. The systematic risk, however, will affect all firms and will not be diversified.\n\n. . .\n\n**Consider two types of firms:**\n\n**Type S firms are affected only by systematic risk**. There is a 50% chance the economy will be strong and they will earn a return of 40%. There is a 50% change the economy will be weak and their return will be −20%. Because all these firms face the same systematic risk, **holding a large portfolio of type S firms will not diversify the risk.** \n\n  \n**Type I firms are affected only by firm-specific risks**. Their returns are equally likely to be 35% or  −25%, based on factors specific to each firm’s local market. Because these risks are firm specific, if we hold a portfolio of the stocks of many type I firms, **the risk is diversified**. \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\nYou must be aware that **actual firms are affected by both market-wide risks and firm-specific risks**. \n\nWhen firms carry both types of risk, **only the unsystematic risk will be diversified when many firm’s stocks are combined into a portfolio**. \n\nThe volatility will therefore decline until only the systematic risk remains.\n\n![](figs/bm_10_8.png){width=\"90%\"}\n\n\n\n\n\n\n\n\n\n\n##  {.smaller background=\"#f7e1ba\" }\n\n**That is why the standard deviation of a portfolio (like Ibov) is lower than the weighted average standard deviation of the stocks in it.** It is like free lunch.\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstart <-'2010-01-01' \nend   <- Sys.Date() \ndata <- yf_collection_get(\"IBOV\", \n                         first_date = start,\n                         last_date = end,\n                         freq_data = \"daily\",)\ndata<-data[complete.cases(data),] \ndata$month <- format(as.Date(data$ref_date, format=\"%y/%m/%d\"),\"%y/%m\")\nsd  <-    data %>%                          \n            group_by(ticker,month) %>%\n            summarise_at(vars(ret_adjusted_prices),list(sd = sd)) %>% \n            as.data.frame()\nvol  <-    data %>%                          \n            group_by(ticker,month) %>%\n            summarise_at(vars(volume),list(vol_sum = sum)) %>% \n            as.data.frame()\nvol2  <-    data %>%                          \n            group_by(month) %>%\n            summarise_at(vars(volume),\n                         list(vol_tot = sum)) %>% \n            as.data.frame()\ndata2 <- merge(sd ,vol, by=c(\"ticker\",\"month\"))\ndata2 <- merge(data2 ,vol2, by=c(\"month\"))\ndata2$w <- data2$vol_sum/data2$vol_tot\ndata2$sdw <- data2$sd * data2$w\ndata3  <-   data2 %>%                          \n            group_by(month) %>%\n            summarise_at(vars(sdw),list(total = sum)) %>% \n            as.data.frame()\ndata3<-data3[complete.cases(data3),] \ndata3$id <-\"Weighted\"\n# Index\nibov <- yf_get(tickers = '^BVSP', \n                         first_date = start,\n                         last_date = end,\n                         freq_data = \"daily\",)\nibov<-ibov[complete.cases(ibov),] \nibov$month <- format(as.Date(ibov$ref_date, format=\"%y/%m/%d\"),\"%y/%m\")\nsd2  <-    ibov %>%                          \n            group_by(month, ticker) %>%\n            summarise_at(vars(ret_closing_prices) ,\n                         list(total = var ) ) %>% \n            as.data.frame()\nsd2$total <- sd2$total^0.5\nsd2$id <-\"ibov\"\nsd2$ticker <- NULL\ndata4 <- rbind(data3,sd2)\np<-ggplot(data=data4, aes(x=month, y=total, color = id, group = id)) +\n  geom_line() + \n        labs(x = \"\",\n             y='Standard deviation',\n             title =\"Diversification benefits - Ibov vs. Weighted sd of individual stocks\") +   theme_solarized()\nggplotly(p)\n```\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\nAn additional comment about diversification:\n\n**1) it occurs only if the risk of the stocks are independent**\n\n  - we will define later what \"independent\" means to us. \n  - intuitively, different firms have different risks.\n\n**2) if the risks are independent, more stocks means less risk... **\n\n  - ... until a certain point.\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**Consider again type I firms, which are affected only by firm-specific risk. Because each individual type I firm is risky, should investors expect to earn a risk premium when investing in type I firms?**\n\n. . .\n\n**The risk premium for diversifiable risk is zero, so investors are not compensated for holding firm-specific risk.**\n\n- The reason is that they can mitigate this part of risk through  diversification.\n\n- Diversification eliminates this risk for free, implying that all investors should have a diversified portfolio. Otherwise, the investor is not rational.\n\n. . .\n\n**The takeaway is:**\n\n**The risk premium of a security is determined by its systematic risk and does not depend on its diversifiable risk.**\n\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**In a world where diversification exists:**\n\n**Standard deviation is not a good measure for risk anymore.**\n\n- Standard deviation is a measure of **a stock's total risk**\n- But if you are diversified, you are not incurring the total risk, only the systematic risk.\n\n\n_We will need a measure of a stock's systematic risk._\n\n. . .\n\n**This measure is called: Beta**\n\n. . .\n\n**But make no mistake:**\n\n**The standard deviation of the returns of a portfolio is still a good measure for the portfolio's risk!**\n\n- But you will not use the average standard deviation of individual stocks contained in a portfolio.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\n**Beta**\n\n**To measure the systematic risk of a stock, determine how much of the variability of its return is due to systematic risk versus unsystematic risk.**\n\n - To determine how sensitive a stock is to systematic risk, look at the average change in the return for each 1% change in the return of a portfolio that fluctuates solely due to systematic risk.\n\n**This is the exact definition of a Beta in a regression or a linear relationship** (we studied that in statistics).\n\n. . .\n\nSaying the same thing in other words:\n\n**Beta measures the expected percent change in the excess return of a security for a 1% change in the excess return of the market portfolio.**\n\n  - Market portfolio contains all stocks: SP500 is a proxy, Ibov is another (for BR).   \n\n\n\n\n\n\n\n\n\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\nSuppose the market portfolio tends to increase by 47% when the economy is strong and decline by 25% when the economy is weak. **What is the beta of a type S firm whose return is 40% on average when the economy is strong and −20% when the economy is weak?**\n\n**Firm S**\n\n- Market changes 47%, stock changes 40%: Beta is $\\frac{40}{47}=0.85$\n- Market changes -25%, stock changes -20%: Beta is $\\frac{20}{25}=0.8$\n- Market changes from -25% to 47% = 72%, stock changes from -20 to 40, Beta is $\\frac{60}{72}=0.833$\n\n. . .\n\nIt does not mean that the stock has three betas...\n\n... it means that we have three estimates for the stock's beta.\n\n\n\n\n\n\n\n\n\n\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\nSuppose the market portfolio tends to increase by 47% when the economy is strong and decline by 25% when the economy is weak. What is the beta of a type S firm whose return is 40% on average when the economy is strong and −20% when the economy is weak? **What is the beta of a type I firm that bears only idiosyncratic, firm-specific risk?**\n\n**Firm I**\n\n- Does not change, Beta is $\\frac{0}{72}=0$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  Market Risk Premium {.smaller background=\"#f2f7ba\" }\n\nWe can define: **The market risk premium is the reward investors expect to earn for holding a portfolio with a beta of 1**.\n\n$$Market\\; risk\\;premium = E[R_m] - R_{rf}$$\n\n. . .\n\nInverting:\n\n$$E[R_m] =  R_{rf} + Market\\; risk\\;premium$$\n\n. . .\n\nThe idea is that investors are risk-averse and dislike risk. Therefore, in order to invest in risky assets, investors demand an extra return.\n\n. . .\n\nFlipping the argument, **a risky asset will have to pay an extra return for its additional risk in order to attract investors.**\n\n. . .\n\nTherefore, there is a clear association between the risk and return of assets.\n\n. . .\n\nAgain: in a diversified portfolio, investors are diversified so they only worry about beta (not standard deviation).\n\n\n\n\n\n\n\n\n\n\n##  Market Risk Premium {.smaller background=\"#f2f7ba\" }\n\nThere is some heterogeneity in the **risk premium** across countries.\n\n<img src=\"figs/bre13901_0703.jpg\" width=\"80%\" />\n\nSource: Brealey, Myers and Allen (13ed)\n\n\n\n\n\n\n\n\n\n\n## Equity Risk Premium ([ERP](https://ceqef.fgv.br/node/594)) {.smaller background=\"#f2f7ba\" }\n\n::: panel-tabset\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nurl <- \"https://ceqef.fgv.br/sites/default/files/2023-12/Serie%20de%20Equity%20Risk%20Premium%20Novembro%20de%202023.xlsx\"\ndownload(url, dest=\"files/epr.xlsx\", mode=\"wb\") \ndata <- read_excel(\"files/epr.xlsx\", col_types = c(\"date\",\"numeric\") )\ndata <- data[2:nrow(data),1:2]\ncolnames(data) <- c(\"month\", \"erp\")\n\np<-ggplot(data, aes(x=month, y = erp)) + geom_line() + theme_solarized()+\n  labs(y = \"Equity Risk Premium (ERP)\", \n       x = \"\", \n       title = \"Equity Risk Premium (ERP) in Brazil\" , \n       caption = \"Source: https://ceqef.fgv.br/node/594\" )\nggplotly(p)\n```\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nimport pandas as pd\nimport matplotlib.pyplot as plt\nurl = \"https://ceqef.fgv.br/sites/default/files/2023-12/Serie%20de%20Equity%20Risk%20Premium%20Novembro%20de%202023.xlsx\"\ndata = pd.read_excel(url, header=2)\ndata = data.iloc[:, 0:2]\ndata.columns = [\"month\", \"erp\"]\nfig, ax = plt.subplots(figsize=(20, 10))\nax.plot(data[\"month\"], data[\"erp\"])\nax.set_xlabel(\"Time\", fontsize=20)\nax.set_ylabel(\"Equity Risk Premium (ERP)\", fontsize=20)\nax.set_title(\"Equity Risk Premium (ERP) in Brazil\", fontsize=25)\nax.text(0.5, -0.1, \"Source: https://ceqef.fgv.br/node/594\", transform=ax.transAxes, ha=\"center\")\nplt.show()\n```\n\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\n## 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\nConsider an investment with a beta = 1.5.\n\nThis investment has 50% more risk than the market portfolio.\n\nEvery 1% change in the market portfolio leads to a 1.5% percent change in the investment's price.\n\n. . .\n\nBased on these figures, we can compute the expected return for this investment **adjusted by the level or risk it provides**.\n\n$$E[R] = R_{rf} + \\beta \\times (E[R_m] - R_{rf})$$\n\n. . .\n\nWe will discuss more about this equation later, when discussing the CAPM (Capital Asset Pricing Model).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\nFlipping the argument from the previous slides, **we can compute the cost of capital for this investment** using the same formula:\n\n$$E[R] = R_{rf} + \\beta \\times (E[R_m] - R_{rf})$$\n\n. . .\n\nAssume the economy has a 60% chance that the market return will be 15% next year and a 40% chance the market return will be 5% next year. Assume the risk-free rate is 6%. If a company's beta is 1.18, what is its expected return next year?\n\n. . .\n\nFirst, compute $E[R_m]$:\n\n$$E[R_m] = 60\\% \\times 15\\% + 40\\% \\times 5\\%  = 11\\%$$\n\n. . .\n\nSecond, compute $E[R]$:\n\n$$E[R] = 6\\% + 1.18 \\times (11\\% - 6\\%) = 11.9\\%$$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Problems {.smaller background=\"#522f31\"}\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 1**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q1/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q1easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q1hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 2**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q2/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q2easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q2hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 3**\n\n<iframe height=\"70%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q3/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q3easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q3hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 4**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q4/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q4easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q4hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 5**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q5/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q5easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q5hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n# Recap {.smaller visibility=\"hidden\"}\n\n##  Recap {.smaller visibility=\"hidden\"}\n\n**After this chapter, you should know:**\n\n- Understand what a probability distribution is, the mean, the variance, and the standard deviation.\n\n- Compute the realized or total return for an investment.\n\n- Use the empirical distribution of realized returns, estimate expected return, variance, and standard deviation (or volatility) of returns.\n\n- Use the standard error of the estimate to gauge the amount of estimation error in the estimate (i.e., the average).\n\n- Discuss the volatility and return characteristics of small stocks versus large stocks (and other assets).\n\n- Describe the relationship between volatility and return of individual stocks.\n\n\n\n\n\n\n\n\n##  Recap {.smaller visibility=\"hidden\"}\n\n**After this chapter, you should know:**\n\n- Define and contrast idiosyncratic and systematic risks and the risk premium required.\n\n- Understand beta as a measure of the systematic risk of a security.\n\n- Use the Capital Asset Pricing Model to calculate the expected return for a risky security.\n\n- Use the Capital Asset Pricing Model to calculate the cost of capital for a particular project.\n\n\n\n\n\n\n\n\n## How did you like this lecture? {background=\"#a2bef5\"}\n\n<center>\n\n**Your response:**\n\n<div \ndata-lyket-type=\"rate\" \ndata-lyket-id=\"part-2\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-show-rating=\"user\" \ndata-lyket-template=\"custom\" \n></div>\n\n\n**Average response:**\n<div \ndata-lyket-type=\"rate\" \ndata-lyket-id=\"part-2\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-show-rating=\"average\" \ndata-lyket-template=\"custom\" \n></div>\n\n</center>\n\n\n\n\n\n\n## Comments? {background=\"#a2bef5\"}\n\n<script src=\"https://giscus.app/client.js\"\n        data-repo=\"henriquecastror/efcomments-part-2\"\n        data-repo-id=\"R_kgDOK8BPNw\"\n        data-category-id=\"DIC_kwDOK8BPN84Cb46r\"\n        data-mapping=\"pathname\"\n        data-strict=\"0\"\n        data-reactions-enabled=\"1\"\n        data-emit-metadata=\"0\"\n        data-input-position=\"bottom\"\n        data-theme=\"light\"\n        data-lang=\"en\"\n        crossorigin=\"anonymous\"\n        async>\n</script>\n\n\n::: footer\n:::\n\n\n\n\n\n\n## **THANK YOU!** {background=\"#b1cafa\"}\n\n::: columns\n\n::: {.column width=\"60%\"}\n\n**QUESTIONS?**\n\n![](figs/qa2.png){width=150% heigth=150%}\n:::\n::: {.column width=\"40%\"}\n**Henrique C. Martins**\n\n-   [FGV/EAESP](https://eaesp.fgv.br/en/people/henrique-castro-martins)\n-   [Personal Website](https://henriquemartins.net/)\n-   [LinkedIn](https://www.linkedin.com/in/henriquecastror/)\n-   [Lattes](http://lattes.cnpq.br/6076997472159785)\n-   [Scholar](https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&hl=pt-BR&oi=ao)  \n:::\n:::\n\n::: footer\n:::\n\n\n\n\n","srcMarkdownNoYaml":"\n\n\n```{r setup}\n#| include: false\n#| warning: false\napi_key <- \"kfqxH5NsN8Nhe_U1NADB\"\n# library(reticulate)\n# use_python(\"C:/Users/hcmrt/AppData/Local/Programs/Python/Python310/python.exe\")\nlibrary(reticulate)\n#reticulate::py_install(\"matplotlib\")\n#reticulate::py_install(\"seaborn\")\n#reticulate::py_install(\"pyfinance\")\n#reticulate::py_install(\"xlrd\")\n#reticulate::py_install(\"quandl\")\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n```\n\n\n\n\n# Intro {visibility=\"hidden\"}\n\n## {background-image=\"figs/ch10.png\" background-size=\"1300px\"}\n\n\n\n\n\n\n## Chapter outline \n\n10.1 Risk and Return: Insights from History\n\n10.2 Common Measures of Risk and Return\n\n10.3 Historical Returns of Stocks and Bonds\n\n10.4 The Historical Trade-Off Between Risk and Return\n\n10.6 Diversification in Stock Portfolios\n\n10.7 Measuring Systematic Risk\n\n10.8 Beta and the Cost of Capital\n\n\n\n\n\n\n\n\n\n\n# 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n![](figs/bm_10_1.png){width=\"105%\"}\n\n\n\n\n\n\n\n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n**Some Insights:**\n\n- Small stocks had the highest long-term return, while T-Bills had the lowest.\n\n- Small stocks had the largest fluctuations in price, while T-Bills had the lowest.\n  - **Higher risk requires a higher return.**\n\n. . .\n\n- **But, few people ever make an investment for so many years**.\n\n- More realistic **investment horizons** and different initial investment dates can greatly influence each investment's risk and return.\n\n. . .\n\nNotice the volatility next slide.\n\n\n\n\n\n\n\n## 10.1 Risk & Return: Insights from History {.smaller background=\"#f2f5ce\"} \n\n![](figs/bm_10_2.png){width=\"105%\"}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (1995-2023).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n#Ibov\nstock<-'^BVSP' \nstart<-'1995-01-01' \nend   <- Sys.Date() \nibov <- yf_get(tickers = stock,first_date = start,last_date = end)\nibov<- ibov[order(as.numeric(ibov$ref_date)),]\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices -1\n\n#Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date , format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252* 100)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic)<- \"selic_return\"\nfor(i in (2:nrow(selic))) {\nreturn_selic[i,1] <- Return.cumulative( selic$selic[1:i] )\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov ,selic, by=c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\ngeom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\ngeom_line(aes(y = selic_return, colour = \"Selic\")) +\nlabs(y='Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns  Ibov, and Selic (1995-2023)\")\nggplotly(p)\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\n\nstock = \"^BVSP\"\nstart = \"1995-01-01\"\nend = pd.Timestamp.now()\n\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Value': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (1995-2023)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (2002-2007).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n# Ibov\nstock <- '^BVSP'\nstart <- '2002-01-01'  # Adjusted start date\nend <- '2007-12-31'   # Adjusted end date\nibov <- yf_get(tickers = stock, first_date = start, last_date = end)\nibov <- ibov[order(as.numeric(ibov$ref_date)),]\n\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices - 1\n\n# Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date, format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252 * 100)\n\n# Filter Selic data for the desired period (2010-2020)\nselic <- selic %>% filter(ref_date >= start & ref_date <= end)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic) <- \"selic_return\"\nfor (i in (2:nrow(selic))) {\n  return_selic[i, 1] <- Return.cumulative(selic$selic[1:i])\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov, selic, by = c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\n  geom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\n  geom_line(aes(y = selic_return, colour = \"Selic\")) +\n  labs(y = 'Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns Ibov, and Selic (2002-2007)\")\nggplotly(p)\n\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\n\nstock = \"^BVSP\"\nstart = \"2002-01-01\"\nend = \"2007-12-31\"\n\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Adj Close': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Ibovespa\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n\n# Filter Selic data for the desired period\nselic = selic[(selic['ref_date'] >= start) & (selic['ref_date'] <= end)]\n\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (2002-2007)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n\n\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n## {.smaller background=\"#f2f5ce\"} \n\n**Insights from Brazil (2010-2018).**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nlibrary(downloader)\nlibrary(dplyr)\nlibrary(GetQuandlData)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(PerformanceAnalytics)\nlibrary(plotly)\nlibrary(readxl)\nlibrary(roll)\nlibrary(tidyr)\nlibrary(tidyquant)\nlibrary(yfR)\n\n# Ibov\nstock <- '^BVSP'\nstart <- '2010-01-01'  # Adjusted start date\nend <- '2018-12-31'   # Adjusted end date\nibov <- yf_get(tickers = stock, first_date = start, last_date = end)\nibov <- ibov[order(as.numeric(ibov$ref_date)),]\n\n# Cumulative return Ibov\nibov$Ibov_return <- ibov$cumret_adjusted_prices - 1\n\n# Selic - Download manually from ipeadata \"Taxa de juros: Overnight / Selic\"\nselic <- read_excel(\"files/selic.xls\")\nnames(selic) <- c(\"ref_date\", \"selic\")\nselic$ref_date <- as.Date(selic$ref_date, format = \"%d/%m/%Y\")\nselic <- na.omit(selic)\nselic$selic <- selic$selic / (252 * 100)\n\n# Filter Selic data for the desired period (2010-2020)\nselic <- selic %>% filter(ref_date >= start & ref_date <= end)\n\n# Cumulative return Selic\nreturn_selic <- data.frame(nrow(selic):1)\ncolnames(return_selic) <- \"selic_return\"\nfor (i in (2:nrow(selic))) {\n  return_selic[i, 1] <- Return.cumulative(selic$selic[1:i])\n}\n\n# Merging dataframes\nselic <- cbind(selic, return_selic)\ndf <- merge(ibov, selic, by = c(\"ref_date\"))\ndf$selic_return[1] <- NA\ndf$Ibov_return[1] <- NA\n\n# Graph cumulated return CDI and IBOV\np <- ggplot(df, aes(ref_date)) +\n  geom_line(aes(y = Ibov_return, colour = \"Ibov\")) +\n  geom_line(aes(y = selic_return, colour = \"Selic\")) +\n  labs(y = 'Cumulative return (daily)') + theme_solarized() +\n  ggtitle(\"Cumulative Returns Ibov, and Selic (2010-2018)\")\nggplotly(p)\n\n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n# Define API key and other parameters\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport yfinance as yf\nstock = \"^BVSP\"\nstart = \"2010-01-01\"\nend = \"2018-12-31\"\n# Get data for IBOV\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Adj Close': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Ibovespa\"].pct_change()\nibov['Ibov_return'] = (1 + ibov['return']).cumprod()\nibov = ibov[['ref_date', 'Ibov_return']]\n# Get data for Selic\nselic = pd.read_excel(\"files/selic.xls\")\nselic.columns = [\"ref_date\", \"selic\"]\nselic['ref_date'] = pd.to_datetime(selic['ref_date'], format=\"%d/%m/%Y\")\nselic = selic.dropna()\nselic['selic'] = selic['selic'] / (252 * 100)\n# Filter Selic data for the desired period\nselic = selic[(selic['ref_date'] >= start) & (selic['ref_date'] <= end)]\n# Calculate cumulative return for Selic\nselic['selic_return'] = (1 + selic['selic']).cumprod()\n# Merge dataframes\ndf = pd.merge(ibov, selic, on=\"ref_date\")\n# Plot data\nfig, ax = plt.subplots(figsize=(10,5))\nax.plot(df[\"ref_date\"], df[\"Ibov_return\"], label='Ibov')\nax.plot(df[\"ref_date\"], df[\"selic_return\"], label='Selic')\nplt.ylabel('Cumulative return (daily)', fontsize=13)\nplt.title('Cumulative Returns Ibov and Selic (2010-2018)', fontsize=15)\nplt.xlabel('Date', fontsize=13)\nplt.legend(loc='upper left')\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n# 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nWhen an investment is risky, it may earn **different returns**. \n\nEach possible return has some **likelihood of occurring**. \n\nThis information is summarized with a **probability distribution**, which assigns a probability, $P_r$ , that each possible return, $R$, will occur.\n\n. . .\n\nAssume BFI stock currently trades for 100 per share. In one year, there is a 25% chance the share price will be 140, a 50% chance it will be 110, and a 25% chance it will be 80. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nThis insight will lead to this kind of graph.\n\n![](figs/bm_10_3.jpg){width=\"90%\"}\n\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Let's see how to compute the expected return on this asset.**\n\n$$Expected\\;return = E[R] = \\sum_{R} P_R \\times R$$\n\n$$E[R_{BFI}] = 25\\%(−0.20) + 50\\%(0.10) + 25\\%(0.40) = 10\\%$$\n\n. . .\n\nVery important: there is an **underlying assumption** that the **past is good enough to teach us about the future.**\n\nThat is, we are computing the historical average return and **using this number as the best estimate of the expected return.**\n\n**Keep that assumption in mind.**\n\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Now risk: variance and standard deviation.**\n\n$$Var(R) = E[(R-E[R])^2]   = \\sum_{R} P_R \\times (R-E[R])^2 $$\n\n$$SD(R) = \\sqrt{Var(R)}$$\n\n. . .\n\n$$V(R)  = 0.25 × (−0.2 − 0.1)^2  + 0.5 × (0.1 − 0.1)^2 + 0.25 × (0.4 − 0.1)^2  = 0.045$$\n\n\n$$SD(R_{BFI}) = \\sqrt{0.045} = 21.2\\%$$\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\nSuppose AMC stock is equally likely to have a 45% return or a −25% return. What are the expected return and volatility?\n\n. . .\n\n$$E[R] = 50\\%×0.45+50\\%×(−0.25)=10.0\\%$$\n\n. . .\n\n$$Var[R] = 50\\%×(0.45−0.10)^2+50\\%×(−0.25−0.10)^2=0.1225$$\n\n. . .\n\n$$SD[R] = (0.1225) ^{0.5} = 35\\%$$\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**It is clear that riskier assets have heavier tails.**\n\n![](figs/bm_10_4.png){width=\"110%\"}\n\n\n\n. . .\n\n**Warning: Standard deviation and variance are correct measures of total risk _if the returns are normally distributed_**.\n\n\n\n\n\n\n\n\n## {.smaller  background=\"#cff5ce\"}\n\n**IBOV returns seem to follow a normal distribution.**\n\n::: panel-tabset\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot(ibov,aes(ibov$ret_closing_prices))+\n        geom_histogram(color='#006600',\n                       bins = 100) + \n        labs(x = \"\",\n             y='Daily return', \n             title=\"IBOV\") +   theme_solarized()\nggplotly(p)\n```\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nibov = yf.download(stock, start=start, end=end)\nibov = ibov.reset_index()\nibov = ibov.sort_values(\"Date\")\nibov = ibov.rename(columns={'Date': 'ref_date', 'Value': 'Ibovespa'})\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nplt.close()\nplt.hist(ibov['return'], bins=100, color='grey')\nplt.title('IBOV', fontsize=20)\nplt.ylabel('Daily return', fontsize=16 )\nplt.show()\n\n```\n\n\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Standard deviation through time. It changes.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nibov$sd <- roll_sd(ibov$ret_closing_prices,  \n                     width = 100,  \n                     min_obs = 100 ) * sqrt(250)\np<-ggplot(ibov,aes(ref_date,sd))+\n        geom_line(color='#2986cc') + \n        labs(x = \"\",\n             y='Standard deviation using 100 daily returns', \n             title=\"IBOV (Daily returns since 2010)\") +   theme_solarized()\nggplotly(p)\n```\n\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport yfinance as yf\nstock = \"^BVSP\"\nstart = \"2010-01-01\"\nend = pd.Timestamp.now()\nibov = yf.download(stock, start=start, end=end)\nibov[\"return\"] = ibov[\"Adj Close\"].pct_change()\nibov['rolling_sd'] = ibov['return'].rolling(window=100, min_periods=100).std() * (250 ** 0.5)\nplt.close()\nfig, ax = plt.subplots(figsize=(20,10))\nax.plot(ibov.index, ibov['rolling_sd'], color='#2986cc')\nax.set_xlabel('')\nax.set_ylabel('Standard deviation using 100 daily returns', fontsize=13)\nax.set_title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Standard deviation through time. Riskier is riskier.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstocks <-c('AMER3.SA' ) \namer <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end)\namer<-amer[complete.cases(amer),]\namer$sd <- roll_sd(amer$ret_closing_prices,  \n                     width = 100,  \n                     min_obs = 100 ) * sqrt(250)\nibov <- subset(ibov, ref_date >= as.Date(\"2010-01-05\"))\n\np<-ggplot() + \n  geom_line(data=amer, aes(ref_date, sd), color='#801e00') +\n  geom_line(data=ibov, aes(ref_date, sd), color='#2986cc') +\n          labs(x = \"\",y='Standard deviation using 100 daily returns', \n             title=\"IBOV vs AMER3 (Daily returns since 2010)\") +   theme_solarized()\nggplotly(p)\n```\n\n\n###  Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nstock = \"AMER3.SA\"\n# Get data for IBOV\namer = yf.download(stock, start=start, end=end)\namer = amer.reset_index()\namer = amer.sort_values(\"Date\")\namer = amer.rename(columns={'Date': 'ref_date', 'Value': 'Americanas'})\namer[\"return\"] = amer[\"Adj Close\"].pct_change() \namer = amer.dropna()\namer['sd'] = amer['return'].rolling(window=100, min_periods=100).std() \namer['sd'] = amer['sd'] * np.sqrt(250)\n\nplt.close()\nfig, ax = plt.subplots(figsize=(20,10))\nax.plot(ibov.index, ibov['sd'], color='#2986cc')\nax.plot(amer.index, amer['sd'], color='darkred')\nax.set_xlabel('')\nax.set_ylabel('Standard deviation using 100 daily returns', fontsize=15)\nax.set_title('IBOV vs AMER3 (Daily returns since 2010)', fontsize=14)\nplt.show()\n```\n\n\n\n:::\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Daily returns IBOV.**\n\n::: {.panel-tabset}\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot(ibov,aes(ibov$ref_date,ibov$ret_closing_prices))+\n        geom_line(color='#2986cc') + \n        labs(x = \"\",\n             y='Daily returns', \n             title=\"IBOV (Daily returns since 2010)\")   +   theme_solarized()  \nggplotly(p)\n```\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nplt.close()\nplt.plot(ibov['ref_date'], ibov['return'], color='#2986cc')\nplt.xlabel('')\nplt.ylabel('Daily returns', fontsize=14)\nplt.title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Daily returns Americanas.**\n\n::: {.panel-tabset}\n\n### R \n\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\np<-ggplot() +\n  geom_line(data=amer, aes(amer$ref_date, amer$ret_closing_prices), color='#801e00') +\n  geom_line(data=ibov, aes(ibov$ref_date, ibov$ret_closing_prices), color='#2986cc') +\n  labs(x = \"\", y='Daily returns') +\n  ggtitle(\"IBOV vs AMER3 (Daily returns since 2010)\") +\n  theme_solarized()\nggplotly(p)      \n```\n\n\n\n\n\n### Python\n\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: false\nplt.close()\nplt.plot(amer['ref_date'], amer['return'], color='#801e00')\nplt.plot(ibov['ref_date'], ibov['return'], color='#2986cc')\nplt.xlabel('')\nplt.ylabel('Daily returns', fontsize=14)\nplt.title('IBOV (Daily returns since 2010)', fontsize=15)\nplt.show()\n```\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#cff5ce\"}\n\n**Americanas seems riskier than ITUB.** Some stocks have heavier tails than others. The stock with the heavier tail is riskier.\n\n::: {.panel-tabset}\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstocks <-c('AMER3.SA', 'ITUB3.SA') \nstart <-'2012-01-01' \nend   <- Sys.Date() \ndata <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end)\ndata<-data[complete.cases(data),] \np<-ggplot(data, aes(ret_closing_prices,  fill = ticker)) + \n        geom_histogram(bins = 100, alpha = 0.35, position='identity') + \n        labs(x = \"\",\n             y='Daily returns', \n             title=\"Daily returns (2012-2023)\",\n             subtitle = start)+\n      xlim(-0.1,0.1) +   theme_solarized()\nggplotly(p)\n```\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nstart = '2012-01-01'\nend = pd.Timestamp.now()\nasset1 = yf.download('AMER3.SA', start=start, end=end)\nasset1 = asset1.dropna()\nasset1['return'] = asset1[\"Adj Close\"].pct_change()\nasset2 = yf.download('ITUB3.SA', start=start, end=end)\nasset2 = asset2.dropna()\nasset2['return'] = asset2[\"Adj Close\"].pct_change()\ndf = pd.merge(asset1[['return']], asset2[['return']], on=\"Date\")\n#plot\nplt.close()\nplt.figure(figsize=(20,10))\nplt.hist(df['return_x'], bins=400, alpha=0.5, label=\"AMER3.SA\", density=True)\nplt.hist(df['return_y'], bins=400, alpha=0.5, label=\"ITUB3.SA\", density=True)\nplt.title('Daily returns (2012-2023)', fontsize=25)\nplt.ylabel('Daily returns', fontsize=20)\nplt.legend(loc='upper left', fontsize=20)\nplt.xlim(-0.1, 0.1)\nplt.show()\n```\n\n\n:::\n\n\n\n\n\n\n\n\n## 10.2 Measures of Risk and Return {.smaller  background=\"#cff5ce\"}\n\n**Keep in mind:** There is variation (heterogeneity) in the level of **standard deviation** across countries.\n\n![](figs/bre13901_0707.jpg){width=\"85%\"}\n\nSource: Brealey, Myers and Allen (13ed)\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nThe previous problem was a simple one-time-ahead example (i.e., we computed the expected return one period ahead). \n\nA more realistic one is to **compute historical returns**:\n\n$$R_{t+1} = \\frac{Div_{t+1} + P_{t+1}}{P_t} - 1$$ \n\nThis is:\n\n**Dividend Yield + Capital Gain Rate**\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\n**Calculating realized annual returns**\n\nIf a stock pays dividends at the end of each quarter (with realized returns RQ1, RQ2, RQ3, and RQ4 each quarter), then its annual realized return, $R_{annual}$, is computed as follows:\n\n$$(1 + 𝑅_{annual})   = (1+𝑅_{Q1})\\times(1+𝑅_{Q2})\\times(1+ 𝑅_{Q3})\\times (1+𝑅_{Q4})$$\n\n- You can also compute using a daily time horizon (not manually, but by software).\n\n. . .\n\n**One important piece of information you need:**\n\n- You should know whether the return is calculated adjusted by dividends (they usually are, but always ask).\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nCompute the annual returns of this stock.\n\n![](figs/bm_10_ex1.png){width=\"100%\"}\n\n. . .\n\n$$𝑅_{2012}=(1.0513)(1.0449)(0.7626)(1.1375)(0.9714)−1=−7.43\\%$$\n\n$$𝑅_{2016}=(0.8499)(0.8409)(1.0811)(0.440)−1=−66.0\\%$$\n\n**Notice that the first example is not quarterly.**\n\n\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\"}\n\nCompute the annual returns of this stock.\n\n![](figs/bm_10_ex1.png){width=\"100%\"} \n\n**Also notice that, since the firm did not pay dividends in 2016, you can compute:**\n\n$$\\frac{2.29}{6.73}-1 = -66\\%$$\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" visibility=\"hidden\"}\n\n![](figs/bm_10_5.jpg){width=\"80%\"}\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Average annual return**\n\nThe average annual return of an investment during some historical period is simply the average of the realized returns for each year.\n\n$$\\tilde{R}  =  \\frac{1}{T} (𝑅_1  + 𝑅_2  + ⋯ + 𝑅_𝑇)  =  \\frac{1}{T} \\sum_{t=1}^{T} R_t$$\n\n. . .\n\n**Variance estimate using realized returns**\n\n$$Var[R] =  \\frac{1}{T-1} \\sum_{t=1}^{T} (R_t- \\tilde{R})^2 $$\n$$SD(R) = \\sqrt{Var(R)}$$\n\n**Warning: because you are using a sample of historical returns (instead of the population) there is a T-1 in the variance formula**.\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Historical Returns: standard error** \n\nWe can use a security’s historical average return to estimate its actual expected return. However, the average return is just an estimate of the expected return.\n\n- **Standard Error**\n  - A statistical measure of the degree of estimation error of a statistical estimate\n\n_The average return is just an estimate of the true expected return, and is subject to estimation error._\n\nYou can compute the standard error as\n\n$$SE = \\frac{Standard\\; deviation}{\\sqrt{n\\;of\\; observations}}$$\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\n**Historical Returns: standard error** \n\nUsing BM p.367 example. \n\n**For example, from 1926 to 2017 the average return of the S&P 500 was 12.0% with a volatility of 19.8%.**\n\n$$E[R] \\pm 2\\times SE = 12\\% \\pm \\frac{19.8\\%}{\\sqrt{92}}= 12\\% \\pm 4.1\\%$$\n**This means that, with 95% confidence interval, the expected return of the S&P 500 during this period ranges from 7.9% and 16.1%.**\n\nThe longer the period, the more accurate you are. But even with 92 years of data, you are not very accurate to predict the expected return of the SP500.\n\n\n\n\n\n\n\n\n\n## 10.3 Historical Returns {.smaller  background=\"#ced8f5\" }\n\nSome analysts prefer to use a geometric average instead of arithmetic average.\n\nAlso called **Compound Annual Growth Rate (CAGR)**.\n\n$$CAGR = [(1+R_1)\\times(1+R_2)\\times ...\\times (1+R_T)]^{\\frac{1}{T}}-1$$\n\n$$CAGR = [\\frac{Final\\;value}{Initial\\;value}]^\\frac{1}{T}-1$$\n\nUsing Figure 10.1 of BM: geometric return of SP500 from 1926-2017 is\n\n$$CAGR = [\\frac{664,567}{100}]^\\frac{1}{92}-1 = 10.04\\%$$\n\nRemember the (arithmetic) average was 12% (in previous slide).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**Investors are assumed to be risk averse:**\n\n- To assume risk, they need extra return for that risk.\n\n- They demand excess return.\n\n**Excess returns**\n\n- The difference between: \n\n  - 1) the average return for an investment with risk, and \n  - 2) the average return for risk-free assets.\n\n\n\n\n\n\n\n\n\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**That is why riskier assets are expected to have higher returns.**\n\n**In other words, risk and return have a positive correlation.**\n\n![](figs/bm_10_6.png){ width=\"95%\"}\n\n\n\n\n\n\n\n\n\n## 10.4 Tradeoff between risk and return {.smaller  background=\"#f5d5d5\" }\n\n**But the association is not linear as one might expect. See stocks below.**\n\n![](figs/bm_10_7.png){ width=\"95%\"}\n\n\n\n\n\n\n\n\n\n\n##  {.smaller  background=\"#f5d5d5\" }\n\n**Risk vs return of selected Brazilian stocks.** There is a line, but not really...\n\n\n::: {.panel-tabset}\n\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstart <-'2010-01-01' \nend   <- Sys.Date() \nasset <- yf_collection_get(\"IBOV\", \n                         first_date = start,\n                         last_date = end,\n                         thresh_bad_data = 0.5,\n                         freq_data =\"yearly\")\nasset<-asset[complete.cases(asset),] \nstocks <-c('^BVSP' ) \nibov <- yf_get(tickers = stocks, \n                         first_date = start,\n                         last_date = end,\n                         freq_data =\"yearly\")\nibov<-ibov[complete.cases(ibov),]\ndata<-rbind(asset,ibov)\nmean_sd  <- data %>%                          \n            group_by(ticker) %>%\n            summarise_at(vars(ret_adjusted_prices),\n                         list(mean = mean,\n                              sd = sd)) %>% \n            as.data.frame()\np<-ggplot(mean_sd, aes(x=sd, y=mean)) + \n    ggrepel::geom_text_repel(data = mean_sd, aes(label = ticker) , size = 2.5 ,  max.overlaps = Inf)+\n      geom_point(size = 4)  +   xlim(0, 1) + ylim(0, 0.35) + \n        labs(x = \"Average standard deviation (annual returns)\",\n             y='Average return (annual returns)', \n             title=\"Historical return vs. Historical volatility (yearly returns since 2010)\") +   theme_solarized() +\n  geom_point(data = mean_sd[mean_sd$ticker == '^BVSP',], color = \"#2986cc\", size = 5)\np\n```       \n\n\n\n\n\n\n\n\n\n\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\n\nstart = '2010-01-01'\nend = pd.Timestamp.now()\nstocks = [\"^BVSP\",\"ABEV3.SA\",\"ALPA4.SA\",\"AMER3.SA\",\"B3SA3.SA\",\"BBAS3.SA\",\"BBDC3.SA\",\"BBDC4.SA\",\"BEEF3.SA\",\"BPAN4.SA\",\"BRAP4.SA\",\"BRFS3.SA\",\"BRKM5.SA\",\"BRML3.SA\",\"CCRO3.SA\",\"CIEL3.SA\",\"CMIG4.SA\",\"COGN3.SA\",\"CPFE3.SA\",\"CPLE6.SA\",\"CSAN3.SA\",\"CSNA3.SA\",\"CYRE3.SA\",\"DXCO3.SA\",\"ECOR3.SA\",\"EGIE3.SA\",\"ELET3.SA\",\"ELET6.SA\",\"EMBR3.SA\",\"ENBR3.SA\",\"ENEV3.SA\",\"ENGI11.SA\",\"EQTL3.SA\",\"EZTC3.SA\",\"FLRY3.SA\",\"GGBR4.SA\",\"GOAU4.SA\",\"GOLL4.SA\",\"HYPE3.SA\",\"ITSA4.SA\",\"ITUB4.SA\",\"JBSS3.SA\",\"JHSF3.SA\",\"LREN3.SA\",\"MGLU3.SA\",\"MRFG3.SA\",\"MRVE3.SA\",\"MULT3.SA\",\"PCAR3.SA\",\"PETR3.SA\",\"PETR4.SA\",\"PRIO3.SA\",\"QUAL3.SA\",\"RADL3.SA\",\"RENT3.SA\",\"SANB11.SA\",\"SBSP3.SA\",\"SULA11.SA\",\"SUZB3.SA\",\"TAEE11.SA\",\"TIMS3.SA\",\"TOTS3.SA\",\"UGPA3.SA\",\"USIM5.SA\",\"VALE3.SA\",\"VIIA3.SA\",\"VIVT3.SA\",\"WEGE3.SA\",\"YDUQ3.SA\"]\nresults = []\nfor ticker in stocks:\n    asset = yf.download(ticker, start=start, end=end)\n    asset['return'] = asset['Adj Close'].pct_change()\n    asset = asset.dropna()\n    mean_return = asset['return'].mean()\n    std_return = asset['return'].std()\n    data = pd.DataFrame({'ticker': [ticker], 'average_return': [mean_return], 'standard_deviation': [std_return]})\n    results.append(data)\ndf = pd.concat(results).reset_index(drop=True)\n\nplt.close()\nfig, ax = plt.subplots(figsize=(20, 10))\nfor i in range(len(df)):\n    if df.loc[i, 'ticker'] == '^BVSP':\n        color = 'darkblue'\n    else:\n        color = 'black'\n    ax.scatter(x=df.loc[i, 'standard_deviation'], y=df.loc[i, 'average_return'], s=50, color=color)\nplt.title(\"Historical return vs. Historical volatility (daily returns since 2010)\", fontsize=20)\nplt.xlabel(\"Average standard deviation (daily returns)\", fontsize=15)\nplt.ylabel(\"Average return (daily returns)\", fontsize=15)\nplt.show()\n```\n\n\n\n::: \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**When you have a portfolio containing assets, the risk you incurred is less than the (weighted average) of the assets' risk.** Let's understand why.\n\n. . .\n\nFirst, we need to separate two types of risk:\n\n- **Firm-specific risk (or news):**\n  - good or bad news about the company itself. For example, a firm might announce that it has been successful in gaining market share within its industry.\n  - this type of risk is independent across firms.\n  - *also called firm-specific, idiosyncratic, unique, or diversifiable risk.*\n\n- **Market-wide risk (or news):** \n  - news about the economy as a whole, affects all stocks. For instance, changes in the interest rates.\n  - this type of risk is common to all firms.\n  - *also called systematic, undiversifiable, or market risk.*\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n  \n**Firm-Specific Versus Systematic Risk**\n\n- When many stocks are combined in a large portfolio, the firm-specific risks for each stock will average out and be diversified. The systematic risk, however, will affect all firms and will not be diversified.\n\n. . .\n\n**Consider two types of firms:**\n\n**Type S firms are affected only by systematic risk**. There is a 50% chance the economy will be strong and they will earn a return of 40%. There is a 50% change the economy will be weak and their return will be −20%. Because all these firms face the same systematic risk, **holding a large portfolio of type S firms will not diversify the risk.** \n\n  \n**Type I firms are affected only by firm-specific risks**. Their returns are equally likely to be 35% or  −25%, based on factors specific to each firm’s local market. Because these risks are firm specific, if we hold a portfolio of the stocks of many type I firms, **the risk is diversified**. \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\nYou must be aware that **actual firms are affected by both market-wide risks and firm-specific risks**. \n\nWhen firms carry both types of risk, **only the unsystematic risk will be diversified when many firm’s stocks are combined into a portfolio**. \n\nThe volatility will therefore decline until only the systematic risk remains.\n\n![](figs/bm_10_8.png){width=\"90%\"}\n\n\n\n\n\n\n\n\n\n\n##  {.smaller background=\"#f7e1ba\" }\n\n**That is why the standard deviation of a portfolio (like Ibov) is lower than the weighted average standard deviation of the stocks in it.** It is like free lunch.\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nstart <-'2010-01-01' \nend   <- Sys.Date() \ndata <- yf_collection_get(\"IBOV\", \n                         first_date = start,\n                         last_date = end,\n                         freq_data = \"daily\",)\ndata<-data[complete.cases(data),] \ndata$month <- format(as.Date(data$ref_date, format=\"%y/%m/%d\"),\"%y/%m\")\nsd  <-    data %>%                          \n            group_by(ticker,month) %>%\n            summarise_at(vars(ret_adjusted_prices),list(sd = sd)) %>% \n            as.data.frame()\nvol  <-    data %>%                          \n            group_by(ticker,month) %>%\n            summarise_at(vars(volume),list(vol_sum = sum)) %>% \n            as.data.frame()\nvol2  <-    data %>%                          \n            group_by(month) %>%\n            summarise_at(vars(volume),\n                         list(vol_tot = sum)) %>% \n            as.data.frame()\ndata2 <- merge(sd ,vol, by=c(\"ticker\",\"month\"))\ndata2 <- merge(data2 ,vol2, by=c(\"month\"))\ndata2$w <- data2$vol_sum/data2$vol_tot\ndata2$sdw <- data2$sd * data2$w\ndata3  <-   data2 %>%                          \n            group_by(month) %>%\n            summarise_at(vars(sdw),list(total = sum)) %>% \n            as.data.frame()\ndata3<-data3[complete.cases(data3),] \ndata3$id <-\"Weighted\"\n# Index\nibov <- yf_get(tickers = '^BVSP', \n                         first_date = start,\n                         last_date = end,\n                         freq_data = \"daily\",)\nibov<-ibov[complete.cases(ibov),] \nibov$month <- format(as.Date(ibov$ref_date, format=\"%y/%m/%d\"),\"%y/%m\")\nsd2  <-    ibov %>%                          \n            group_by(month, ticker) %>%\n            summarise_at(vars(ret_closing_prices) ,\n                         list(total = var ) ) %>% \n            as.data.frame()\nsd2$total <- sd2$total^0.5\nsd2$id <-\"ibov\"\nsd2$ticker <- NULL\ndata4 <- rbind(data3,sd2)\np<-ggplot(data=data4, aes(x=month, y=total, color = id, group = id)) +\n  geom_line() + \n        labs(x = \"\",\n             y='Standard deviation',\n             title =\"Diversification benefits - Ibov vs. Weighted sd of individual stocks\") +   theme_solarized()\nggplotly(p)\n```\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\nAn additional comment about diversification:\n\n**1) it occurs only if the risk of the stocks are independent**\n\n  - we will define later what \"independent\" means to us. \n  - intuitively, different firms have different risks.\n\n**2) if the risks are independent, more stocks means less risk... **\n\n  - ... until a certain point.\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**Consider again type I firms, which are affected only by firm-specific risk. Because each individual type I firm is risky, should investors expect to earn a risk premium when investing in type I firms?**\n\n. . .\n\n**The risk premium for diversifiable risk is zero, so investors are not compensated for holding firm-specific risk.**\n\n- The reason is that they can mitigate this part of risk through  diversification.\n\n- Diversification eliminates this risk for free, implying that all investors should have a diversified portfolio. Otherwise, the investor is not rational.\n\n. . .\n\n**The takeaway is:**\n\n**The risk premium of a security is determined by its systematic risk and does not depend on its diversifiable risk.**\n\n\n\n\n\n\n\n\n\n\n## 10.6 Diversification {.smaller background=\"#f7e1ba\" }\n\n**In a world where diversification exists:**\n\n**Standard deviation is not a good measure for risk anymore.**\n\n- Standard deviation is a measure of **a stock's total risk**\n- But if you are diversified, you are not incurring the total risk, only the systematic risk.\n\n\n_We will need a measure of a stock's systematic risk._\n\n. . .\n\n**This measure is called: Beta**\n\n. . .\n\n**But make no mistake:**\n\n**The standard deviation of the returns of a portfolio is still a good measure for the portfolio's risk!**\n\n- But you will not use the average standard deviation of individual stocks contained in a portfolio.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\n**Beta**\n\n**To measure the systematic risk of a stock, determine how much of the variability of its return is due to systematic risk versus unsystematic risk.**\n\n - To determine how sensitive a stock is to systematic risk, look at the average change in the return for each 1% change in the return of a portfolio that fluctuates solely due to systematic risk.\n\n**This is the exact definition of a Beta in a regression or a linear relationship** (we studied that in statistics).\n\n. . .\n\nSaying the same thing in other words:\n\n**Beta measures the expected percent change in the excess return of a security for a 1% change in the excess return of the market portfolio.**\n\n  - Market portfolio contains all stocks: SP500 is a proxy, Ibov is another (for BR).   \n\n\n\n\n\n\n\n\n\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\nSuppose the market portfolio tends to increase by 47% when the economy is strong and decline by 25% when the economy is weak. **What is the beta of a type S firm whose return is 40% on average when the economy is strong and −20% when the economy is weak?**\n\n**Firm S**\n\n- Market changes 47%, stock changes 40%: Beta is $\\frac{40}{47}=0.85$\n- Market changes -25%, stock changes -20%: Beta is $\\frac{20}{25}=0.8$\n- Market changes from -25% to 47% = 72%, stock changes from -20 to 40, Beta is $\\frac{60}{72}=0.833$\n\n. . .\n\nIt does not mean that the stock has three betas...\n\n... it means that we have three estimates for the stock's beta.\n\n\n\n\n\n\n\n\n\n\n\n## 10.7 Measuring Systematic Risk {.smaller background=\"#f2f7ba\" }\n\nSuppose the market portfolio tends to increase by 47% when the economy is strong and decline by 25% when the economy is weak. What is the beta of a type S firm whose return is 40% on average when the economy is strong and −20% when the economy is weak? **What is the beta of a type I firm that bears only idiosyncratic, firm-specific risk?**\n\n**Firm I**\n\n- Does not change, Beta is $\\frac{0}{72}=0$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n##  Market Risk Premium {.smaller background=\"#f2f7ba\" }\n\nWe can define: **The market risk premium is the reward investors expect to earn for holding a portfolio with a beta of 1**.\n\n$$Market\\; risk\\;premium = E[R_m] - R_{rf}$$\n\n. . .\n\nInverting:\n\n$$E[R_m] =  R_{rf} + Market\\; risk\\;premium$$\n\n. . .\n\nThe idea is that investors are risk-averse and dislike risk. Therefore, in order to invest in risky assets, investors demand an extra return.\n\n. . .\n\nFlipping the argument, **a risky asset will have to pay an extra return for its additional risk in order to attract investors.**\n\n. . .\n\nTherefore, there is a clear association between the risk and return of assets.\n\n. . .\n\nAgain: in a diversified portfolio, investors are diversified so they only worry about beta (not standard deviation).\n\n\n\n\n\n\n\n\n\n\n##  Market Risk Premium {.smaller background=\"#f2f7ba\" }\n\nThere is some heterogeneity in the **risk premium** across countries.\n\n<img src=\"figs/bre13901_0703.jpg\" width=\"80%\" />\n\nSource: Brealey, Myers and Allen (13ed)\n\n\n\n\n\n\n\n\n\n\n## Equity Risk Premium ([ERP](https://ceqef.fgv.br/node/594)) {.smaller background=\"#f2f7ba\" }\n\n::: panel-tabset\n\n### R \n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\nurl <- \"https://ceqef.fgv.br/sites/default/files/2023-12/Serie%20de%20Equity%20Risk%20Premium%20Novembro%20de%202023.xlsx\"\ndownload(url, dest=\"files/epr.xlsx\", mode=\"wb\") \ndata <- read_excel(\"files/epr.xlsx\", col_types = c(\"date\",\"numeric\") )\ndata <- data[2:nrow(data),1:2]\ncolnames(data) <- c(\"month\", \"erp\")\n\np<-ggplot(data, aes(x=month, y = erp)) + geom_line() + theme_solarized()+\n  labs(y = \"Equity Risk Premium (ERP)\", \n       x = \"\", \n       title = \"Equity Risk Premium (ERP) in Brazil\" , \n       caption = \"Source: https://ceqef.fgv.br/node/594\" )\nggplotly(p)\n```\n\n\n### Python\n\n```{python}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| results: false\n#| output: true\n#| code-fold: true\n#| code-line-numbers: true\t\n#| output-location: default\n#| code-summary: \"Python\"\n#| collapse: true\n#| eval: true\nimport pandas as pd\nimport matplotlib.pyplot as plt\nurl = \"https://ceqef.fgv.br/sites/default/files/2023-12/Serie%20de%20Equity%20Risk%20Premium%20Novembro%20de%202023.xlsx\"\ndata = pd.read_excel(url, header=2)\ndata = data.iloc[:, 0:2]\ndata.columns = [\"month\", \"erp\"]\nfig, ax = plt.subplots(figsize=(20, 10))\nax.plot(data[\"month\"], data[\"erp\"])\nax.set_xlabel(\"Time\", fontsize=20)\nax.set_ylabel(\"Equity Risk Premium (ERP)\", fontsize=20)\nax.set_title(\"Equity Risk Premium (ERP) in Brazil\", fontsize=25)\nax.text(0.5, -0.1, \"Source: https://ceqef.fgv.br/node/594\", transform=ax.transAxes, ha=\"center\")\nplt.show()\n```\n\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\n## 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\nConsider an investment with a beta = 1.5.\n\nThis investment has 50% more risk than the market portfolio.\n\nEvery 1% change in the market portfolio leads to a 1.5% percent change in the investment's price.\n\n. . .\n\nBased on these figures, we can compute the expected return for this investment **adjusted by the level or risk it provides**.\n\n$$E[R] = R_{rf} + \\beta \\times (E[R_m] - R_{rf})$$\n\n. . .\n\nWe will discuss more about this equation later, when discussing the CAPM (Capital Asset Pricing Model).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 10.8 Beta and cost of capital {.smaller background=\"#c9f7ba\"}\n\nFlipping the argument from the previous slides, **we can compute the cost of capital for this investment** using the same formula:\n\n$$E[R] = R_{rf} + \\beta \\times (E[R_m] - R_{rf})$$\n\n. . .\n\nAssume the economy has a 60% chance that the market return will be 15% next year and a 40% chance the market return will be 5% next year. Assume the risk-free rate is 6%. If a company's beta is 1.18, what is its expected return next year?\n\n. . .\n\nFirst, compute $E[R_m]$:\n\n$$E[R_m] = 60\\% \\times 15\\% + 40\\% \\times 5\\%  = 11\\%$$\n\n. . .\n\nSecond, compute $E[R]$:\n\n$$E[R] = 6\\% + 1.18 \\times (11\\% - 6\\%) = 11.9\\%$$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Problems {.smaller background=\"#522f31\"}\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 1**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q1/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q1easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q1hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 2**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q2/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q2easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q2hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 3**\n\n<iframe height=\"70%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q3/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q3easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q3hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 4**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q4/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q4easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q4hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n##  {.smaller background=\"#522f31\"}\n\n**Question 5**\n\n<iframe height=\"60%\" width=\"100%\" src=\"https://hcm.quarto.pub/p2q5/\"> </iframe>\n\n::: columns\n::: {.column width=\"50%\"}\n<center>\n\n**Easy:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q5easy\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n\n::: {.column width=\"50%\"}\n<center>\n\n**Hard:**\n\n<div \ndata-lyket-type=\"like\" \ndata-lyket-id=\"p2q5hard\" \ndata-lyket-show-counter-from=\"1\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-color-background=\"#522f31\" \ndata-lyket-color-icon=\"#605dfc\" \ndata-lyket-color-highlight=\"#070cfa\" \ndata-lyket-color-primary=\"#ffffff\" \ndata-lyket-color-secondary=\"#522f31\" \ndata-lyket-color-text=\"#605dfc\" \n></div>\n\n</center>\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n# Recap {.smaller visibility=\"hidden\"}\n\n##  Recap {.smaller visibility=\"hidden\"}\n\n**After this chapter, you should know:**\n\n- Understand what a probability distribution is, the mean, the variance, and the standard deviation.\n\n- Compute the realized or total return for an investment.\n\n- Use the empirical distribution of realized returns, estimate expected return, variance, and standard deviation (or volatility) of returns.\n\n- Use the standard error of the estimate to gauge the amount of estimation error in the estimate (i.e., the average).\n\n- Discuss the volatility and return characteristics of small stocks versus large stocks (and other assets).\n\n- Describe the relationship between volatility and return of individual stocks.\n\n\n\n\n\n\n\n\n##  Recap {.smaller visibility=\"hidden\"}\n\n**After this chapter, you should know:**\n\n- Define and contrast idiosyncratic and systematic risks and the risk premium required.\n\n- Understand beta as a measure of the systematic risk of a security.\n\n- Use the Capital Asset Pricing Model to calculate the expected return for a risky security.\n\n- Use the Capital Asset Pricing Model to calculate the cost of capital for a particular project.\n\n\n\n\n\n\n\n\n## How did you like this lecture? {background=\"#a2bef5\"}\n\n<center>\n\n**Your response:**\n\n<div \ndata-lyket-type=\"rate\" \ndata-lyket-id=\"part-2\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-show-rating=\"user\" \ndata-lyket-template=\"custom\" \n></div>\n\n\n**Average response:**\n<div \ndata-lyket-type=\"rate\" \ndata-lyket-id=\"part-2\" \ndata-lyket-namespace=\"EFPART2\" \ndata-lyket-show-rating=\"average\" \ndata-lyket-template=\"custom\" \n></div>\n\n</center>\n\n\n\n\n\n\n## Comments? {background=\"#a2bef5\"}\n\n<script src=\"https://giscus.app/client.js\"\n        data-repo=\"henriquecastror/efcomments-part-2\"\n        data-repo-id=\"R_kgDOK8BPNw\"\n        data-category-id=\"DIC_kwDOK8BPN84Cb46r\"\n        data-mapping=\"pathname\"\n        data-strict=\"0\"\n        data-reactions-enabled=\"1\"\n        data-emit-metadata=\"0\"\n        data-input-position=\"bottom\"\n        data-theme=\"light\"\n        data-lang=\"en\"\n        crossorigin=\"anonymous\"\n        async>\n</script>\n\n\n::: footer\n:::\n\n\n\n\n\n\n## **THANK YOU!** {background=\"#b1cafa\"}\n\n::: columns\n\n::: {.column width=\"60%\"}\n\n**QUESTIONS?**\n\n![](figs/qa2.png){width=150% heigth=150%}\n:::\n::: {.column width=\"40%\"}\n**Henrique C. Martins**\n\n-   [FGV/EAESP](https://eaesp.fgv.br/en/people/henrique-castro-martins)\n-   [Personal Website](https://henriquemartins.net/)\n-   [LinkedIn](https://www.linkedin.com/in/henriquecastror/)\n-   [Lattes](http://lattes.cnpq.br/6076997472159785)\n-   [Scholar](https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&hl=pt-BR&oi=ao)  \n:::\n:::\n\n::: footer\n:::\n\n\n\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":{"method":"mathjax","url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML-full"},"slide-level":2,"to":"revealjs","css":["logo.css"],"output-file":"part_2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.3.450","auto-stretch":true,"editor":"visual","title":"Estratégia Financeira","subtitle":" **Part 2 - ch.10 Capital Markets and the Pricing of Risk** ","author":[{"name":" **Henrique C. Martins** ","affiliation":"**[![](figs/background6.png){width=300px}](https://eaesp.fgv.br/en)**"}],"date":"last-modified","date-format":"DD-MM-YYYY","title-block-banner":true,"title-slide-attributes":{"data-background-color":"#b1cafa"},"include-after":["<script type=\"text/javascript\">\n  Reveal.on('ready', event => {\n    if (event.indexh === 0) {\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n  });\n  Reveal.addEventListener('slidechanged', (event) => {\n    if (event.indexh === 0) {\n      Reveal.configure({ slideNumber: null });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n    if (event.indexh === 1) {\n      Reveal.configure({ slideNumber: 'c' });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = null;\n    }\n  });\n</script>\n"],"slideNumber":true,"theme":"simple","chalkboard":true,"previewLinks":"auto","logo":"figs/background8.png","footer":" **[**Henrique C. Martins**] [[henrique.martins@fgv.br](mailto:henrique.martins@fgv.br)] [[Teaching Resources](https://henriquemartins.net/teaching/)] [[Comments](https://henriquemartins.net/teaching/financial_strategy/part_2.html#/comments)]** ","multiplex":true,"scrollable":true}}},"projectFormats":["html"]}