{"title":"Empirical Methods in Finance","markdown":{"yaml":{"title":"Empirical Methods in Finance","subtitle":"Part 7","author":"Henrique C. Martins","format":{"revealjs":{"slide-number":true,"theme":"simple","chalkboard":true,"preview-links":"auto","logo":"figs/background8.png","css":"logo.css","footer":"**[**Henrique C. Martins**] [[henrique.martins@fgv.br](mailto:henrique.martins@fgv.br)][Do not use without permission]**  ","multiplex":true,"scrollable":true}},"title-slide-attributes":{"data-background-color":"#b1cafa"},"include-after":"<script type=\"text/javascript\">\n  Reveal.on('ready', event => {\n    if (event.indexh === 0) {\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n  });\n  Reveal.addEventListener('slidechanged', (event) => {\n    if (event.indexh === 0) {\n      Reveal.configure({ slideNumber: null });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n    if (event.indexh === 1) {\n      Reveal.configure({ slideNumber: 'c' });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = null;\n    }\n  });\n</script>\n"},"headingText":"library(reticulate)","containsRefs":false,"markdown":"\n\n\n```{r setup}\n#| include: false\n#| warning: false\n\n# use_python(\"C:/Users/hcmrt/AppData/Local/Programs/Python/Python310/python.exe\")\nlibrary(reticulate)\nlibrary(Statamarkdown)\n#reticulate::py_install(\"matplotlib\")\n#reticulate::py_install(\"seaborn\")\n#reticulate::py_install(\"pyfinance\")\n#reticulate::py_install(\"xlrd\")\n#reticulate::py_install(\"quandl\")\n#reticulate::py_install(\"linearmodels\")\n#reticulate::py_install(\"causalml\")\n\n```\n\n\n\n\n\n# DiD Introduction {.smaller background=\"#c4f5d7\"}\n\n## DiD Introduction  {.smaller background=\"#c4f5d7\"}\n\nLet's introduce DiD using the most famous example in the topic: John Snow‚Äôs 1855 findings that demonstrated to the world that cholera was spread by fecally-contaminated water and not via the air (Snow 1855)\n\n- Snow compared the periods of 1849 and 1854 to analyze the impact of a  change in London's water supply dynamics. \n- Various water companies, each drawing water from different sections of the Thames river, served the city's water needs. \n- The downstream areas of the Thames, where some companies sourced their water, were susceptible to contamination due to the disposal of various substances, including fecal matter from cholera-infected individuals. \n- In the interim between 1849 and 1854, a pivotal policy was implemented: the Lambeth Company was mandated by an Act of Parliament to relocate its water intake upstream of London.\n\n\n\n\n\n## DiD Introduction  {.smaller background=\"#c4f5d7\"}\n\n**This is what happened.**\n\n| Region Supplier                        | Death Rates 1849 | Death Rates 1854 |\n|----------------------------------------|------------------|------------------|\n| Non-Lambeth Only (Dirty)               | 134.9            | 146.6            |\n| Lambeth + Others (Mix Dirty and Clean) | 130.1            | 84.9             |\n\n. . . \n\nThe specific DID estimate we can get here is:\n\n- $(84.9-130.1)-(146.9-134.9)=-57.2$.\n\nThis resembles a \"modern\" DiD. \n\n\n\n\n\n\n\n\n# Shocks {.smaller background=\"#95c9a9\"}\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\n**Shock-based designs use an external shock to limit selection bias. **\n\nThey are very hard to find, but if you do, you can reasonably estimate causal effects.\n\nThey are sources of exogenous variations in the X, which are crucial to causality when we have some of the problems discussed before. \n\nA shock is often considered the first-best solution to causal inference (randomized control trials are the second-best).\n\n. . . \n\nIn social sciences, we cannot have randomized control trials. It is not feasible to have experiments.\n\nThat is why we often explore the idea of \"Natural experiments\" or \"Natural shocks\" (I often use the terms interchangeably)\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA **Natural experiment** is an exogenous variation that change a variable in a random subset of firms. \n\n- Regulations, laws, etc.\n- Natural disasters.\n- Sudden death of CEOs or a product, etc.\n- The gender of a newborn.\n\n\nBecause the variation that occur in x is truly exogenous, the CMI holds and thus we can infer causality.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n1) **Shock Strength**: The shock is strong enough to significantly change firm behavior or incentives.\n\n. . .\n \n2) **Exogenous Shock**: The shock came from ‚Äúoutside‚Äù the system one is studying.\n\n  - Treated firms did not choose whether to be treated, \n  - cannot anticipate the shock, \n  - the shock is expected to be permanent, and \n  - there is no reason to believe that which firms were treated depends on unobserved firm characteristics.\n  \nIf the shock is exogenous, or appears to be, we are less worried that unobservables might be correlated with both assignment to treatment and the potential outcomes, and thus generate omitted variable bias. \n\nShock exogeneity should be defended, not just assumed.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n3) **‚ÄúAs If Random‚Äù Assignment**: The shock must separate firms into treated and controls in a manner which is close to random.\n\n. . .\n\n4) **Covariate balance:** The forcing and forced variables aside, the shock should produce reasonable covariate balance between treated and control firms, including ‚Äúcommon support‚Äù (reasonable overlap between treated and control firms on all covariates). \n\nSomewhat imperfect balance can be address with balancing methods, but severe imbalance undermines shock credibility, even if the reason for imbalance is not obvious. Covariate balance should be reported.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n5) **Only-Through Condition(s):** We must have reason to believe that the apparent effect of the shock on the outcome came only through the shock (sometimes, through a specific channel). \n\nThe shock must be ‚Äúisolated‚Äù, there must be no other shock, at around the same time, that could also affect treated firms differently than control firms. \nAnd if one expects the shock to affect outcomes through a particular channel, the shock must also affect the outcome only through that channel.\n\n. . .\n\nIn IV analysis, this is called an **‚Äúexclusion restriction‚Äù** or **‚Äúonly-through condition\"**, because one assumes away (excludes) other channels.\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nThe idea of a natural shock is often mixed with the difference-in-differences (DiD) design.\n\nIt is more common that it should that people refer to shocks when they want to refer to DiD. \n\nA Did design explores a Natural shock to estimate causal effects.\n\n**A good shock generates, by nature, random assignment**.\n\n\n\n\n\n\n\n\n\n## Remember  {.smaller background=\"#693d3a\"}\n\n**Remember:**\n\nWhen dealing with **causal inference**, we have to find ways to approximate what the hidden potential outcome of the treated units is. \n\nThat is, the challenge in identifying causal effects is that the untreated potential outcomes, $Y_{i,0}$, are never\nobserved for the treated group ($D_i= 1$). The \"second\" term in the following equation:\n\nATET = $\\frac{1}{N} (E[Y_{i,1}|D_i=1] - E[Y_{i,0}|D_i=1])$\n\nWe need an empirical design to **\"observe\"** what we do not really observe (i.e., the counterfactual). \n\n\n\n\n\n\n\n# Single differences  {.smaller background=\"#a4baac\"}\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\nThere are two single differences we can use to estimate the causal effect of a treatments (i.e., a shock).\n\n**1) Single Cross-Sectional Differences After Treatment**\n\n**2) Single Time-Series Difference Before and After Treatment**\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**1) Single Cross-Sectional Differences After Treatment**\n\nOne approach to estimating a parameter that summarizes the treatment effect is to compare the post-treatment outcomes of the treatment and control groups. \n\nThis method is often used when there is no data available on pre-treatment outcomes.\n\nIt takes the form:\n\n$$y=\\beta_0+\\beta_1d_i+\\epsilon$$\n\nwhere $d_i$ is a dummy marking the units that are treated. The treatment effect is given by $\\beta_1$\n\nThis is a cross-sectional comparison, using only post-treatment values.\n\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**1) Single Cross-Sectional Differences After Treatment**\n\nYou may add the interaction between the treatment dummy and the years.\n\n$$y=\\beta_0+\\beta_1d_i\\times year_1+\\beta_2d_i\\times year_2 +\\beta_3d_i\\times year_3+ . . . +\\epsilon$$\n\nThis design allows the treatment effect to vary over time by interacting the treatment dummy with period dummies.\n\n\n\n\n. . . \n\n\n**What is the endogeneity concern here?**\n\n. . .\n\nThe endogeneity concern is that these firms‚Äô $y$ were different and could become more different between the treated and control groups even if the shock had not happened. \n\nThat is, there is something in the residual that explains the differences in $y$ that is correlated with the $d$.\n\n\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**2) Single Time-Series Difference Before and After Treatment**\n\nA second way to estimate the treatment effect is to compare the outcome after the treatment with the outcome before the treatment for **just those units that are treated.**\n\nThe difference from before is that you have data before the treatment, but you only have data for the treated units.\n\n$$y=\\beta_0+\\beta_1 time+\\epsilon$$\n\nwhere $time$ marks the years after the treatment. The treatment effect is given by $\\beta_1$\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**2) Single Time-Series Difference Before and After Treatment**\n\nYou can also estimate a multi-year regression.\n\n$$y=\\beta_0+\\beta_1year_1 +\\beta_2\\times year_2 +\\beta_3\\times year_3+ . . . +\\epsilon$$\n\n. . . \n\n\n**What is the endogeneity concern here?**\n\n. . .\n\nThe endogeneity concern is that these firms‚Äô $y$ could have changed over the period of observation even if the shock had not happened. \n\nThat is, there is something in the error term that explains $y$ that is correlated with the $year$ dummies.\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\nThe combination of the  **1) Single Cross-Sectional Differences After Treatment** and **2) Single Time-Series Difference Before and After Treatment** is called **Difference-in-Differences**.\n\n\n\n\n\n\n\n\n# Difference-in-Differences {.smaller background=\"#8bc9a2\"}\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nThis is one of the most popular methods in social sciences for estimating causal effects in non-experimental settings.\n\nThe literature is exploding over the recent years.\n\n. . . \n\nThere is one group that is treated, another is the control. \n\nThere are two periods of time, before and after the treatment.\n\nAnd the treated group receives the treatment in the second period.\n\n**The key identifying assumption is that the average outcome among the treated and comparison populations would have followed ‚Äúparallel trends‚Äù in the absence of treatment.**\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\n*The two single difference estimators complement one another.*\n\n*The cross-sectional comparison avoids the problem of omitted trends by comparing two groups over the same time period.*\n\n*The time series comparison avoids the problem of unobserved differences between two different groups of firms by looking at the same firms before and after the change.*\n\n*The double difference, difference-in-differences (DD), estimator combines these two estimators to take advantage of both estimators‚Äô strengths.* \n\n([Roberts and Whited, 2014](https://doi.org/10.1016/B978-0-44-453594-8.00007-0))\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\nDifference-in-differences methods overcome the identification challenge via assumptions that allow us to impute the mean counterfactual untreated outcomes for the treated group by using \n\n- (a) the change in outcomes for the untreated group and \n- (b) the baseline outcomes for the treated group. \n\nThe key assumption for identifying the causal effect is the **parallel trends assumption**, which intuitively states that **the average outcome for the treated and untreated units would have evolved in parallel if treatment had not occurred**.\n\n**Assumption 1 (Parallel Trends).**\n\n$E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=1] = E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=0]$\n\n\nIn other words: **this condition means that in the absence of treatment, the average change in the $y$ would have been the same for both the treatment and control groups.**\n\n\n\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n**The counterfactual is determined by the assumption of a parallel trend between the treated and control groups.** **[MM](https://www.masteringmetrics.com/)**\n\n\n![](figs/did1.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n![](figs/slides4-did.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nInserting more periods.\n\n![](figs/did2.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nA more realistic example. ([The effect](https://theeffectbook.net/ch-DifferenceinDifference.html))\n\n\n![](figs/theeffect1.png)\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\n**Assumption 2 (No anticipatory effects).**\n\n*The treatment has no causal effect prior to its implementation.*\n\n$$Y_{i,0,t=1}=Y_{i,1,t=1}$$\n\nPrior to the treatment (t=1), there is no effect of the treatment.\n\n\n\n\n\n\n\n\n\n# Estimation  {.smaller background=\"#c6f7ec\"}\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\nLet's see how to implement a DiD model. The canonical DiD model is the followin:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\epsilon_{i,t}$$\n\nWhere:\n\n$treated_i$ is a dummy marking the units that received the treatment.\n\n$time_t$ is a dummy marking the year of the treatment and the years after.\n\n\n\n\n\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\nLet's see how to implement a DiD model. The canonical DiD model is the followin:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\epsilon_{i,t}$$\n\n\n$\\beta_0$ is the **average $y_{i,t}$** for the **control units before the treatment ($time_t$ =0 and $treated_i$ = 0)**.\n\n$\\beta_0+\\beta_1$ is the **average $y_{i,t}$** for the **control units after the treatment ($time_t$ =1 and $treated_i$ = 0)**.\n\n$\\beta_0+\\beta_2$ is the **average $y_{i,t}$** for the **treated units before the treatment ($time_t$ =0 and $treated_i$ = 1)**.\n\n$\\beta_0+\\beta_1+\\beta_2+\\beta_3$ is the **average $y_{i,t}$** for the **treated units after the treatment ($time_t$ =1 and $treated_i$ = 1)**.\n\n\n\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\n+------------------+-----------------------------------+---------------------+---------------------+\n|                  |   Post-treat. (1)                 |  Pre-treat. (2)     |  **Diff. (1-2)**    |\n+------------------+-----------------------------------+---------------------+---------------------+\n|   Treated (a)    | $\\beta_0+\\beta_1+\\beta_2+\\beta_3$ | $\\beta_0+\\beta_2$   |**$\\beta_1+\\beta_3$**|\n+------------------+-----------------------------------+---------------------+---------------------+\n|  Control (b)     | $\\beta_0+\\beta_1$                 |  $\\beta_0$          | **$\\beta_1$**       |\n+------------------+-----------------------------------+---------------------+---------------------+\n| **Diff. (a-b)**  | **$\\beta_2+\\beta_3$**             |  **$\\beta_2$**      | **$\\beta_3$**       |\n+------------------+-----------------------------------+---------------------+---------------------+\n\n\n**This is why we call difference-in-differences.**\n\n**$\\beta_3$** gives us an estimate of the treatment effect on the treated units (ATE).\n\nThis is very popular because you can run as a regression.\n\n. . . \n\nMany papers simply show this table as final result.\n\nHowever, it is also possible that you include additional covariates (i.e., controls) in a DiD design. \n\nYou can also modify this to test the timing of the treatment (discussed later).\n\n\n\n\n\n\n\n\n\n\n# Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nIf you add controls, you have something in the form:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\beta_4x_{1,i,t}+ \\beta_5x_{2,i,t}+ ...+ \\epsilon_{i,t}$$\n\n. . . \n\n::: {.callout-important}\nBad Controls problem: Never add a control that is also affected by the treatment. \n:::\n\n. . . \n\n::: {.callout-tip}\nUsing pre-treatment values is good practice. \n:::\n\nIf you are including a *good control*, you should get lower standard deviations of the estimated effects.\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nOne way of adding more controls is by adding FEs.\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + FirmFE+ YearFE + \\epsilon_{i,t}$$\n\nThey help control for unobserved heterogeneity at the firm-level and in each year.\n\n. . . \n\n**But what do $\\beta_1$ and  $\\beta_2$ mean now?**\n\n. . .\n \n**Answer:** They are perfectly correlated with the $FirmFE$ and $YearFE$, respectively.\n\nReason: because they don't vary across each firm and year, respectively. \n\nThe software will most likely drop one $FirmFE$ and one $YearFE$, thus $\\beta_1$ and  $\\beta_2$ mean nothing.\n\n. . .\n\nI am guilty of this mistake because a referee asked and I couldn't reply properly.\n\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nYou will be better off if you estimate:\n\n$$y_{i,t} = \\beta_0 + \\beta_3 treated_i \\times time_t + FirmFE+ YearFE + \\epsilon_{i,t}$$\n\nThis is called a **generalized DiD**.\n\nThe $FirmFE$ allow that each firm has one intercept (i.e., one average $y_{i,t}$).\n\nThe $YearFE$ accommodate a potential shock in $y_{i,t}$ in each year.\n\n\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nAdditionally, adding *good* controls can be helpful to maintain the shock **exogenous (i.e., random) after controlling by X.**\n\n. . . \n\nImagine that a financial shock is more likely to affect high leveraged firms than low-leverage ones.\n\n1) the shock will not change the leverage decision of each firm.\n\n2) we believe that high leveraged firms will have a different $y_{i,t}$ after the treatment.\n\nYou may add leverage as a control to make sure the shock is random given the firms' levels of leverage.\n\n. . .\n\nIf you may believe that the leverage will change after the treatment, you can use pre-treatment values (interacted with the time dummies).\n\nIn this case, you are controlling for the pre-treatment condition but are not including the bias that might come due to changes in leverage after the treatment.\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\n*If assignment is random, then including additional covariates should have a negligible effect on the estimated treatment effect.*\n\n*Thus, a large discrepancy between the treatment effect estimates with and without additional controls raises a red flag.* \n\n*If assignment to treatment and control groups is not random but dictated by an observable rule, then controlling for this rule via covariates in the regression satisfies the conditional mean zero assumption required for unbiased estimates.* \n\n*Regardless of the motivation, it is crucial to remember that any covariates included as controls must be unaffected by the treatment, a condition that eliminates other outcome variables and restricts most covariates to pre-treatment values.*\n\n([Roberts and Whited, 2014](https://doi.org/10.1016/B978-0-44-453594-8.00007-0))\n \n \n\n\n\n\n\n# Comment about DiD {.smaller background=\"#aecfc7\"}\n\n## Comment about DiD  {.smaller background=\"#aecfc7\"}\n\n([The effect](https://theeffectbook.net/ch-DifferenceinDifference.html))\n\n\n*Parallel trends means we have to think very carefully about how our dependent variable is measured and transformed.*\n\n*Because parallel trends is an assumption about the size of a gap remaining constant, which means something different depending on how you measure that gap.*\n\n*For example, if parallel trends holds for dependent variable $Y$, then it doesn‚Äôt hold for $ln(y)$, and vice versa*\n\n. . .\n\n*For example, say that in the pre-treatment period $y$ is 10 for the control group and 20 for the treated group. In the post-treatment period, in the counterfactual world where treatment never happened,$y$ would be 15 for the control group and 25 for the treated group. Gap of $20-10=10$  before, and $25-15=10$ after. Parallel trends holds!*\n\n. . . \n\n*However: $Ln(20)-ln(10)=.693$  before, and $ln(25)-ln(15)=.51$ after. *\n\n\n\n\n\n\n\n\n\n\n# Example of DiD  {.smaller background=\"#98b8b0\"}\n\n## Example of DiD  {.smaller background=\"#98b8b0\"}\n\n::: panel-tabset\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\n# Load the necessary library\nlibrary(foreign)\ndata <- read.dta(\"files/kielmc.dta\")\ndata$y81_nearinc <- data$y81 * data$nearinc\nmodel1 <- lm(rprice ~ y81 + nearinc + y81_nearinc, data = data)\nmodel2 <- lm(rprice ~ y81 + nearinc + y81_nearinc + age + agesq, data = data)\nmodel3 <- lm(rprice ~ y81 + nearinc + y81_nearinc + age + agesq + intst + land + area + rooms + baths, data = data)\nsummary(model3)\n```\n\n\n### Stata\n\n```{stata}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output: true\n#| output-location: default\n#| code-fold: true\n#| code-line-numbers: true\n#| eval: true\n#| code-summary: \"Stata\"\nuse \"files/kielmc.dta\", clear\ngen y81_nearinc = y81 * nearinc\neststo:qui reg rprice y81 nearinc y81_nearinc \neststo:qui reg rprice y81 nearinc y81_nearinc age agesq \neststo:qui reg rprice y81 nearinc y81_nearinc age agesq intst land area rooms baths\nesttab , compress\n```  \n\n:::\n\n\n\n\n\n\n\n\n\n\n\n## üôã‚Äç‚ôÇÔ∏è **Any Questions?**{ .smaller  background=\"#fdf6e3\"}\n\n::: columns\n::: {.column width=\"50%\"}\n### Thank You!\n\n![](figs/qa2.png){width=\"110%\" style=\"box-shadow: none;\"}\n\n:::\n\n::: {.column width=\"50%\"}\n<div style=\"text-align:right;\">\n  <img src=\"figs/avatar.jpg\" width=\"120px\" style=\"border-radius:50%; box-shadow:0 4px 12px rgba(0,0,0,.25);\" />\n</div>\n\n### **Henrique C. Martins**\n\n- üåê [FGV/EAESP](https://eaesp.fgv.br/en/people/henrique-castro-martins)  \n- üíº [LinkedIn](https://www.linkedin.com/in/henriquecastror/)  \n- üß† [Google Scholar](https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&hl=pt-BR&oi=ao)  \n- üìÑ [Lattes CV](http://lattes.cnpq.br/6076997472159785)  \n- üè† [Personal Website](https://henriquemartins.net/)  \n:::\n:::\n\n","srcMarkdownNoYaml":"\n\n\n```{r setup}\n#| include: false\n#| warning: false\n\n# library(reticulate)\n# use_python(\"C:/Users/hcmrt/AppData/Local/Programs/Python/Python310/python.exe\")\nlibrary(reticulate)\nlibrary(Statamarkdown)\n#reticulate::py_install(\"matplotlib\")\n#reticulate::py_install(\"seaborn\")\n#reticulate::py_install(\"pyfinance\")\n#reticulate::py_install(\"xlrd\")\n#reticulate::py_install(\"quandl\")\n#reticulate::py_install(\"linearmodels\")\n#reticulate::py_install(\"causalml\")\n\n```\n\n\n\n\n\n# DiD Introduction {.smaller background=\"#c4f5d7\"}\n\n## DiD Introduction  {.smaller background=\"#c4f5d7\"}\n\nLet's introduce DiD using the most famous example in the topic: John Snow‚Äôs 1855 findings that demonstrated to the world that cholera was spread by fecally-contaminated water and not via the air (Snow 1855)\n\n- Snow compared the periods of 1849 and 1854 to analyze the impact of a  change in London's water supply dynamics. \n- Various water companies, each drawing water from different sections of the Thames river, served the city's water needs. \n- The downstream areas of the Thames, where some companies sourced their water, were susceptible to contamination due to the disposal of various substances, including fecal matter from cholera-infected individuals. \n- In the interim between 1849 and 1854, a pivotal policy was implemented: the Lambeth Company was mandated by an Act of Parliament to relocate its water intake upstream of London.\n\n\n\n\n\n## DiD Introduction  {.smaller background=\"#c4f5d7\"}\n\n**This is what happened.**\n\n| Region Supplier                        | Death Rates 1849 | Death Rates 1854 |\n|----------------------------------------|------------------|------------------|\n| Non-Lambeth Only (Dirty)               | 134.9            | 146.6            |\n| Lambeth + Others (Mix Dirty and Clean) | 130.1            | 84.9             |\n\n. . . \n\nThe specific DID estimate we can get here is:\n\n- $(84.9-130.1)-(146.9-134.9)=-57.2$.\n\nThis resembles a \"modern\" DiD. \n\n\n\n\n\n\n\n\n# Shocks {.smaller background=\"#95c9a9\"}\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\n**Shock-based designs use an external shock to limit selection bias. **\n\nThey are very hard to find, but if you do, you can reasonably estimate causal effects.\n\nThey are sources of exogenous variations in the X, which are crucial to causality when we have some of the problems discussed before. \n\nA shock is often considered the first-best solution to causal inference (randomized control trials are the second-best).\n\n. . . \n\nIn social sciences, we cannot have randomized control trials. It is not feasible to have experiments.\n\nThat is why we often explore the idea of \"Natural experiments\" or \"Natural shocks\" (I often use the terms interchangeably)\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA **Natural experiment** is an exogenous variation that change a variable in a random subset of firms. \n\n- Regulations, laws, etc.\n- Natural disasters.\n- Sudden death of CEOs or a product, etc.\n- The gender of a newborn.\n\n\nBecause the variation that occur in x is truly exogenous, the CMI holds and thus we can infer causality.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n1) **Shock Strength**: The shock is strong enough to significantly change firm behavior or incentives.\n\n. . .\n \n2) **Exogenous Shock**: The shock came from ‚Äúoutside‚Äù the system one is studying.\n\n  - Treated firms did not choose whether to be treated, \n  - cannot anticipate the shock, \n  - the shock is expected to be permanent, and \n  - there is no reason to believe that which firms were treated depends on unobserved firm characteristics.\n  \nIf the shock is exogenous, or appears to be, we are less worried that unobservables might be correlated with both assignment to treatment and the potential outcomes, and thus generate omitted variable bias. \n\nShock exogeneity should be defended, not just assumed.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n3) **‚ÄúAs If Random‚Äù Assignment**: The shock must separate firms into treated and controls in a manner which is close to random.\n\n. . .\n\n4) **Covariate balance:** The forcing and forced variables aside, the shock should produce reasonable covariate balance between treated and control firms, including ‚Äúcommon support‚Äù (reasonable overlap between treated and control firms on all covariates). \n\nSomewhat imperfect balance can be address with balancing methods, but severe imbalance undermines shock credibility, even if the reason for imbalance is not obvious. Covariate balance should be reported.\n\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nA good shock has some conditions [source](https://cfr.pub/published/papers/cfr-0036.pdf):\n\n5) **Only-Through Condition(s):** We must have reason to believe that the apparent effect of the shock on the outcome came only through the shock (sometimes, through a specific channel). \n\nThe shock must be ‚Äúisolated‚Äù, there must be no other shock, at around the same time, that could also affect treated firms differently than control firms. \nAnd if one expects the shock to affect outcomes through a particular channel, the shock must also affect the outcome only through that channel.\n\n. . .\n\nIn IV analysis, this is called an **‚Äúexclusion restriction‚Äù** or **‚Äúonly-through condition\"**, because one assumes away (excludes) other channels.\n\n\n\n\n\n\n## Shocks  {.smaller background=\"#95c9a9\"}\n\nThe idea of a natural shock is often mixed with the difference-in-differences (DiD) design.\n\nIt is more common that it should that people refer to shocks when they want to refer to DiD. \n\nA Did design explores a Natural shock to estimate causal effects.\n\n**A good shock generates, by nature, random assignment**.\n\n\n\n\n\n\n\n\n\n## Remember  {.smaller background=\"#693d3a\"}\n\n**Remember:**\n\nWhen dealing with **causal inference**, we have to find ways to approximate what the hidden potential outcome of the treated units is. \n\nThat is, the challenge in identifying causal effects is that the untreated potential outcomes, $Y_{i,0}$, are never\nobserved for the treated group ($D_i= 1$). The \"second\" term in the following equation:\n\nATET = $\\frac{1}{N} (E[Y_{i,1}|D_i=1] - E[Y_{i,0}|D_i=1])$\n\nWe need an empirical design to **\"observe\"** what we do not really observe (i.e., the counterfactual). \n\n\n\n\n\n\n\n# Single differences  {.smaller background=\"#a4baac\"}\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\nThere are two single differences we can use to estimate the causal effect of a treatments (i.e., a shock).\n\n**1) Single Cross-Sectional Differences After Treatment**\n\n**2) Single Time-Series Difference Before and After Treatment**\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**1) Single Cross-Sectional Differences After Treatment**\n\nOne approach to estimating a parameter that summarizes the treatment effect is to compare the post-treatment outcomes of the treatment and control groups. \n\nThis method is often used when there is no data available on pre-treatment outcomes.\n\nIt takes the form:\n\n$$y=\\beta_0+\\beta_1d_i+\\epsilon$$\n\nwhere $d_i$ is a dummy marking the units that are treated. The treatment effect is given by $\\beta_1$\n\nThis is a cross-sectional comparison, using only post-treatment values.\n\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**1) Single Cross-Sectional Differences After Treatment**\n\nYou may add the interaction between the treatment dummy and the years.\n\n$$y=\\beta_0+\\beta_1d_i\\times year_1+\\beta_2d_i\\times year_2 +\\beta_3d_i\\times year_3+ . . . +\\epsilon$$\n\nThis design allows the treatment effect to vary over time by interacting the treatment dummy with period dummies.\n\n\n\n\n. . . \n\n\n**What is the endogeneity concern here?**\n\n. . .\n\nThe endogeneity concern is that these firms‚Äô $y$ were different and could become more different between the treated and control groups even if the shock had not happened. \n\nThat is, there is something in the residual that explains the differences in $y$ that is correlated with the $d$.\n\n\n\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**2) Single Time-Series Difference Before and After Treatment**\n\nA second way to estimate the treatment effect is to compare the outcome after the treatment with the outcome before the treatment for **just those units that are treated.**\n\nThe difference from before is that you have data before the treatment, but you only have data for the treated units.\n\n$$y=\\beta_0+\\beta_1 time+\\epsilon$$\n\nwhere $time$ marks the years after the treatment. The treatment effect is given by $\\beta_1$\n\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\n**2) Single Time-Series Difference Before and After Treatment**\n\nYou can also estimate a multi-year regression.\n\n$$y=\\beta_0+\\beta_1year_1 +\\beta_2\\times year_2 +\\beta_3\\times year_3+ . . . +\\epsilon$$\n\n. . . \n\n\n**What is the endogeneity concern here?**\n\n. . .\n\nThe endogeneity concern is that these firms‚Äô $y$ could have changed over the period of observation even if the shock had not happened. \n\nThat is, there is something in the error term that explains $y$ that is correlated with the $year$ dummies.\n\n\n\n\n\n## Single differences  {.smaller background=\"#a4baac\"}\n\nThe combination of the  **1) Single Cross-Sectional Differences After Treatment** and **2) Single Time-Series Difference Before and After Treatment** is called **Difference-in-Differences**.\n\n\n\n\n\n\n\n\n# Difference-in-Differences {.smaller background=\"#8bc9a2\"}\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nThis is one of the most popular methods in social sciences for estimating causal effects in non-experimental settings.\n\nThe literature is exploding over the recent years.\n\n. . . \n\nThere is one group that is treated, another is the control. \n\nThere are two periods of time, before and after the treatment.\n\nAnd the treated group receives the treatment in the second period.\n\n**The key identifying assumption is that the average outcome among the treated and comparison populations would have followed ‚Äúparallel trends‚Äù in the absence of treatment.**\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\n*The two single difference estimators complement one another.*\n\n*The cross-sectional comparison avoids the problem of omitted trends by comparing two groups over the same time period.*\n\n*The time series comparison avoids the problem of unobserved differences between two different groups of firms by looking at the same firms before and after the change.*\n\n*The double difference, difference-in-differences (DD), estimator combines these two estimators to take advantage of both estimators‚Äô strengths.* \n\n([Roberts and Whited, 2014](https://doi.org/10.1016/B978-0-44-453594-8.00007-0))\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\nDifference-in-differences methods overcome the identification challenge via assumptions that allow us to impute the mean counterfactual untreated outcomes for the treated group by using \n\n- (a) the change in outcomes for the untreated group and \n- (b) the baseline outcomes for the treated group. \n\nThe key assumption for identifying the causal effect is the **parallel trends assumption**, which intuitively states that **the average outcome for the treated and untreated units would have evolved in parallel if treatment had not occurred**.\n\n**Assumption 1 (Parallel Trends).**\n\n$E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=1] = E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=0]$\n\n\nIn other words: **this condition means that in the absence of treatment, the average change in the $y$ would have been the same for both the treatment and control groups.**\n\n\n\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n**The counterfactual is determined by the assumption of a parallel trend between the treated and control groups.** **[MM](https://www.masteringmetrics.com/)**\n\n\n![](figs/did1.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n![](figs/slides4-did.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nInserting more periods.\n\n![](figs/did2.png) \n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\nA more realistic example. ([The effect](https://theeffectbook.net/ch-DifferenceinDifference.html))\n\n\n![](figs/theeffect1.png)\n\n\n\n\n\n\n## Difference-in-Differences  {.smaller background=\"#8bc9a2\"}\n\n\n**Assumption 2 (No anticipatory effects).**\n\n*The treatment has no causal effect prior to its implementation.*\n\n$$Y_{i,0,t=1}=Y_{i,1,t=1}$$\n\nPrior to the treatment (t=1), there is no effect of the treatment.\n\n\n\n\n\n\n\n\n\n# Estimation  {.smaller background=\"#c6f7ec\"}\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\nLet's see how to implement a DiD model. The canonical DiD model is the followin:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\epsilon_{i,t}$$\n\nWhere:\n\n$treated_i$ is a dummy marking the units that received the treatment.\n\n$time_t$ is a dummy marking the year of the treatment and the years after.\n\n\n\n\n\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\nLet's see how to implement a DiD model. The canonical DiD model is the followin:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\epsilon_{i,t}$$\n\n\n$\\beta_0$ is the **average $y_{i,t}$** for the **control units before the treatment ($time_t$ =0 and $treated_i$ = 0)**.\n\n$\\beta_0+\\beta_1$ is the **average $y_{i,t}$** for the **control units after the treatment ($time_t$ =1 and $treated_i$ = 0)**.\n\n$\\beta_0+\\beta_2$ is the **average $y_{i,t}$** for the **treated units before the treatment ($time_t$ =0 and $treated_i$ = 1)**.\n\n$\\beta_0+\\beta_1+\\beta_2+\\beta_3$ is the **average $y_{i,t}$** for the **treated units after the treatment ($time_t$ =1 and $treated_i$ = 1)**.\n\n\n\n\n## Estimation   {.smaller background=\"#c6f7ec\"}\n\n+------------------+-----------------------------------+---------------------+---------------------+\n|                  |   Post-treat. (1)                 |  Pre-treat. (2)     |  **Diff. (1-2)**    |\n+------------------+-----------------------------------+---------------------+---------------------+\n|   Treated (a)    | $\\beta_0+\\beta_1+\\beta_2+\\beta_3$ | $\\beta_0+\\beta_2$   |**$\\beta_1+\\beta_3$**|\n+------------------+-----------------------------------+---------------------+---------------------+\n|  Control (b)     | $\\beta_0+\\beta_1$                 |  $\\beta_0$          | **$\\beta_1$**       |\n+------------------+-----------------------------------+---------------------+---------------------+\n| **Diff. (a-b)**  | **$\\beta_2+\\beta_3$**             |  **$\\beta_2$**      | **$\\beta_3$**       |\n+------------------+-----------------------------------+---------------------+---------------------+\n\n\n**This is why we call difference-in-differences.**\n\n**$\\beta_3$** gives us an estimate of the treatment effect on the treated units (ATE).\n\nThis is very popular because you can run as a regression.\n\n. . . \n\nMany papers simply show this table as final result.\n\nHowever, it is also possible that you include additional covariates (i.e., controls) in a DiD design. \n\nYou can also modify this to test the timing of the treatment (discussed later).\n\n\n\n\n\n\n\n\n\n\n# Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nIf you add controls, you have something in the form:\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + \\beta_4x_{1,i,t}+ \\beta_5x_{2,i,t}+ ...+ \\epsilon_{i,t}$$\n\n. . . \n\n::: {.callout-important}\nBad Controls problem: Never add a control that is also affected by the treatment. \n:::\n\n. . . \n\n::: {.callout-tip}\nUsing pre-treatment values is good practice. \n:::\n\nIf you are including a *good control*, you should get lower standard deviations of the estimated effects.\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nOne way of adding more controls is by adding FEs.\n\n$$y_{i,t} = \\beta_0 + \\beta_1 time_t + \\beta_2 treated_i  + \\beta_3 treated_i \\times time_t + FirmFE+ YearFE + \\epsilon_{i,t}$$\n\nThey help control for unobserved heterogeneity at the firm-level and in each year.\n\n. . . \n\n**But what do $\\beta_1$ and  $\\beta_2$ mean now?**\n\n. . .\n \n**Answer:** They are perfectly correlated with the $FirmFE$ and $YearFE$, respectively.\n\nReason: because they don't vary across each firm and year, respectively. \n\nThe software will most likely drop one $FirmFE$ and one $YearFE$, thus $\\beta_1$ and  $\\beta_2$ mean nothing.\n\n. . .\n\nI am guilty of this mistake because a referee asked and I couldn't reply properly.\n\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nYou will be better off if you estimate:\n\n$$y_{i,t} = \\beta_0 + \\beta_3 treated_i \\times time_t + FirmFE+ YearFE + \\epsilon_{i,t}$$\n\nThis is called a **generalized DiD**.\n\nThe $FirmFE$ allow that each firm has one intercept (i.e., one average $y_{i,t}$).\n\nThe $YearFE$ accommodate a potential shock in $y_{i,t}$ in each year.\n\n\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\nAdditionally, adding *good* controls can be helpful to maintain the shock **exogenous (i.e., random) after controlling by X.**\n\n. . . \n\nImagine that a financial shock is more likely to affect high leveraged firms than low-leverage ones.\n\n1) the shock will not change the leverage decision of each firm.\n\n2) we believe that high leveraged firms will have a different $y_{i,t}$ after the treatment.\n\nYou may add leverage as a control to make sure the shock is random given the firms' levels of leverage.\n\n. . .\n\nIf you may believe that the leverage will change after the treatment, you can use pre-treatment values (interacted with the time dummies).\n\nIn this case, you are controlling for the pre-treatment condition but are not including the bias that might come due to changes in leverage after the treatment.\n\n\n\n\n\n\n\n## Controls in DiD  {.smaller background=\"#d5f5ee\"}\n\n*If assignment is random, then including additional covariates should have a negligible effect on the estimated treatment effect.*\n\n*Thus, a large discrepancy between the treatment effect estimates with and without additional controls raises a red flag.* \n\n*If assignment to treatment and control groups is not random but dictated by an observable rule, then controlling for this rule via covariates in the regression satisfies the conditional mean zero assumption required for unbiased estimates.* \n\n*Regardless of the motivation, it is crucial to remember that any covariates included as controls must be unaffected by the treatment, a condition that eliminates other outcome variables and restricts most covariates to pre-treatment values.*\n\n([Roberts and Whited, 2014](https://doi.org/10.1016/B978-0-44-453594-8.00007-0))\n \n \n\n\n\n\n\n# Comment about DiD {.smaller background=\"#aecfc7\"}\n\n## Comment about DiD  {.smaller background=\"#aecfc7\"}\n\n([The effect](https://theeffectbook.net/ch-DifferenceinDifference.html))\n\n\n*Parallel trends means we have to think very carefully about how our dependent variable is measured and transformed.*\n\n*Because parallel trends is an assumption about the size of a gap remaining constant, which means something different depending on how you measure that gap.*\n\n*For example, if parallel trends holds for dependent variable $Y$, then it doesn‚Äôt hold for $ln(y)$, and vice versa*\n\n. . .\n\n*For example, say that in the pre-treatment period $y$ is 10 for the control group and 20 for the treated group. In the post-treatment period, in the counterfactual world where treatment never happened,$y$ would be 15 for the control group and 25 for the treated group. Gap of $20-10=10$  before, and $25-15=10$ after. Parallel trends holds!*\n\n. . . \n\n*However: $Ln(20)-ln(10)=.693$  before, and $ln(25)-ln(15)=.51$ after. *\n\n\n\n\n\n\n\n\n\n\n# Example of DiD  {.smaller background=\"#98b8b0\"}\n\n## Example of DiD  {.smaller background=\"#98b8b0\"}\n\n::: panel-tabset\n### R\n\n```{r}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output-location: default\n#| code-fold: true\n#| code-summary: \"R\"\n#| code-line-numbers: true\n#| eval: true\n# Load the necessary library\nlibrary(foreign)\ndata <- read.dta(\"files/kielmc.dta\")\ndata$y81_nearinc <- data$y81 * data$nearinc\nmodel1 <- lm(rprice ~ y81 + nearinc + y81_nearinc, data = data)\nmodel2 <- lm(rprice ~ y81 + nearinc + y81_nearinc + age + agesq, data = data)\nmodel3 <- lm(rprice ~ y81 + nearinc + y81_nearinc + age + agesq + intst + land + area + rooms + baths, data = data)\nsummary(model3)\n```\n\n\n### Stata\n\n```{stata}\n#| warning: false\n#| message: false\n#| fig-align: center\n#| echo: true\n#| output: true\n#| output-location: default\n#| code-fold: true\n#| code-line-numbers: true\n#| eval: true\n#| code-summary: \"Stata\"\nuse \"files/kielmc.dta\", clear\ngen y81_nearinc = y81 * nearinc\neststo:qui reg rprice y81 nearinc y81_nearinc \neststo:qui reg rprice y81 nearinc y81_nearinc age agesq \neststo:qui reg rprice y81 nearinc y81_nearinc age agesq intst land area rooms baths\nesttab , compress\n```  \n\n:::\n\n\n\n\n\n\n\n\n\n\n\n## üôã‚Äç‚ôÇÔ∏è **Any Questions?**{ .smaller  background=\"#fdf6e3\"}\n\n::: columns\n::: {.column width=\"50%\"}\n### Thank You!\n\n![](figs/qa2.png){width=\"110%\" style=\"box-shadow: none;\"}\n\n:::\n\n::: {.column width=\"50%\"}\n<div style=\"text-align:right;\">\n  <img src=\"figs/avatar.jpg\" width=\"120px\" style=\"border-radius:50%; box-shadow:0 4px 12px rgba(0,0,0,.25);\" />\n</div>\n\n### **Henrique C. Martins**\n\n- üåê [FGV/EAESP](https://eaesp.fgv.br/en/people/henrique-castro-martins)  \n- üíº [LinkedIn](https://www.linkedin.com/in/henriquecastror/)  \n- üß† [Google Scholar](https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&hl=pt-BR&oi=ao)  \n- üìÑ [Lattes CV](http://lattes.cnpq.br/6076997472159785)  \n- üè† [Personal Website](https://henriquemartins.net/)  \n:::\n:::\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":{"method":"mathjax","url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML-full"},"slide-level":2,"to":"revealjs","css":["logo.css"],"output-file":"part_7.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.4.549","auto-stretch":true,"html":{"css":"webex.css","include-after-body":"webex.js"},"editor":"visual","title":"Empirical Methods in Finance","subtitle":"Part 7","author":"Henrique C. Martins","title-slide-attributes":{"data-background-color":"#b1cafa"},"include-after":["<script type=\"text/javascript\">\n  Reveal.on('ready', event => {\n    if (event.indexh === 0) {\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n  });\n  Reveal.addEventListener('slidechanged', (event) => {\n    if (event.indexh === 0) {\n      Reveal.configure({ slideNumber: null });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = \"none\";\n    }\n    if (event.indexh === 1) {\n      Reveal.configure({ slideNumber: 'c' });\n      document.querySelector(\"div.has-logo > img.slide-logo\").style.display = null;\n    }\n  });\n</script>\n"],"slideNumber":true,"theme":"simple","chalkboard":true,"previewLinks":"auto","logo":"figs/background8.png","footer":"**[**Henrique C. Martins**] [[henrique.martins@fgv.br](mailto:henrique.martins@fgv.br)][Do not use without permission]**  ","multiplex":true,"scrollable":true}}},"projectFormats":["html"]}