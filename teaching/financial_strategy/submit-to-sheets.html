<script>
function collectAnswers() {
  const answers = {};

  // Respostas de caixas de texto
  document.querySelectorAll('input[type="text"]').forEach(input => {
    const name = input.name || input.id;
    if (name && name.startsWith('q')) {
      answers[name] = input.value.trim();
    }
  });

  // Respostas de múltipla escolha (radio)
  const radioNames = new Set();
  document.querySelectorAll('input[type="radio"]').forEach(input => {
    if (input.name && input.name.startsWith('q')) {
      radioNames.add(input.name);
    }
  });

  radioNames.forEach(name => {
    const selected = document.querySelector(`input[name="${name}"]:checked`);
    answers[name] = selected ? selected.value : "";
  });

  return answers;
}

async function submitAnswers() {
  const studentId = document.getElementById("student-id")?.value.trim();
  const password = document.getElementById("student-password")?.value.trim();

  if (!studentId || !password) {
    alert("⚠️ Please enter both your student ID and password.");
    return;
  }

  const answers = collectAnswers();

  const payload = {
    studentId,
    password,
    timestamp: new Date().toISOString(),
    answers
  };

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbxb3Z73DvsgGiGwK-jVp89jA5EGEYk24nbPNblQiNxFZPYvvDTvO-v4S4N_L-4YZ8KZfQ/exec", {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    });

    const result = await response.json();
    if (result.success) {
      alert("✅ Your answers were submitted successfully!");
    } else {
      alert("❌ Submission failed: " + (result.message || "Unknown error."));
    }
  } catch (error) {
    alert("❌ Submission error: " + error.message);
  }
}
</script>

<!-- Campos de Login -->
<div style="margin-bottom: 10px;">
  <label><strong>Student ID:</strong></label>
  <input type="text" id="student-id" placeholder="Enter your ID">
</div>

<div style="margin-bottom: 20px;">
  <label><strong>Password:</strong></label>
  <input type="password" id="student-password" placeholder="Enter your password">
</div>

<!-- Botão para Enviar -->
<button onclick="submitAnswers()"
  style="background-color:#28a745; color:white; padding:8px 16px; border:none; border-radius:5px; cursor:pointer;">
  Submit Answers
</button>
