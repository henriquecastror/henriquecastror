<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Henrique C. Martins">
  <title>Henrique Castro Martins - Empirical Methods in Finance</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="logo.css">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-771J5563G0"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-771J5563G0', { 'anonymize_ip': true});
  </script>
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Henrique Castro Martins - Empirical Methods in Finance">
<meta property="og:description" content="Part 7">
<meta property="og:site_name" content="Henrique Castro Martins">
<meta name="twitter:title" content="Henrique Castro Martins - Empirical Methods in Finance">
<meta name="twitter:description" content="Part 7">
<meta name="twitter:card" content="summary">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#b1cafa" class="quarto-title-block center">
  <h1 class="title">Empirical Methods in Finance</h1>
  <p class="subtitle">Part 7</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Henrique C. Martins 
</div>
</div>
</div>

</section>
<section>
<section id="did-introduction" class="title-slide slide level1 smaller center" data-background="#c4f5d7">
<h1>DiD Introduction</h1>

</section>
<section id="did-introduction-1" class="slide level2 smaller" data-background="#c4f5d7">
<h2>DiD Introduction</h2>
<p>Let’s introduce DiD using the most famous example in the topic: John Snow’s 1855 findings that demonstrated to the world that cholera was spread by fecally-contaminated water and not via the air (Snow 1855)</p>
<ul>
<li>Snow compared the periods of 1849 and 1854 to analyze the impact of a change in London’s water supply dynamics.</li>
<li>Various water companies, each drawing water from different sections of the Thames river, served the city’s water needs.</li>
<li>The downstream areas of the Thames, where some companies sourced their water, were susceptible to contamination due to the disposal of various substances, including fecal matter from cholera-infected individuals.</li>
<li>In the interim between 1849 and 1854, a pivotal policy was implemented: the Lambeth Company was mandated by an Act of Parliament to relocate its water intake upstream of London.</li>
</ul>
</section>
<section id="did-introduction-2" class="slide level2 smaller" data-background="#c4f5d7">
<h2>DiD Introduction</h2>
<p><strong>This is what happened.</strong></p>
<table style="width:100%;">
<colgroup>
<col style="width: 52%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Region Supplier</th>
<th>Death Rates 1849</th>
<th>Death Rates 1854</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Non-Lambeth Only (Dirty)</td>
<td>134.9</td>
<td>146.6</td>
</tr>
<tr class="even">
<td>Lambeth + Others (Mix Dirty and Clean)</td>
<td>130.1</td>
<td>84.9</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>The specific DID estimate we can get here is:</p>
<ul>
<li><span class="math inline">\((84.9-130.1)-(146.9-134.9)=-57.2\)</span>.</li>
</ul>
<p>This resembles a “modern” DiD.</p>
</div>
</section></section>
<section>
<section id="shocks" class="title-slide slide level1 smaller center" data-background="#95c9a9">
<h1>Shocks</h1>

</section>
<section id="shocks-1" class="slide level2 smaller" data-background="#95c9a9">
<h2>Shocks</h2>
<p><strong>Shock-based designs use an external shock to limit selection bias. </strong></p>
<p>They are very hard to find, but if you do, you can reasonably estimate causal effects.</p>
<p>They are sources of exogenous variations in the X, which are crucial to causality when we have some of the problems discussed before.</p>
<p>A shock is often considered the first-best solution to causal inference (randomized control trials are the second-best).</p>
<div class="fragment">
<p>In social sciences, we cannot have randomized control trials. It is not feasible to have experiments.</p>
<p>That is why we often explore the idea of “Natural experiments” or “Natural shocks” (I often use the terms interchangeably)</p>
</div>
</section>
<section id="shocks-2" class="slide level2 smaller" data-background="#95c9a9">
<h2>Shocks</h2>
<p>A <strong>Natural experiment</strong> is an exogenous variation that change a variable in a random subset of firms.</p>
<ul>
<li>Regulations, laws, etc.</li>
<li>Natural disasters.</li>
<li>Sudden death of CEOs or a product, etc.</li>
<li>The gender of a newborn.</li>
</ul>
<p>Because the variation that occur in x is truly exogenous, the CMI holds and thus we can infer causality.</p>
</section>
<section id="shocks-3" class="slide level2 smaller scrollable" data-background="#95c9a9">
<h2>Shocks</h2>
<p>A good shock has some conditions <a href="https://cfr.pub/published/papers/cfr-0036.pdf">source</a>:</p>
<ol type="1">
<li><strong>Shock Strength</strong>: The shock is strong enough to significantly change firm behavior or incentives.</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Exogenous Shock</strong>: The shock came from “outside” the system one is studying.</li>
</ol>
<ul>
<li>Treated firms did not choose whether to be treated,</li>
<li>cannot anticipate the shock,</li>
<li>the shock is expected to be permanent, and</li>
<li>there is no reason to believe that which firms were treated depends on unobserved firm characteristics.</li>
</ul>
<p>If the shock is exogenous, or appears to be, we are less worried that unobservables might be correlated with both assignment to treatment and the potential outcomes, and thus generate omitted variable bias.</p>
<p>Shock exogeneity should be defended, not just assumed.</p>
</div>
</section>
<section id="shocks-4" class="slide level2 smaller scrollable" data-background="#95c9a9">
<h2>Shocks</h2>
<p>A good shock has some conditions <a href="https://cfr.pub/published/papers/cfr-0036.pdf">source</a>:</p>
<ol start="3" type="1">
<li><strong>“As If Random” Assignment</strong>: The shock must separate firms into treated and controls in a manner which is close to random.</li>
</ol>
<div class="fragment">
<ol start="4" type="1">
<li><strong>Covariate balance:</strong> The forcing and forced variables aside, the shock should produce reasonable covariate balance between treated and control firms, including “common support” (reasonable overlap between treated and control firms on all covariates).</li>
</ol>
<p>Somewhat imperfect balance can be address with balancing methods, but severe imbalance undermines shock credibility, even if the reason for imbalance is not obvious. Covariate balance should be reported.</p>
</div>
</section>
<section id="shocks-5" class="slide level2 smaller scrollable" data-background="#95c9a9">
<h2>Shocks</h2>
<p>A good shock has some conditions <a href="https://cfr.pub/published/papers/cfr-0036.pdf">source</a>:</p>
<ol start="5" type="1">
<li><strong>Only-Through Condition(s):</strong> We must have reason to believe that the apparent effect of the shock on the outcome came only through the shock (sometimes, through a specific channel).</li>
</ol>
<p>The shock must be “isolated”, there must be no other shock, at around the same time, that could also affect treated firms differently than control firms. And if one expects the shock to affect outcomes through a particular channel, the shock must also affect the outcome only through that channel.</p>
<div class="fragment">
<p>In IV analysis, this is called an <strong>“exclusion restriction”</strong> or <strong>“only-through condition”</strong>, because one assumes away (excludes) other channels.</p>
</div>
</section>
<section id="shocks-6" class="slide level2 smaller" data-background="#95c9a9">
<h2>Shocks</h2>
<p>The idea of a natural shock is often mixed with the difference-in-differences (DiD) design.</p>
<p>It is more common that it should that people refer to shocks when they want to refer to DiD.</p>
<p>A Did design explores a Natural shock to estimate causal effects.</p>
<p><strong>A good shock generates, by nature, random assignment</strong>.</p>
</section>
<section id="remember" class="slide level2 smaller" data-background="#693d3a">
<h2>Remember</h2>
<p><strong>Remember:</strong></p>
<p>When dealing with <strong>causal inference</strong>, we have to find ways to approximate what the hidden potential outcome of the treated units is.</p>
<p>That is, the challenge in identifying causal effects is that the untreated potential outcomes, <span class="math inline">\(Y_{i,0}\)</span>, are never observed for the treated group (<span class="math inline">\(D_i= 1\)</span>). The “second” term in the following equation:</p>
<p>ATET = <span class="math inline">\(\frac{1}{N} (E[Y_{i,1}|D_i=1] - E[Y_{i,0}|D_i=1])\)</span></p>
<p>We need an empirical design to <strong>“observe”</strong> what we do not really observe (i.e., the counterfactual).</p>
</section></section>
<section>
<section id="single-differences" class="title-slide slide level1 smaller center" data-background="#a4baac">
<h1>Single differences</h1>

</section>
<section id="single-differences-1" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p>There are two single differences we can use to estimate the causal effect of a treatments (i.e., a shock).</p>
<p><strong>1) Single Cross-Sectional Differences After Treatment</strong></p>
<p><strong>2) Single Time-Series Difference Before and After Treatment</strong></p>
</section>
<section id="single-differences-2" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p><strong>1) Single Cross-Sectional Differences After Treatment</strong></p>
<p>One approach to estimating a parameter that summarizes the treatment effect is to compare the post-treatment outcomes of the treatment and control groups.</p>
<p>This method is often used when there is no data available on pre-treatment outcomes.</p>
<p>It takes the form:</p>
<p><span class="math display">\[y=\beta_0+\beta_1d_i+\epsilon\]</span></p>
<p>where <span class="math inline">\(d_i\)</span> is a dummy marking the units that are treated. The treatment effect is given by <span class="math inline">\(\beta_1\)</span></p>
<p>This is a cross-sectional comparison, using only post-treatment values.</p>
</section>
<section id="single-differences-3" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p><strong>1) Single Cross-Sectional Differences After Treatment</strong></p>
<p>You may add the interaction between the treatment dummy and the years.</p>
<p><span class="math display">\[y=\beta_0+\beta_1d_i\times year_1+\beta_2d_i\times year_2 +\beta_3d_i\times year_3+ . . . +\epsilon\]</span></p>
<p>This design allows the treatment effect to vary over time by interacting the treatment dummy with period dummies.</p>
<div class="fragment">
<p><strong>What is the endogeneity concern here?</strong></p>
</div>
<div class="fragment">
<p>The endogeneity concern is that these firms’ <span class="math inline">\(y\)</span> were different and could become more different between the treated and control groups even if the shock had not happened.</p>
<p>That is, there is something in the residual that explains the differences in <span class="math inline">\(y\)</span> that is correlated with the <span class="math inline">\(d\)</span>.</p>
</div>
</section>
<section id="single-differences-4" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p><strong>2) Single Time-Series Difference Before and After Treatment</strong></p>
<p>A second way to estimate the treatment effect is to compare the outcome after the treatment with the outcome before the treatment for <strong>just those units that are treated.</strong></p>
<p>The difference from before is that you have data before the treatment, but you only have data for the treated units.</p>
<p><span class="math display">\[y=\beta_0+\beta_1 time+\epsilon\]</span></p>
<p>where <span class="math inline">\(time\)</span> marks the years after the treatment. The treatment effect is given by <span class="math inline">\(\beta_1\)</span></p>
</section>
<section id="single-differences-5" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p><strong>2) Single Time-Series Difference Before and After Treatment</strong></p>
<p>You can also estimate a multi-year regression.</p>
<p><span class="math display">\[y=\beta_0+\beta_1year_1 +\beta_2\times year_2 +\beta_3\times year_3+ . . . +\epsilon\]</span></p>
<div class="fragment">
<p><strong>What is the endogeneity concern here?</strong></p>
</div>
<div class="fragment">
<p>The endogeneity concern is that these firms’ <span class="math inline">\(y\)</span> could have changed over the period of observation even if the shock had not happened.</p>
<p>That is, there is something in the error term that explains <span class="math inline">\(y\)</span> that is correlated with the <span class="math inline">\(year\)</span> dummies.</p>
</div>
</section>
<section id="single-differences-6" class="slide level2 smaller" data-background="#a4baac">
<h2>Single differences</h2>
<p>The combination of the <strong>1) Single Cross-Sectional Differences After Treatment</strong> and <strong>2) Single Time-Series Difference Before and After Treatment</strong> is called <strong>Difference-in-Differences</strong>.</p>
</section></section>
<section>
<section id="difference-in-differences" class="title-slide slide level1 smaller center" data-background="#8bc9a2">
<h1>Difference-in-Differences</h1>

</section>
<section id="difference-in-differences-1" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p>This is one of the most popular methods in social sciences for estimating causal effects in non-experimental settings.</p>
<p>The literature is exploding over the recent years.</p>
<div class="fragment">
<p>There is one group that is treated, another is the control.</p>
<p>There are two periods of time, before and after the treatment.</p>
<p>And the treated group receives the treatment in the second period.</p>
<p><strong>The key identifying assumption is that the average outcome among the treated and comparison populations would have followed “parallel trends” in the absence of treatment.</strong></p>
</div>
</section>
<section id="difference-in-differences-2" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p><em>The two single difference estimators complement one another.</em></p>
<p><em>The cross-sectional comparison avoids the problem of omitted trends by comparing two groups over the same time period.</em></p>
<p><em>The time series comparison avoids the problem of unobserved differences between two different groups of firms by looking at the same firms before and after the change.</em></p>
<p><em>The double difference, difference-in-differences (DD), estimator combines these two estimators to take advantage of both estimators’ strengths.</em></p>
<p>(<a href="https://doi.org/10.1016/B978-0-44-453594-8.00007-0">Roberts and Whited, 2014</a>)</p>
</section>
<section id="difference-in-differences-3" class="slide level2 smaller scrollable" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p>Difference-in-differences methods overcome the identification challenge via assumptions that allow us to impute the mean counterfactual untreated outcomes for the treated group by using</p>
<ul>
<li><ol type="a">
<li>the change in outcomes for the untreated group and</li>
</ol></li>
<li><ol start="2" type="a">
<li>the baseline outcomes for the treated group.</li>
</ol></li>
</ul>
<p>The key assumption for identifying the causal effect is the <strong>parallel trends assumption</strong>, which intuitively states that <strong>the average outcome for the treated and untreated units would have evolved in parallel if treatment had not occurred</strong>.</p>
<p><strong>Assumption 1 (Parallel Trends).</strong></p>
<p><span class="math inline">\(E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=1] = E[Y_{i,1,t=2}-Y_{i,0,t=1}|D_i=0]\)</span></p>
<p>In other words: <strong>this condition means that in the absence of treatment, the average change in the <span class="math inline">\(y\)</span> would have been the same for both the treatment and control groups.</strong></p>
</section>
<section id="difference-in-differences-4" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p><strong>The counterfactual is determined by the assumption of a parallel trend between the treated and control groups.</strong> <strong><a href="https://www.masteringmetrics.com/">MM</a></strong></p>

<img data-src="figs/did1.png" class="r-stretch"></section>
<section id="difference-in-differences-5" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>

<img data-src="figs/slides4-did.png" class="r-stretch"></section>
<section id="difference-in-differences-6" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p>Inserting more periods.</p>

<img data-src="figs/did2.png" class="r-stretch"></section>
<section id="difference-in-differences-7" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p>A more realistic example. (<a href="https://theeffectbook.net/ch-DifferenceinDifference.html">The effect</a>)</p>

<img data-src="figs/theeffect1.png" class="r-stretch"></section>
<section id="difference-in-differences-8" class="slide level2 smaller" data-background="#8bc9a2">
<h2>Difference-in-Differences</h2>
<p><strong>Assumption 2 (No anticipatory effects).</strong></p>
<p><em>The treatment has no causal effect prior to its implementation.</em></p>
<p><span class="math display">\[Y_{i,0,t=1}=Y_{i,1,t=1}\]</span></p>
<p>Prior to the treatment (t=1), there is no effect of the treatment.</p>
</section></section>
<section>
<section id="estimation" class="title-slide slide level1 smaller center" data-background="#c6f7ec">
<h1>Estimation</h1>

</section>
<section id="estimation-1" class="slide level2 smaller" data-background="#c6f7ec">
<h2>Estimation</h2>
<p>Let’s see how to implement a DiD model. The canonical DiD model is the followin:</p>
<p><span class="math display">\[y_{i,t} = \beta_0 + \beta_1 time_t + \beta_2 treated_i  + \beta_3 treated_i \times time_t + \epsilon_{i,t}\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(treated_i\)</span> is a dummy marking the units that received the treatment.</p>
<p><span class="math inline">\(time_t\)</span> is a dummy marking the year of the treatment and the years after.</p>
</section>
<section id="estimation-2" class="slide level2 smaller" data-background="#c6f7ec">
<h2>Estimation</h2>
<p>Let’s see how to implement a DiD model. The canonical DiD model is the followin:</p>
<p><span class="math display">\[y_{i,t} = \beta_0 + \beta_1 time_t + \beta_2 treated_i  + \beta_3 treated_i \times time_t + \epsilon_{i,t}\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> is the <strong>average <span class="math inline">\(y_{i,t}\)</span></strong> for the <strong>control units before the treatment (<span class="math inline">\(time_t\)</span> =0 and <span class="math inline">\(treated_i\)</span> = 0)</strong>.</p>
<p><span class="math inline">\(\beta_0+\beta_1\)</span> is the <strong>average <span class="math inline">\(y_{i,t}\)</span></strong> for the <strong>control units after the treatment (<span class="math inline">\(time_t\)</span> =1 and <span class="math inline">\(treated_i\)</span> = 0)</strong>.</p>
<p><span class="math inline">\(\beta_0+\beta_2\)</span> is the <strong>average <span class="math inline">\(y_{i,t}\)</span></strong> for the <strong>treated units before the treatment (<span class="math inline">\(time_t\)</span> =0 and <span class="math inline">\(treated_i\)</span> = 1)</strong>.</p>
<p><span class="math inline">\(\beta_0+\beta_1+\beta_2+\beta_3\)</span> is the <strong>average <span class="math inline">\(y_{i,t}\)</span></strong> for the <strong>treated units after the treatment (<span class="math inline">\(time_t\)</span> =1 and <span class="math inline">\(treated_i\)</span> = 1)</strong>.</p>
</section>
<section id="estimation-3" class="slide level2 smaller" data-background="#c6f7ec">
<h2>Estimation</h2>
<table style="width:98%;">
<colgroup>
<col style="width: 18%">
<col style="width: 35%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Post-treat. (1)</td>
<td>Pre-treat. (2)</td>
<td><strong>Diff. (1-2)</strong></td>
</tr>
<tr class="even">
<td>Treated (a)</td>
<td><span class="math inline">\(\beta_0+\beta_1+\beta_2+\beta_3\)</span></td>
<td><span class="math inline">\(\beta_0+\beta_2\)</span></td>
<td><strong><span class="math inline">\(\beta_1+\beta_3\)</span></strong></td>
</tr>
<tr class="odd">
<td>Control (b)</td>
<td><span class="math inline">\(\beta_0+\beta_1\)</span></td>
<td><span class="math inline">\(\beta_0\)</span></td>
<td><strong><span class="math inline">\(\beta_1\)</span></strong></td>
</tr>
<tr class="even">
<td><strong>Diff. (a-b)</strong></td>
<td><strong><span class="math inline">\(\beta_2+\beta_3\)</span></strong></td>
<td><strong><span class="math inline">\(\beta_2\)</span></strong></td>
<td><strong><span class="math inline">\(\beta_3\)</span></strong></td>
</tr>
</tbody>
</table>
<p><strong>This is why we call difference-in-differences.</strong></p>
<p><strong><span class="math inline">\(\beta_3\)</span></strong> gives us an estimate of the treatment effect on the treated units (ATE).</p>
<p>This is very popular because you can run as a regression.</p>
<div class="fragment">
<p>Many papers simply show this table as final result.</p>
<p>However, it is also possible that you include additional covariates (i.e., controls) in a DiD design.</p>
<p>You can also modify this to test the timing of the treatment (discussed later).</p>
</div>
</section></section>
<section>
<section id="controls-in-did" class="title-slide slide level1 smaller center" data-background="#d5f5ee">
<h1>Controls in DiD</h1>

</section>
<section id="controls-in-did-1" class="slide level2 smaller" data-background="#d5f5ee">
<h2>Controls in DiD</h2>
<p>If you add controls, you have something in the form:</p>
<p><span class="math display">\[y_{i,t} = \beta_0 + \beta_1 time_t + \beta_2 treated_i  + \beta_3 treated_i \times time_t + \beta_4x_{1,i,t}+ \beta_5x_{2,i,t}+ ...+ \epsilon_{i,t}\]</span></p>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Bad Controls problem: Never add a control that is also affected by the treatment.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Using pre-treatment values is good practice.</p>
</div>
</div>
</div>
<p>If you are including a <em>good control</em>, you should get lower standard deviations of the estimated effects.</p>
</div>
</section>
<section id="controls-in-did-2" class="slide level2 smaller" data-background="#d5f5ee">
<h2>Controls in DiD</h2>
<p>One way of adding more controls is by adding FEs.</p>
<p><span class="math display">\[y_{i,t} = \beta_0 + \beta_1 time_t + \beta_2 treated_i  + \beta_3 treated_i \times time_t + FirmFE+ YearFE + \epsilon_{i,t}\]</span></p>
<p>They help control for unobserved heterogeneity at the firm-level and in each year.</p>
<div class="fragment">
<p><strong>But what do <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> mean now?</strong></p>
</div>
<div class="fragment">
<p><strong>Answer:</strong> They are perfectly correlated with the <span class="math inline">\(FirmFE\)</span> and <span class="math inline">\(YearFE\)</span>, respectively.</p>
<p>Reason: because they don’t vary across each firm and year, respectively.</p>
<p>The software will most likely drop one <span class="math inline">\(FirmFE\)</span> and one <span class="math inline">\(YearFE\)</span>, thus <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> mean nothing.</p>
</div>
<div class="fragment">
<p>I am guilty of this mistake because a referee asked and I couldn’t reply properly.</p>
</div>
</section>
<section id="controls-in-did-3" class="slide level2 smaller" data-background="#d5f5ee">
<h2>Controls in DiD</h2>
<p>You will be better off if you estimate:</p>
<p><span class="math display">\[y_{i,t} = \beta_0 + \beta_3 treated_i \times time_t + FirmFE+ YearFE + \epsilon_{i,t}\]</span></p>
<p>This is called a <strong>generalized DiD</strong>.</p>
<p>The <span class="math inline">\(FirmFE\)</span> allow that each firm has one intercept (i.e., one average <span class="math inline">\(y_{i,t}\)</span>).</p>
<p>The <span class="math inline">\(YearFE\)</span> accommodate a potential shock in <span class="math inline">\(y_{i,t}\)</span> in each year.</p>
</section>
<section id="controls-in-did-4" class="slide level2 smaller scrollable" data-background="#d5f5ee">
<h2>Controls in DiD</h2>
<p>Additionally, adding <em>good</em> controls can be helpful to maintain the shock <strong>exogenous (i.e., random) after controlling by X.</strong></p>
<div class="fragment">
<p>Imagine that a financial shock is more likely to affect high leveraged firms than low-leverage ones.</p>
<ol type="1">
<li><p>the shock will not change the leverage decision of each firm.</p></li>
<li><p>we believe that high leveraged firms will have a different <span class="math inline">\(y_{i,t}\)</span> after the treatment.</p></li>
</ol>
<p>You may add leverage as a control to make sure the shock is random given the firms’ levels of leverage.</p>
</div>
<div class="fragment">
<p>If you may believe that the leverage will change after the treatment, you can use pre-treatment values (interacted with the time dummies).</p>
<p>In this case, you are controlling for the pre-treatment condition but are not including the bias that might come due to changes in leverage after the treatment.</p>
</div>
</section>
<section id="controls-in-did-5" class="slide level2 smaller" data-background="#d5f5ee">
<h2>Controls in DiD</h2>
<p><em>If assignment is random, then including additional covariates should have a negligible effect on the estimated treatment effect.</em></p>
<p><em>Thus, a large discrepancy between the treatment effect estimates with and without additional controls raises a red flag.</em></p>
<p><em>If assignment to treatment and control groups is not random but dictated by an observable rule, then controlling for this rule via covariates in the regression satisfies the conditional mean zero assumption required for unbiased estimates.</em></p>
<p><em>Regardless of the motivation, it is crucial to remember that any covariates included as controls must be unaffected by the treatment, a condition that eliminates other outcome variables and restricts most covariates to pre-treatment values.</em></p>
<p>(<a href="https://doi.org/10.1016/B978-0-44-453594-8.00007-0">Roberts and Whited, 2014</a>)</p>
</section></section>
<section>
<section id="comment-about-did" class="title-slide slide level1 smaller center" data-background="#aecfc7">
<h1>Comment about DiD</h1>

</section>
<section id="comment-about-did-1" class="slide level2 smaller" data-background="#aecfc7">
<h2>Comment about DiD</h2>
<p>(<a href="https://theeffectbook.net/ch-DifferenceinDifference.html">The effect</a>)</p>
<p><em>Parallel trends means we have to think very carefully about how our dependent variable is measured and transformed.</em></p>
<p><em>Because parallel trends is an assumption about the size of a gap remaining constant, which means something different depending on how you measure that gap.</em></p>
<p><em>For example, if parallel trends holds for dependent variable <span class="math inline">\(Y\)</span>, then it doesn’t hold for <span class="math inline">\(ln(y)\)</span>, and vice versa</em></p>
<div class="fragment">
<p><em>For example, say that in the pre-treatment period <span class="math inline">\(y\)</span> is 10 for the control group and 20 for the treated group. In the post-treatment period, in the counterfactual world where treatment never happened,<span class="math inline">\(y\)</span> would be 15 for the control group and 25 for the treated group. Gap of <span class="math inline">\(20-10=10\)</span> before, and <span class="math inline">\(25-15=10\)</span> after. Parallel trends holds!</em></p>
</div>
<div class="fragment">
<p><em>However: <span class="math inline">\(Ln(20)-ln(10)=.693\)</span> before, and <span class="math inline">\(ln(25)-ln(15)=.51\)</span> after. </em></p>
</div>
</section></section>
<section>
<section id="example-of-did" class="title-slide slide level1 smaller center" data-background="#98b8b0">
<h1>Example of DiD</h1>

</section>
<section id="example-of-did-1" class="slide level2 smaller" data-background="#98b8b0">
<h2>Example of DiD</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">R</a></li><li><a href="#tabset-1-2">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co"># Load the necessary library</span></span>
<span id="cb1-2"><a></a><span class="fu">library</span>(foreign)</span>
<span id="cb1-3"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/kielmc.dta"</span>)</span>
<span id="cb1-4"><a></a>data<span class="sc">$</span>y81_nearinc <span class="ot">&lt;-</span> data<span class="sc">$</span>y81 <span class="sc">*</span> data<span class="sc">$</span>nearinc</span>
<span id="cb1-5"><a></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(rprice <span class="sc">~</span> y81 <span class="sc">+</span> nearinc <span class="sc">+</span> y81_nearinc, <span class="at">data =</span> data)</span>
<span id="cb1-6"><a></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(rprice <span class="sc">~</span> y81 <span class="sc">+</span> nearinc <span class="sc">+</span> y81_nearinc <span class="sc">+</span> age <span class="sc">+</span> agesq, <span class="at">data =</span> data)</span>
<span id="cb1-7"><a></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(rprice <span class="sc">~</span> y81 <span class="sc">+</span> nearinc <span class="sc">+</span> y81_nearinc <span class="sc">+</span> age <span class="sc">+</span> agesq <span class="sc">+</span> intst <span class="sc">+</span> land <span class="sc">+</span> area <span class="sc">+</span> rooms <span class="sc">+</span> baths, <span class="at">data =</span> data)</span>
<span id="cb1-8"><a></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rprice ~ y81 + nearinc + y81_nearinc + age + agesq + 
    intst + land + area + rooms + baths, data = data)

Residuals:
   Min     1Q Median     3Q    Max 
-76721  -8885   -252   8433 136649 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.381e+04  1.117e+04   1.237  0.21720    
y81          1.393e+04  2.799e+03   4.977 1.07e-06 ***
nearinc      3.780e+03  4.453e+03   0.849  0.39661    
y81_nearinc -1.418e+04  4.987e+03  -2.843  0.00477 ** 
age         -7.395e+02  1.311e+02  -5.639 3.85e-08 ***
agesq        3.453e+00  8.128e-01   4.248 2.86e-05 ***
intst       -5.386e-01  1.963e-01  -2.743  0.00643 ** 
land         1.414e-01  3.108e-02   4.551 7.69e-06 ***
area         1.809e+01  2.306e+00   7.843 7.16e-14 ***
rooms        3.304e+03  1.661e+03   1.989  0.04758 *  
baths        6.977e+03  2.581e+03   2.703  0.00725 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19620 on 310 degrees of freedom
Multiple R-squared:   0.66, Adjusted R-squared:  0.6491 
F-statistic: 60.19 on 10 and 310 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a></a><span class="kw">use</span> <span class="st">"files/kielmc.dta"</span>, <span class="kw">clear</span></span>
<span id="cb3-2"><a></a><span class="kw">gen</span> y81_nearinc = y81 * nearinc</span>
<span id="cb3-3"><a></a>eststo:<span class="kw">qui</span> <span class="kw">reg</span> rprice y81 nearinc y81_nearinc </span>
<span id="cb3-4"><a></a>eststo:<span class="kw">qui</span> <span class="kw">reg</span> rprice y81 nearinc y81_nearinc age agesq </span>
<span id="cb3-5"><a></a>eststo:<span class="kw">qui</span> <span class="kw">reg</span> rprice y81 nearinc y81_nearinc age agesq intst land area rooms baths</span>
<span id="cb3-6"><a></a>esttab , <span class="kw">compress</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(est1 stored)

(est2 stored)

(est3 stored)


-------------------------------------------------
                 (1)          (2)          (3)   
              rprice       rprice       rprice   
-------------------------------------------------
y81          18790.3***   21321.0***   13928.5***
              (4.64)       (6.19)       (4.98)   

nearinc     -18824.4***    9397.9       3780.3   
             (-3.86)       (1.95)       (0.85)   

y81_near~c  -11863.9     -21920.3***  -14177.9** 
             (-1.59)      (-3.45)      (-2.84)   

age                       -1494.4***    -739.5***
                         (-11.33)      (-5.64)   

agesq                       8.691***     3.453***
                          (10.25)       (4.25)   

intst                                   -0.539** 
                                       (-2.74)   

land                                     0.141***
                                        (4.55)   

area                                     18.09***
                                        (7.84)   

rooms                                   3304.2*  
                                        (1.99)   

baths                                   6977.3** 
                                        (2.70)   

_cons        82517.2***   89116.5***   13807.7   
             (30.26)      (37.04)       (1.24)   
-------------------------------------------------
N                321          321          321   
-------------------------------------------------
t statistics in parentheses
* p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="any-questions" class="slide level2 smaller" data-background="#fdf6e3">
<h2>🙋‍♂️ <strong>Any Questions?</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="thank-you">Thank You!</h3>
<p><img data-src="figs/qa2.png" style="box-shadow: none;;width:110.0%"></p>
</div><div class="column" style="width:50%;">
<div style="text-align:right;">
<p><img src="figs/avatar.jpg" width="120px" style="border-radius:50%; box-shadow:0 4px 12px rgba(0,0,0,.25);"></p>
</div>
<h3 id="henrique-c.-martins"><strong>Henrique C. Martins</strong></h3>
<ul>
<li>🌐 <a href="https://eaesp.fgv.br/en/people/henrique-castro-martins">FGV/EAESP</a><br>
</li>
<li>💼 <a href="https://www.linkedin.com/in/henriquecastror/">LinkedIn</a><br>
</li>
<li>🧠 <a href="https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&amp;hl=pt-BR&amp;oi=ao">Google Scholar</a><br>
</li>
<li>📄 <a href="http://lattes.cnpq.br/6076997472159785">Lattes CV</a><br>
</li>
<li>🏠 <a href="https://henriquemartins.net/">Personal Website</a><br>
</li>
</ul>
</div>
</div>

<div class="quarto-auto-generated-content">
<p><img src="figs/background8.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><strong><a href="#/any-questions"><strong>Henrique C. Martins</strong></a> [<a href="mailto:henrique.martins@fgv.br">henrique.martins@fgv.br</a>][Do not use without permission]</strong></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17272179345218902982","id":"14737b1fb0930760","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script type="text/javascript">
      Reveal.on('ready', event => {
        if (event.indexh === 0) {
          document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        }
      });
      Reveal.addEventListener('slidechanged', (event) => {
        if (event.indexh === 0) {
          Reveal.configure({ slideNumber: null });
          document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        }
        if (event.indexh === 1) {
          Reveal.configure({ slideNumber: 'c' });
          document.querySelector("div.has-logo > img.slide-logo").style.display = null;
        }
      });
    </script>
    

</body></html>