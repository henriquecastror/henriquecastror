<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Henrique C. Martins">
  <title>Henrique Castro Martins - Empirical Methods in Finance</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="logo.css">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-771J5563G0"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-771J5563G0', { 'anonymize_ip': true});
  </script>
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta name="twitter:title" content="Henrique Castro Martins - Empirical Methods in Finance">
<meta name="twitter:description" content="Part 4">
<meta name="twitter:card" content="summary">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#b1cafa" class="quarto-title-block center">
  <h1 class="title">Empirical Methods in Finance</h1>
  <p class="subtitle">Part 4</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Henrique C. Martins 
</div>
</div>
</div>

</section>
<section>
<section id="more-about-regressions" class="title-slide slide level1 smaller center" data-background="#454343">
<h1>More about Regressions</h1>

</section>
<section id="regression" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p>Linear regressions are the workhorse tool in econometrics</p>
<ul>
<li><strong>Simplicity</strong>: straightforward to understand, implement, and visualize.</li>
</ul>
<div class="fragment">
<ul>
<li><strong>Interpretability</strong>: coefficients have clear interpretations.
<ul>
<li>represents the change in the Y for a one-unit change in the X, holding all other variables constant.</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Versatility</strong>: simple linear regression or <em>multiple linear regression</em>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Assumptions</strong>: linearity, independence of errors, homoscedasticity, and normality of errors.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Baseline Model</strong>: You can compare the performance of more advanced models to linear regression.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Estimation</strong>: provides clear estimates of the coefficients‚Äô confidence intervals and hypothesis testing.</li>
</ul>
</div>
</section>
<section id="regression-1" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p>In this setting, the variables <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> can have several names.</p>
<table>
<thead>
<tr class="header">
<th>Y</th>
<th>X</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dependent variable</td>
<td>Independent variable</td>
</tr>
<tr class="even">
<td>Explained variable</td>
<td>Explanatory variable</td>
</tr>
<tr class="odd">
<td>Response variable</td>
<td>Control variable</td>
</tr>
<tr class="even">
<td>Predicted variable</td>
<td>Predictor variable</td>
</tr>
<tr class="odd">
<td>Regressand</td>
<td>Regressor</td>
</tr>
</tbody>
</table>
</section>
<section id="regression-2" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p>Broadly, we are interested in how y is explained by x?</p>
<ul>
<li><span class="math inline">\(y_i = \alpha + \beta_1 x_i + \epsilon\)</span></li>
</ul>
<div class="fragment">
<p>Perhaps <span class="math inline">\(\epsilon\)</span> is the most important part of a regression.</p>
<p>The interpretation is ‚Äú<em>everything that is not explained by X and that explains Y</em>‚Äù.</p>
</div>
<div class="fragment">
<p>A comment</p>
<ul>
<li><p>Usually, the literature uses <span class="math inline">\(\epsilon\)</span> for the ‚Äúestimated‚Äù residual.</p></li>
<li><p>And <span class="math inline">\(\mu\)</span> for the ‚Äútrue‚Äù residual, which necessarily implies that the assumptions hold.</p></li>
<li><p>At the end od the day, you don‚Äôt need to worry to much with the notation of this term because we are always in the ‚Äúestimated world‚Äù, and almost never in the ‚Äútrue world‚Äù.</p></li>
<li><p>The ‚Äútrue world‚Äù implies that you are studying the population or that you have a true random sample of the population</p>
<ul>
<li><span class="math inline">\(y_i = \alpha + \beta_1 x_i + \mu\)</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="regression-3" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p><strong>Remember</strong></p>
<ul>
<li><span class="math inline">\(y, x\)</span>, and <span class="math inline">\(\mu\)</span> are random variables</li>
<li><span class="math inline">\(y and x\)</span> are observable</li>
<li><span class="math inline">\(\mu\)</span> and <span class="math inline">\(\beta\)</span> are unobservable</li>
<li><span class="math inline">\(\mu\)</span> captures everything that determines y after accounting for x</li>
</ul>
<p>Our goal is to estimate Œ≤</p>
</section>
<section id="regression-4" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p>There are some assumptions/requirements about <span class="math inline">\(\mu\)</span> in a OLS</p>
<p><strong>First assumption</strong></p>
<ul>
<li><p>E(<span class="math inline">\(\mu\)</span>) = 0</p>
<ul>
<li>This is a simple assumption, not strong at all.</li>
<li>It simply assumes that the average of <span class="math inline">\(\mu\)</span> is zero in the population.</li>
<li>Basically, any non-zero mean is absorbed by the intercept
<ul>
<li>Say that E(<span class="math inline">\(\mu\)</span>) = k</li>
<li>We could rewrite <span class="math inline">\(\mu = k + w\)</span>, where E(w)=0</li>
<li>Then, model becomes <span class="math inline">\(y=(\alpha +ùëò) + \betaùë•+ùë§\)</span></li>
<li>Intercept is now just (Œ± + k), and error, w, is mean zero</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="regression-5" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p><strong>Second assumption</strong></p>
<ul>
<li>E(<span class="math inline">\(\mu\)</span>|x) = E(<span class="math inline">\(\mu\)</span>) for all values of x
<ul>
<li>It says that the average value of <span class="math inline">\(\mu\)</span> does not depend on the value of x (i.e., the slice of the population you are looking at).</li>
<li>We say that <span class="math inline">\(\mu\)</span> is mean-independent of x.</li>
<li>This is true if the X and the <span class="math inline">\(\mu\)</span> are independent to each other.</li>
<li>Implies that x and <span class="math inline">\(\mu\)</span> are <em>uncorrelated</em>.</li>
<li><strong>Conditional Mean Independence (CMI)</strong>.</li>
<li>This is one of the keys assumption to <em>causal inference</em>.</li>
</ul></li>
</ul>
</section>
<section id="regression-6" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p><strong>Second assumption</strong></p>
<p><strong>Example</strong></p>
<p>Let‚Äôs say the model is:</p>
<p><span class="math display">\[wage = \alpha + \beta Schooling_{years} + \epsilon\]</span></p>
<ul>
<li>where <span class="math inline">\(\epsilon\)</span> represents <em>unobserved ability</em>.</li>
</ul>
<p>Does CMI hold?</p>
<p>That is E(ability|x=8)=E(ability|x=10)=E(ability|x=12)?</p>
<div class="fragment">
<p><strong>Probably not</strong>, because the unobserved ability should depend on the years of schooling.</p>
<p>The solution (not trivial) would be to include ability as a new X.</p>
</div>
</section>
<section id="regression-7" class="slide level2 smaller scrollable" data-background="#454343">
<h2>Regression</h2>
<p><strong>Another example</strong></p>
<p>Consider the following model (with only one X)</p>
<p><span class="math display">\[Leverage_i = \alpha + \beta_1 Profitability_i + \mu_i\]</span></p>
<ul>
<li><p>CMI says that, to every firm <em>i</em>, <span class="math inline">\(\mu\)</span> is the same, even when firms have different profitability.</p></li>
<li><p>Can you think on examples when this assumption may not hold in this model?</p></li>
</ul>
<div class="fragment">
<ol type="1">
<li><p>unprofitable firms have higher bankruptcy risk, which should make them to have lower leverage (tradeoff theory).</p></li>
<li><p>unprofitable firms have low cash, which should make them to have more leverage (pecking order theory).</p></li>
</ol>
</div>
</section>
<section id="regression-8" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p><strong>The discussion of whether the CMI holds is the origin of the ‚Äúendogeneity‚Äù problem.</strong></p>
<p>You will face reviewers arguing reasons of why the CMI might not hold in your case.</p>
<ul>
<li><p>Many will criticize a model by saying it has an ‚Äúendogeneity problem‚Äù, whithout explaining more.</p>
<ul>
<li>This is very generic. <strong>Don‚Äôt do that!</strong></li>
</ul></li>
</ul>
<div class="fragment">
<p>They should explain what is the source of the problem that is making the model violate CMI.</p>
<ul>
<li>OVB, selection bias, reverse causality, simultaneity, etc?</li>
</ul>
</div>
<div class="fragment">
<p>Generally speaking, endogeneity refers to a violation of CMI, meaning that <span class="math inline">\(x\)</span> and <span class="math inline">\(\mu\)</span> are correlated.</p>
<p>This is always a plausible possibility, since <span class="math inline">\(\mu\)</span> carries a lot of stuff (something must be correlated with X).</p>
</div>
</section>
<section id="regression-9" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p><strong>Third assumption</strong></p>
<p>Combining 1 and 2 leads to</p>
<ul>
<li>E(<span class="math inline">\(\mu\)</span>|x) = 0
<ul>
<li>This is a very important assumption called <strong>zero conditional mean assumption</strong>.</li>
</ul></li>
</ul>
</section>
<section id="ordinary-least-squares" class="slide level2 smaller" data-background="#454343">
<h2>Ordinary Least Squares</h2>
<p>Our focus is to find estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Should we have access to the population, it would be easy. We could write:</p>
<p><span class="math display">\[y_i= \alpha + \beta_1x_i + \mu\]</span></p>
<div class="fragment">
<p>But remember that,</p>
<p><span class="math display">\[E(u) = 0\]</span> <span class="math display">\[E(u|x) = 0\]</span></p>
<p>The second bullet implies that the correlation between x and <span class="math inline">\(\mu\)</span> is zero (we can write that as E(x,u) = 0).</p>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Remember: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are parameters to be estimated (i.e., constants), while <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are variables</p>
</div>
</div>
</div>
</div>
</section>
<section id="regression-10" class="slide level2 smaller" data-background="#454343">
<h2>Regression</h2>
<p>So we can write that (in the <strong>population</strong>)</p>
<p><span class="math inline">\(E(y - \alpha - \beta_1x ) = 0\)</span></p>
<p><span class="math inline">\((x[y - \alpha - \beta_1x ]) = 0\)</span></p>
<div class="fragment">
<p>So we can write that (in the <strong>sample</strong>)</p>
<p><span class="math inline">\(\frac{1}{n} \sum_{i=1}^n (y_i - \hat{\alpha} - \hat{\beta_1} x_i ) = 0\)</span> , We will use this to find <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math inline">\(\frac{1}{n} \sum_{i=1}^n (x_i [y_i - \hat{\alpha} - \hat{\beta_1} x_i ]) = 0\)</span> , We will use this to find <span class="math inline">\(\beta\)</span>:</p>
</div>
</section>
<section id="finding-alpha" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\alpha\)</span></h2>
<p>From before:</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (y_i - \hat{\alpha} - \hat{\beta_1} x_i ) =0\]</span></p>
<div class="fragment">
<p>Passing the sum operator through</p>
<p><span class="math display">\[\frac{1}{n}\sum_{i=1}^n(y_i) - \frac{1}{n}\sum_{i=1}^n(\hat{\alpha})  - \frac{1}{n} \sum_{i=1}^n(\hat{\beta_1} x_i )=0\]</span></p>
</div>
<div class="fragment">
<p>Coefficients are constants, so we can get rid of the sum operator.</p>
<p><span class="math display">\[\frac{1}{n}\sum_{i=1}^n(y_i) - \hat{\alpha}  - \hat{\beta_1} \frac{1}{n}  \sum_{i=1}^n(\ x_i )=0\]</span></p>
</div>
</section>
<section id="finding-alpha-1" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\alpha\)</span></h2>
<ul>
<li>We know that <span class="math inline">\(\frac{1}{n}\sum_{i=1}^n(y_i)\)</span> is <span class="math inline">\(\bar{y_i}\)</span> (the mean)</li>
</ul>
<p><span class="math display">\[\bar{y_i} - \hat{\alpha}  - \hat{\beta_1}  \bar{x_i}=0\]</span></p>
<div class="fragment">
<p>So we write:</p>
<p><span class="math display">\[\hat{\alpha}  = \bar{y_i} -  \hat{\beta_1}   \bar{x_i}\]</span></p>
</div>
<div class="fragment">
<p><strong>Easy Peasy</strong> üòÄ</p>
</div>
</section>
<section id="finding-beta" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\beta\)</span></h2>
<p>From before:</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (x_i [y_i - \hat{\alpha} - \hat{\beta_1} x_i ]) = 0\]</span></p>
<div class="fragment">
<p>But now we have:</p>
<p><span class="math display">\[\hat{\alpha}  = \bar{y_i} -  \hat{\beta_1}   \bar{x_i}\]</span></p>
</div>
<div class="fragment">
<p>Thus,</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (x_i [y_i - (\bar{y_i} -  \hat{\beta_1}   \bar{x_i}) - \hat{\beta_1} x_i ]) = 0\]</span></p>
</div>
</section>
<section id="finding-beta-1" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\beta\)</span></h2>
<p>Turning into</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (x_i [y_i - \bar{y_i} ])  -  \frac{1}{n} \sum_{i=1}^n (x_i [\hat{\beta_1} x_i - \hat{\beta_1} \bar{x_i} ]) = 0\]</span></p>
<div class="fragment">
<p>Or</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (x_i [y_i - \bar{y_i} ])  =  \hat{\beta_1} \frac{1}{n} \sum_{i=1}^n (x_i [ x_i  - \bar{x_i} ]) \]</span></p>
</div>
<div class="fragment">
<p>Last step (I am skipping some steps here)</p>
<p><span class="math display">\[\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x} )(y_i - \bar{y_i} )  =  \hat{\beta_1} \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x_i} )^2 \]</span></p>
</div>
</section>
<section id="finding-beta-2" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\beta\)</span></h2>
<p>If the variance of x is not zero, we can write <span class="math inline">\(\beta\)</span> as</p>
<p><span class="math display">\[\hat{\beta_1} = \frac{\sum_i^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_i^n (x_i - \bar{x})^2} = \frac{Covariance(x_i,y_i)}{Variance(x_i)}\]</span></p>
</section>
<section id="finding-mu" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\mu\)</span></h2>
<p>Now that we have <span class="math inline">\(\hat{Y_i}=\hat{\alpha} + \hat{\beta_1} X_i\)</span>, we can estimate the residual <span class="math inline">\(\mu\)</span></p>
<p><span class="math display">\[\hat{\mu} = Y_i - \hat{Y_i}\]</span></p>
<p>Which is the same as:</p>
<p><span class="math display">\[\hat{\mu} = Y_i - \hat{\alpha} - \hat{\beta_1}x_i\]</span></p>
<p>Most residuals will not be 0, meaning they do not lie on the best fitting line.</p>
</section>
<section id="finding-mu-1" class="slide level2 smaller" data-background="#454343">
<h2>Finding <span class="math inline">\(\mu\)</span></h2>
<p>The job of an OLS model is find the parameters to minimize the squared error (i.e., to find the best fitting line).</p>
<p><span class="math display">\[\sum_{i=1}^n \hat{\mu}^2 = \sum_{i=1}^n(Y_i - \hat{Y_i})^2\]</span></p>
</section>
<section id="regression-source" class="slide level2 smaller" data-background="#454343">
<h2>Regression (<a href="https://mixtape.scunning.com/02-probability_and_regression#ordinary-least-squares">Source</a>)</h2>
<p>Another example of regression. The differences in the coefficients are due to the differences in the seed of the random variables generator.</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">R</a></li><li><a href="#tabset-1-2">Python</a></li><li><a href="#tabset-1-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-3"><a></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-4"><a></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb1-5"><a></a>  <span class="at">u =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb1-6"><a></a>  <span class="at">y =</span> <span class="fl">5.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span>u <span class="co"># notice that I am defining the beta1 here. The 5.5 is the "true" beta we want to estimate.</span></span>
<span id="cb1-7"><a></a>) </span>
<span id="cb1-8"><a></a>reg_tb <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>tb) </span>
<span id="cb1-9"><a></a><span class="fu">summary</span>(reg_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = tb)

Residuals:
    Min      1Q  Median      3Q     Max 
-51.528  -8.152  -0.173   7.978  44.718 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.04991    0.11890   -0.42    0.675    
x            5.55690    0.11745   47.31   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.89 on 9998 degrees of freedom
Multiple R-squared:  0.1829,    Adjusted R-squared:  0.1828 
F-statistic:  2238 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb3-4"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a>obs <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb3-8"><a></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-9"><a></a>    <span class="st">'x'</span>: np.random.normal(size<span class="op">=</span>obs),</span>
<span id="cb3-10"><a></a>    <span class="st">'u'</span>: np.random.normal(size<span class="op">=</span>obs),</span>
<span id="cb3-11"><a></a>})</span>
<span id="cb3-12"><a></a>data[<span class="st">'y'</span>] <span class="op">=</span> <span class="fl">5.5</span> <span class="op">*</span> data[<span class="st">'x'</span>] <span class="op">+</span> <span class="dv">12</span> <span class="op">*</span> data[<span class="st">'u'</span>]</span>
<span id="cb3-13"><a></a></span>
<span id="cb3-14"><a></a>X <span class="op">=</span> sm.add_constant(data[<span class="st">'x'</span>])</span>
<span id="cb3-15"><a></a>model <span class="op">=</span> sm.OLS(data[<span class="st">'y'</span>], X).fit()</span>
<span id="cb3-16"><a></a></span>
<span id="cb3-17"><a></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.183
Model:                            OLS   Adj. R-squared:                  0.183
Method:                 Least Squares   F-statistic:                     2237.
Date:                qua, 11 set 2024   Prob (F-statistic):               0.00
Time:                        17:07:22   Log-Likelihood:                -39049.
No. Observations:               10000   AIC:                         7.810e+04
Df Residuals:                    9998   BIC:                         7.812e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.1114      0.120      0.927      0.354      -0.124       0.347
x              5.6887      0.120     47.293      0.000       5.453       5.924
==============================================================================
Omnibus:                        0.640   Durbin-Watson:                   2.050
Prob(Omnibus):                  0.726   Jarque-Bera (JB):                0.672
Skew:                          -0.012   Prob(JB):                        0.715
Kurtosis:                       2.968   Cond. No.                         1.01
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a></a><span class="kw">set</span> <span class="dv">seed</span> 1 </span>
<span id="cb5-2"><a></a><span class="kw">set</span> <span class="kw">obs</span> 10000 </span>
<span id="cb5-3"><a></a><span class="kw">gen</span> x = rnormal() </span>
<span id="cb5-4"><a></a><span class="kw">gen</span> u  = rnormal() </span>
<span id="cb5-5"><a></a><span class="kw">gen</span> <span class="fu">y</span>  = 5.5*x + 12*u </span>
<span id="cb5-6"><a></a><span class="kw">reg</span> <span class="fu">y</span> x </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations (_N) was 0, now 10,000.

      Source |       SS           df       MS      Number of obs   =    10,000
-------------+----------------------------------   F(1, 9998)      =   2206.80
       Model |  327141.413         1  327141.413   Prob &gt; F        =    0.0000
    Residual |   1482125.8     9,998  148.242229   R-squared       =    0.1808
-------------+----------------------------------   Adj R-squared   =    0.1807
       Total |  1809267.22     9,999  180.944816   Root MSE        =    12.175

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |   5.598296    .119172    46.98   0.000     5.364695    5.831897
       _cons |  -.0750109   .1217548    -0.62   0.538    -.3136748     .163653
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="regression-source-1" class="slide level2 smaller" data-background="#454343">
<h2>Regression (<a href="https://mixtape.scunning.com/02-probability_and_regression#ordinary-least-squares">Source</a>)</h2>
<p>Another example of regression. The differences in the coefficients are due to the differences in the seed of the random variables generator.</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">R</a></li><li><a href="#tabset-2-2">Python</a></li><li><a href="#tabset-2-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-3"><a></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-4"><a></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb7-5"><a></a>  <span class="at">u =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb7-6"><a></a>  <span class="at">y =</span> <span class="fl">5.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span>u <span class="co"># notice that I am defining the beta1 here. The 5.5 is the "true" beta we want to estimate.</span></span>
<span id="cb7-7"><a></a>) </span>
<span id="cb7-8"><a></a>reg_tb <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>tb) </span>
<span id="cb7-9"><a></a>tb <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a></a>  <span class="fu">lm</span>(y <span class="sc">~</span> x, .) <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb7-12"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"OLS Regression Line"</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb7-16"><a></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Intercept = "</span>, reg_tb<span class="sc">$</span>coefficients[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb7-17"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb7-18"><a></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Slope ="</span>, reg_tb<span class="sc">$</span>coefficients[<span class="dv">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb8-4"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-5"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-6"><a></a></span>
<span id="cb8-7"><a></a><span class="co"># Create a scatterplot with the OLS regression line using Seaborn</span></span>
<span id="cb8-8"><a></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'whitegrid'</span>)</span>
<span id="cb8-9"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb8-10"><a></a>sns.scatterplot(x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, data<span class="op">=</span>data, color<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb8-11"><a></a>sns.regplot(x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, data<span class="op">=</span>data, color<span class="op">=</span><span class="st">'black'</span>, scatter<span class="op">=</span><span class="va">False</span>, line_kws<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'black'</span>})</span>
<span id="cb8-12"><a></a>plt.title(<span class="st">'OLS Regression Line'</span>)</span>
<span id="cb8-13"><a></a>plt.annotate(<span class="ss">f'Intercept = </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">'</span>, xy<span class="op">=</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="dv">30</span>), color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb8-14"><a></a>plt.annotate(<span class="ss">f'Slope = </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">'</span>, xy<span class="op">=</span>(<span class="fl">1.5</span>, <span class="op">-</span><span class="dv">30</span>), color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb8-15"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a></a><span class="kw">set</span> <span class="dv">seed</span> 1 </span>
<span id="cb9-2"><a></a><span class="kw">set</span> <span class="kw">obs</span> 10000 </span>
<span id="cb9-3"><a></a><span class="kw">gen</span> x = rnormal() </span>
<span id="cb9-4"><a></a><span class="kw">gen</span> u  = rnormal() </span>
<span id="cb9-5"><a></a><span class="kw">gen</span> <span class="fu">y</span>  = 5.5*x + 12*u </span>
<span id="cb9-6"><a></a><span class="kw">reg</span> <span class="fu">y</span> x </span>
<span id="cb9-7"><a></a><span class="kw">predict</span> yhat1 </span>
<span id="cb9-8"><a></a><span class="kw">gen</span> yhat2 = -0.0750109  + 5.598296*x </span>
<span id="cb9-9"><a></a><span class="kw">predict</span> uhat1, residual </span>
<span id="cb9-10"><a></a><span class="kw">gen</span> uhat2=<span class="fu">y</span>-yhat2 </span>
<span id="cb9-11"><a></a><span class="kw">qui</span> <span class="kw">sum</span> uhat* </span>
<span id="cb9-12"><a></a><span class="kw">twoway</span> (<span class="kw">lfit</span> <span class="fu">y</span> x, lcolor(<span class="bn">black</span>) lwidth(medium)) (<span class="kw">scatter</span> <span class="fu">y</span> x, mcolor(<span class="bn">black</span>) msize(tiny) <span class="bn">msymbol</span>(point)), <span class="bn">title</span>(OLS Regression Line) </span>
<span id="cb9-13"><a></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"files/graph3.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img data-src="files/graph3.svg"></p>
</div>
</div>
</div>
</section>
<section id="regression-source-2" class="slide level2 smaller scrollable" data-background="#454343">
<h2>Regression (<a href="https://mixtape.scunning.com/02-probability_and_regression#ordinary-least-squares">Source</a>)</h2>
<p>Using the previous regressions, we can show that:</p>
<ol type="1">
<li><p><span class="math inline">\(\hat{y_i} = \hat{\alpha} + \hat{\beta_1} x_i\)</span></p></li>
<li><p><span class="math inline">\(\hat{\mu_i} = y_i - \hat{y_i}\)</span></p></li>
</ol>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">R</a></li><li><a href="#tabset-3-2">Python</a></li><li><a href="#tabset-3-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-2"><a></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-3"><a></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-4"><a></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb10-5"><a></a>  <span class="at">u =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb10-6"><a></a>  <span class="at">y =</span> <span class="fl">5.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span>u <span class="co"># notice that I am defining the beta1 here. The 5.5 is the "true" beta we want to estimate.</span></span>
<span id="cb10-7"><a></a>) </span>
<span id="cb10-8"><a></a>reg_tb <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>tb) </span>
<span id="cb10-9"><a></a></span>
<span id="cb10-10"><a></a>tb <span class="ot">&lt;-</span> tb <span class="sc">%&gt;%</span> </span>
<span id="cb10-11"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-12"><a></a>    <span class="at">yhat1 =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb10-13"><a></a>    <span class="at">yhat2 =</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x, </span>
<span id="cb10-14"><a></a>    <span class="at">uhat1 =</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb10-15"><a></a>    <span class="at">uhat2 =</span> y <span class="sc">-</span> yhat2</span>
<span id="cb10-16"><a></a>  )</span>
<span id="cb10-17"><a></a><span class="fu">summary</span>(tb[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     yhat1               yhat2               uhat1              uhat2         
 Min.   :-20.45096   Min.   :-20.45096   Min.   :-51.5275   Min.   :-51.5275  
 1st Qu.: -3.79189   1st Qu.: -3.79189   1st Qu.: -8.1520   1st Qu.: -8.1520  
 Median : -0.13842   Median : -0.13842   Median : -0.1727   Median : -0.1727  
 Mean   : -0.08624   Mean   : -0.08624   Mean   :  0.0000   Mean   :  0.0000  
 3rd Qu.:  3.71578   3rd Qu.:  3.71578   3rd Qu.:  7.9778   3rd Qu.:  7.9778  
 Max.   : 21.12342   Max.   : 21.12342   Max.   : 44.7176   Max.   : 44.7176  </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb12-4"><a></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb12-5"><a></a>obs <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb12-6"><a></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb12-7"><a></a>u <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb12-8"><a></a>y <span class="op">=</span> <span class="fl">5.5</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">12</span> <span class="op">*</span> u</span>
<span id="cb12-9"><a></a></span>
<span id="cb12-10"><a></a>X <span class="op">=</span> sm.add_constant(x)</span>
<span id="cb12-11"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb12-12"><a></a></span>
<span id="cb12-13"><a></a>tb <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'u'</span>: u, <span class="st">'y'</span>: y})</span>
<span id="cb12-14"><a></a>tb[<span class="st">'yhat1'</span>] <span class="op">=</span> model.predict(X)</span>
<span id="cb12-15"><a></a>tb[<span class="st">'uhat1'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat1'</span>]</span>
<span id="cb12-16"><a></a>tb[<span class="st">'yhat2'</span>] <span class="op">=</span> model.params[<span class="dv">0</span>] <span class="op">+</span> model.params[<span class="dv">1</span>] <span class="op">*</span> x</span>
<span id="cb12-17"><a></a>tb[<span class="st">'uhat2'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat2'</span>]</span>
<span id="cb12-18"><a></a></span>
<span id="cb12-19"><a></a><span class="bu">print</span>(tb[[<span class="st">'yhat1'</span>,<span class="st">'yhat2'</span>, <span class="st">'uhat1'</span>,<span class="st">'uhat2'</span>]].describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              yhat1         yhat2         uhat1         uhat2
count  10000.000000  10000.000000  1.000000e+04  1.000000e+04
mean       0.166975      0.166975 -1.691092e-16 -1.691092e-16
std        5.682040      5.682040  1.201339e+01  1.201339e+01
min      -20.688875    -20.688875 -4.142425e+01 -4.142425e+01
25%       -3.659775     -3.659775 -8.199882e+00 -8.199882e+00
50%        0.159473      0.159473  4.497835e-02  4.497835e-02
75%        3.933075      3.933075  8.147307e+00  8.147307e+00
max       23.018769     23.018769  5.000751e+01  5.000751e+01</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a></a><span class="kw">set</span> <span class="dv">seed</span> 1 </span>
<span id="cb14-2"><a></a><span class="kw">clear</span> </span>
<span id="cb14-3"><a></a><span class="kw">qui</span> <span class="kw">set</span> <span class="kw">obs</span> 10000 </span>
<span id="cb14-4"><a></a><span class="kw">gen</span> x = rnormal() </span>
<span id="cb14-5"><a></a><span class="kw">gen</span> u  = rnormal() </span>
<span id="cb14-6"><a></a><span class="kw">gen</span> <span class="fu">y</span>  = 5.5*x + 12*u </span>
<span id="cb14-7"><a></a><span class="kw">qui</span> <span class="kw">reg</span> <span class="fu">y</span> x </span>
<span id="cb14-8"><a></a><span class="kw">predict</span> uhat1, residual </span>
<span id="cb14-9"><a></a><span class="kw">predict</span> yhat1 </span>
<span id="cb14-10"><a></a><span class="kw">gen</span> yhat2 = -0.0750109  + 5.598296*x </span>
<span id="cb14-11"><a></a><span class="kw">gen</span> uhat2=<span class="fu">y</span>-yhat2 </span>
<span id="cb14-12"><a></a><span class="kw">sum</span> yhat*  uhat* </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(option xb assumed; fitted values)

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       yhat1 |     10,000   -.0797351    5.719914  -23.06927   22.47639
       yhat2 |     10,000   -.0797351    5.719913  -23.06927   22.47639
       uhat1 |     10,000   -3.53e-09    12.17487   -49.8996   42.15174
       uhat2 |     10,000   -1.72e-08    12.17487   -49.8996   42.15174</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="properties-of-ols" class="title-slide slide level1 smaller center" data-background="#bfc4d9">
<h1>Properties of OLS</h1>

</section>
<section id="properties-of-ols-1" class="slide level2 smaller" data-background="#bfc4d9">
<h2>Properties of OLS</h2>
<p>We can easily show that (remember from before)</p>
<p><span class="math display">\[\sum_i^n(y_i - \hat{\alpha} - \hat{\beta_1} x_i) = 0\]</span></p>
<p>And that</p>
<p><span class="math display">\[\sum_i^n \hat{\mu}  = 0\]</span></p>
<p>The graphs next slide shows a spherical figure, suggesting that the residual is not correlated with the the fitted values (<span class="math inline">\(\hat{y_i}\)</span>)</p>
</section>
<section id="properties-of-ols-2" class="slide level2 smaller" data-background="#bfc4d9">
<h2>Properties of OLS</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">R</a></li><li><a href="#tabset-4-2">Python</a></li><li><a href="#tabset-4-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-2"><a></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-3"><a></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-4"><a></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb16-5"><a></a>  <span class="at">u =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb16-6"><a></a>  <span class="at">y =</span> <span class="fl">5.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span>u <span class="co"># notice that I am defining the beta1 here. The 5.5 is the "true" beta we want to estimate.</span></span>
<span id="cb16-7"><a></a>) </span>
<span id="cb16-8"><a></a>reg_tb <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>tb) </span>
<span id="cb16-9"><a></a>tb <span class="ot">&lt;-</span> tb <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-11"><a></a>    <span class="at">yhat1 =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb16-12"><a></a>    <span class="at">yhat2 =</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x, </span>
<span id="cb16-13"><a></a>    <span class="at">uhat1 =</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb16-14"><a></a>    <span class="at">uhat2 =</span> y <span class="sc">-</span> yhat2</span>
<span id="cb16-15"><a></a>  )</span>
<span id="cb16-16"><a></a>tb <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a></a>  <span class="fu">lm</span>(uhat1 <span class="sc">~</span> yhat1 , .) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>yhat1, <span class="at">y=</span>uhat1)) <span class="sc">+</span> </span>
<span id="cb16-19"><a></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb17-4"><a></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb17-5"><a></a>obs <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb17-6"><a></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb17-7"><a></a>u <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb17-8"><a></a>y <span class="op">=</span> <span class="fl">5.5</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">12</span> <span class="op">*</span> u</span>
<span id="cb17-9"><a></a></span>
<span id="cb17-10"><a></a>X <span class="op">=</span> sm.add_constant(x)</span>
<span id="cb17-11"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb17-12"><a></a></span>
<span id="cb17-13"><a></a>tb <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'u'</span>: u, <span class="st">'y'</span>: y})</span>
<span id="cb17-14"><a></a>tb[<span class="st">'yhat1'</span>] <span class="op">=</span> model.predict(X)</span>
<span id="cb17-15"><a></a>tb[<span class="st">'uhat1'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat1'</span>]</span>
<span id="cb17-16"><a></a>tb[<span class="st">'yhat2'</span>] <span class="op">=</span> model.params[<span class="dv">0</span>] <span class="op">+</span> model.params[<span class="dv">1</span>] <span class="op">*</span> x</span>
<span id="cb17-17"><a></a>tb[<span class="st">'uhat2'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat2'</span>]</span>
<span id="cb17-18"><a></a>model <span class="op">=</span> sm.OLS(tb[<span class="st">'uhat1'</span>], sm.add_constant(tb[<span class="st">'yhat1'</span>])).fit()</span>
<span id="cb17-19"><a></a><span class="co"># Create a scatter plot with a regression line</span></span>
<span id="cb17-20"><a></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb17-21"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="fl">4.5</span>))</span>
<span id="cb17-22"><a></a>sns.scatterplot(x<span class="op">=</span><span class="st">'yhat1'</span>, y<span class="op">=</span><span class="st">'uhat1'</span>, data<span class="op">=</span>tb, size<span class="op">=</span><span class="fl">0.05</span>, color<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb17-23"><a></a>sns.regplot(x<span class="op">=</span><span class="st">'yhat1'</span>, y<span class="op">=</span><span class="st">'uhat1'</span>, data<span class="op">=</span>tb, scatter<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb17-24"><a></a>plt.xlabel(<span class="st">'yhat1'</span>)</span>
<span id="cb17-25"><a></a>plt.ylabel(<span class="st">'uhat1'</span>)</span>
<span id="cb17-26"><a></a>plt.title(<span class="st">'Scatter Plot of uhat1 vs. yhat1'</span>)</span>
<span id="cb17-27"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a></a><span class="kw">set</span> <span class="dv">seed</span> 1 </span>
<span id="cb18-2"><a></a><span class="kw">set</span> <span class="kw">obs</span> 10000 </span>
<span id="cb18-3"><a></a><span class="kw">gen</span> x = rnormal() </span>
<span id="cb18-4"><a></a><span class="kw">gen</span> u  = rnormal() </span>
<span id="cb18-5"><a></a><span class="kw">gen</span> <span class="fu">y</span>  = 5.5*x + 12*u </span>
<span id="cb18-6"><a></a><span class="kw">qui</span> <span class="kw">reg</span> <span class="fu">y</span> x </span>
<span id="cb18-7"><a></a><span class="kw">predict</span> yhat1 </span>
<span id="cb18-8"><a></a><span class="kw">predict</span> uhat1, residual </span>
<span id="cb18-9"><a></a><span class="kw">twoway</span> (<span class="kw">lfit</span> uhat1 yhat1 , lcolor(<span class="bn">black</span>) lwidth(large)) (<span class="kw">scatter</span> uhat1 yhat1 , mcolor(<span class="bn">black</span>)  <span class="bn">msymbol</span>(point))</span>
<span id="cb18-10"><a></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"files/graph4.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img data-src="files/graph4.svg"></p>
</div>
</div>
</div>
</section>
<section id="properties-of-ols-3" class="slide level2 smaller" data-background="#bfc4d9">
<h2>Properties of OLS</h2>
<p>Similarly, we can easily show that</p>
<p><span class="math display">\[\sum_i^nx_i(y_i - \hat{\alpha} - \hat{\beta_1} x_i) = 0\]</span></p>
<p>And that</p>
<p><span class="math display">\[\sum_i^nx_i\hat{\mu}  = 0\]</span></p>
<p>Meaning that the sample covariance between the X and the residual will be always zero.</p>
</section>
<section id="properties-of-ols-4" class="slide level2 smaller" data-background="#bfc4d9">
<h2>Properties of OLS</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">R</a></li><li><a href="#tabset-5-2">Python</a></li><li><a href="#tabset-5-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-2"><a></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-3"><a></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb19-5"><a></a>  <span class="at">u =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb19-6"><a></a>  <span class="at">y =</span> <span class="fl">5.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span>u <span class="co"># notice that I am defining the beta1 here. The 5.5 is the "true" beta we want to estimate.</span></span>
<span id="cb19-7"><a></a>) </span>
<span id="cb19-8"><a></a>reg_tb <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>tb) </span>
<span id="cb19-9"><a></a>tb <span class="ot">&lt;-</span> tb <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-11"><a></a>    <span class="at">yhat1 =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb19-12"><a></a>    <span class="at">yhat2 =</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> reg_tb<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x, </span>
<span id="cb19-13"><a></a>    <span class="at">uhat1 =</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, .)),</span>
<span id="cb19-14"><a></a>    <span class="at">uhat2 =</span> y <span class="sc">-</span> yhat2</span>
<span id="cb19-15"><a></a>  )</span>
<span id="cb19-16"><a></a>tb <span class="sc">%&gt;%</span> </span>
<span id="cb19-17"><a></a>  <span class="fu">lm</span>(uhat1 <span class="sc">~</span> x , .) <span class="sc">%&gt;%</span> </span>
<span id="cb19-18"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>uhat1)) <span class="sc">+</span> </span>
<span id="cb19-19"><a></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb19-20"><a></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-13-3.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb20-4"><a></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb20-5"><a></a>obs <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb20-6"><a></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb20-7"><a></a>u <span class="op">=</span> np.random.normal(size<span class="op">=</span>obs)</span>
<span id="cb20-8"><a></a>y <span class="op">=</span> <span class="fl">5.5</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">12</span> <span class="op">*</span> u</span>
<span id="cb20-9"><a></a></span>
<span id="cb20-10"><a></a>X <span class="op">=</span> sm.add_constant(x)</span>
<span id="cb20-11"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb20-12"><a></a></span>
<span id="cb20-13"><a></a>tb <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'u'</span>: u, <span class="st">'y'</span>: y})</span>
<span id="cb20-14"><a></a>tb[<span class="st">'yhat1'</span>] <span class="op">=</span> model.predict(X)</span>
<span id="cb20-15"><a></a>tb[<span class="st">'uhat1'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat1'</span>]</span>
<span id="cb20-16"><a></a>tb[<span class="st">'yhat2'</span>] <span class="op">=</span> model.params[<span class="dv">0</span>] <span class="op">+</span> model.params[<span class="dv">1</span>] <span class="op">*</span> x</span>
<span id="cb20-17"><a></a>tb[<span class="st">'uhat2'</span>] <span class="op">=</span> y <span class="op">-</span> tb[<span class="st">'yhat2'</span>]</span>
<span id="cb20-18"><a></a>model <span class="op">=</span> sm.OLS(tb[<span class="st">'uhat1'</span>], sm.add_constant(tb[<span class="st">'yhat1'</span>])).fit()</span>
<span id="cb20-19"><a></a><span class="co"># Create a scatter plot with a regression line</span></span>
<span id="cb20-20"><a></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb20-21"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="fl">4.5</span>))</span>
<span id="cb20-22"><a></a>sns.scatterplot(x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'uhat1'</span>, data<span class="op">=</span>tb, size<span class="op">=</span><span class="fl">0.05</span>, color<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb20-23"><a></a>sns.regplot(x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'uhat1'</span>, data<span class="op">=</span>tb, scatter<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb20-24"><a></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb20-25"><a></a>plt.ylabel(<span class="st">'uhat1'</span>)</span>
<span id="cb20-26"><a></a>plt.title(<span class="st">'Scatter Plot of uhat1 vs. x'</span>)</span>
<span id="cb20-27"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb21-1"><a></a><span class="kw">set</span> <span class="dv">seed</span> 1 </span>
<span id="cb21-2"><a></a><span class="kw">set</span> <span class="kw">obs</span> 10000 </span>
<span id="cb21-3"><a></a><span class="kw">gen</span> x = rnormal() </span>
<span id="cb21-4"><a></a><span class="kw">gen</span> u  = rnormal() </span>
<span id="cb21-5"><a></a><span class="kw">gen</span> <span class="fu">y</span>  = 5.5*x + 12*u </span>
<span id="cb21-6"><a></a><span class="kw">qui</span> <span class="kw">reg</span> <span class="fu">y</span> x </span>
<span id="cb21-7"><a></a><span class="kw">predict</span> yhat1 </span>
<span id="cb21-8"><a></a><span class="kw">predict</span> uhat1, residual </span>
<span id="cb21-9"><a></a><span class="kw">twoway</span> (<span class="kw">lfit</span> uhat1 x , lcolor(<span class="bn">black</span>) lwidth(large)) (<span class="kw">scatter</span> uhat1 x , mcolor(<span class="bn">black</span>) <span class="bn">msymbol</span>(point))</span>
<span id="cb21-10"><a></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"files/graph5.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img data-src="files/graph5.svg"></p>
</div>
</div>
</div>
</section>
<section id="properties-of-ols-5" class="slide level2 smaller" data-background="#bfc4d9">
<h2>Properties of OLS</h2>
<p>Let‚Äôs say you estimate a model and find the <span class="math inline">\(\hat{\mu}\)</span>.</p>
<p>If you calculate the correlation between the X and <span class="math inline">\(\hat{\mu}\)</span>, you will find zero.</p>
<p><strong>This is by construction!</strong> It is not an evidence that CMI is nos violated.</p>
<p>In fact, the OLS ‚Äúassumes‚Äù and ‚Äúforces‚Äù zero correlation.</p>
<p><strong>It is intuitive: if you are ‚Äúforcing‚Äù zero correlation when the correlation is not in fact zero, your coefficients will be biased.</strong></p>
<p>The previous graphs actually show zero correlation. But that is expected and does not suggest the model is not violating CMI.</p>
<p><strong>At the end of the day, CMI is untestable and unverifiable</strong>.</p>
</section></section>
<section>
<section id="goodness-of-fit" class="title-slide slide level1 smaller center" data-background="#dff2c7">
<h1>Goodness-of-fit</h1>

</section>
<section id="goodness-of-fit-1" class="slide level2 smaller" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>
<p><strong>Understanding what SSR, SSE and SST mean</strong></p>
<ul>
<li>SSE = Sum of Squares Explained = <span class="math inline">\(\sum_i^n(\hat{y_i}-\bar{y})^2\)</span></li>
<li>SSR = Sum of Squares Residuals = <span class="math inline">\(\sum_i^n\hat{\mu}^2\)</span></li>
<li>SST = Sum of Squares Total = SSE + SSR = <span class="math inline">\(\sum_i^n(y_i-\hat{y_i})^2\)</span></li>
</ul>
<p>R-squared is simply the ratio of portion explained over the total that could be explained.</p>
<p><span class="math display">\[R^2 = \frac{SSE}{SST} = 1-\frac{SSR}{SST}\]</span></p>
</section>
<section id="goodness-of-fit-2" class="slide level2 smaller" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>

<img data-src="figs/R2.jpg" class="r-stretch"></section>
<section id="goodness-of-fit-3" class="slide level2 smaller scrollable" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>
<p>You can think this way:</p>
<ol type="1">
<li>If X does not explain Y, then the best predictor of Y is <span class="math inline">\(\bar{y}\)</span>. In that case, your model does not explain anything of Y, thus <span class="math inline">\(R^2\)</span> is zero, and <span class="math inline">\(\hat{y_i}=\bar{y}\)</span></li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>If X partially explains Y, then <span class="math inline">\(\hat{y_i} \neq \bar{y}\)</span>, meaning that <span class="math inline">\(\hat{y_i}\)</span> has some inclination (like the figure next slide). This means that <span class="math inline">\(SSE&gt;0\)</span> and your <span class="math inline">\(R^2&gt;0\)</span> but <span class="math inline">\(R^2&lt;1\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Whatever is not explained by <span class="math inline">\(\hat{y_i}\)</span> is left to <span class="math inline">\(\sum_i^2\hat{\mu}^2\)</span>, meaning that SSR will be non-zero.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>The ratio of the portion that you can explain by <span class="math inline">\(\hat{y_i}\)</span> over the total that is to be explained <span class="math inline">\(y_i-\hat{y_i}\)</span> if the <span class="math inline">\(R^2\)</span>.</li>
</ol>
</div>
</section>
<section id="goodness-of-fit-4" class="slide level2 smaller" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">R</a></li><li><a href="#tabset-6-2">Python</a></li><li><a href="#tabset-6-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">library</span>(foreign) <span class="co"># importing dataset from a stata dta file</span></span>
<span id="cb22-2"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb22-3"><a></a><span class="fu">attach</span>(data)</span>
<span id="cb22-4"><a></a><span class="co"># Statistics of salary </span></span>
<span id="cb22-5"><a></a><span class="fu">mean</span>(salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1281.12</code></pre>
</div>
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="co"># OLS model</span></span>
<span id="cb24-2"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb24-3"><a></a>salaryhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)                      <span class="co"># Predict values for dependent variable</span></span>
<span id="cb24-4"><a></a>uhat <span class="ot">&lt;-</span> <span class="fu">resid</span>(model)                            <span class="co"># Predict regression residuals</span></span>
<span id="cb24-5"><a></a>salarymean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(salary),<span class="fu">length</span>(salary))  <span class="co"># Generating the mean of salary </span></span>
<span id="cb24-6"><a></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = salary ~ roe)

Residuals:
    Min      1Q  Median      3Q     Max 
-1160.2  -526.0  -254.0   138.8 13499.9 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   963.19     213.24   4.517 1.05e-05 ***
roe            18.50      11.12   1.663   0.0978 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1367 on 207 degrees of freedom
Multiple R-squared:  0.01319,   Adjusted R-squared:  0.008421 
F-statistic: 2.767 on 1 and 207 DF,  p-value: 0.09777</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-2"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb26-3"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb26-4"><a></a><span class="bu">print</span>(data[<span class="st">'salary'</span>].mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1281.1196172248804</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a><span class="co"># OLS model</span></span>
<span id="cb28-2"><a></a>X <span class="op">=</span> data[<span class="st">'roe'</span>]</span>
<span id="cb28-3"><a></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb28-4"><a></a>y <span class="op">=</span> data[<span class="st">'salary'</span>]</span>
<span id="cb28-5"><a></a></span>
<span id="cb28-6"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()  <span class="co"># Fit the linear regression model</span></span>
<span id="cb28-7"><a></a>salaryhat <span class="op">=</span> model.fittedvalues  <span class="co"># Predicted values for the dependent variable</span></span>
<span id="cb28-8"><a></a>uhat <span class="op">=</span> model.resid  <span class="co"># Predict regression residuals</span></span>
<span id="cb28-9"><a></a>salarymean <span class="op">=</span> pd.Series([y.mean()] <span class="op">*</span> <span class="bu">len</span>(y))  <span class="co"># Generating the mean of salary</span></span>
<span id="cb28-10"><a></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 salary   R-squared:                       0.013
Model:                            OLS   Adj. R-squared:                  0.008
Method:                 Least Squares   F-statistic:                     2.767
Date:                qua, 11 set 2024   Prob (F-statistic):             0.0978
Time:                        17:08:12   Log-Likelihood:                -1804.5
No. Observations:                 209   AIC:                             3613.
Df Residuals:                     207   BIC:                             3620.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const        963.1913    213.240      4.517      0.000     542.790    1383.592
roe           18.5012     11.123      1.663      0.098      -3.428      40.431
==============================================================================
Omnibus:                      311.096   Durbin-Watson:                   2.105
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            31120.902
Skew:                           6.915   Prob(JB):                         0.00
Kurtosis:                      61.158   Cond. No.                         43.3
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb30-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb30-2"><a></a><span class="kw">sum</span> salary </span>
<span id="cb30-3"><a></a><span class="kw">reg</span> salary roe </span>
<span id="cb30-4"><a></a><span class="kw">predict</span> salaryhat , <span class="kw">xb</span>              </span>
<span id="cb30-5"><a></a><span class="kw">predict</span> uhat, <span class="kw">resid</span>                 </span>
<span id="cb30-6"><a></a><span class="kw">egen</span> salarymean = <span class="kw">mean</span>(salary)      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      salary |        209     1281.12    1372.345        223      14822

      Source |       SS           df       MS      Number of obs   =       209
-------------+----------------------------------   F(1, 207)       =      2.77
       Model |  5166419.04         1  5166419.04   Prob &gt; F        =    0.0978
    Residual |   386566563       207  1867471.32   R-squared       =    0.0132
-------------+----------------------------------   Adj R-squared   =    0.0084
       Total |   391732982       208  1883331.64   Root MSE        =    1366.6

------------------------------------------------------------------------------
      salary | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         roe |   18.50119   11.12325     1.66   0.098    -3.428196    40.43057
       _cons |   963.1913   213.2403     4.52   0.000     542.7902    1383.592
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="goodness-of-fit-5" class="slide level2 smaller" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">R</a></li><li><a href="#tabset-7-2">Python</a></li><li><a href="#tabset-7-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="fu">library</span>(foreign) <span class="co"># importing dataset from a stata dta file</span></span>
<span id="cb32-2"><a></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb32-3"><a></a><span class="fu">attach</span>(mydata)</span>
<span id="cb32-4"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb32-5"><a></a>salaryhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)                      <span class="co"># Predict values for dependent variable</span></span>
<span id="cb32-6"><a></a>uhat <span class="ot">&lt;-</span> <span class="fu">resid</span>(model)                            <span class="co"># Predict regression residuals</span></span>
<span id="cb32-7"><a></a>salarymean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(salary),<span class="fu">length</span>(salary))  <span class="co"># Generating the mean of salary </span></span>
<span id="cb32-8"><a></a><span class="co"># r-squared is simply the ratio of portion explained over total that could be explained - Understanding what SSR, SSE and SST mean </span></span>
<span id="cb32-9"><a></a><span class="fu">plot</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb32-10"><a></a><span class="fu">abline</span>(<span class="fu">lm</span>(salary <span class="sc">~</span> roe), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb32-11"><a></a><span class="fu">abline</span>(<span class="fu">lm</span>(salarymean <span class="sc">~</span> roe), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb33-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-4"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb33-5"><a></a>X <span class="op">=</span> data[[<span class="st">'roe'</span>]]</span>
<span id="cb33-6"><a></a>y <span class="op">=</span> data[<span class="st">'salary'</span>]</span>
<span id="cb33-7"><a></a>salarymean <span class="op">=</span> np.repeat(y.mean(), <span class="bu">len</span>(y))</span>
<span id="cb33-8"><a></a>X_mean <span class="op">=</span> X.mean()</span>
<span id="cb33-9"><a></a>y_mean <span class="op">=</span> y.mean()</span>
<span id="cb33-10"><a></a>slope <span class="op">=</span> np.<span class="bu">sum</span>((X <span class="op">-</span> X_mean) <span class="op">*</span> (y <span class="op">-</span> y_mean)) <span class="op">/</span> np.<span class="bu">sum</span>((X <span class="op">-</span> X_mean) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb33-11"><a></a>intercept <span class="op">=</span> y_mean <span class="op">-</span> slope <span class="op">*</span> X_mean</span>
<span id="cb33-12"><a></a>salaryhat <span class="op">=</span> slope <span class="op">*</span> X <span class="op">+</span> intercept</span>
<span id="cb33-13"><a></a><span class="co"># Plotting the data and regression lines</span></span>
<span id="cb33-14"><a></a>plt.scatter(X, y,  alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb33-15"><a></a>plt.plot(X, salaryhat,  color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-16"><a></a>plt.plot(X, salarymean, color<span class="op">=</span><span class="st">'red'</span>,  linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-17"><a></a>plt.xlabel(<span class="st">'roe'</span>)</span>
<span id="cb33-18"><a></a>plt.ylabel(<span class="st">'salary'</span>)</span>
<span id="cb33-19"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="part_4_files/figure-revealjs/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb34-2"><a></a><span class="kw">sum</span> salary , <span class="kw">d</span></span>
<span id="cb34-3"><a></a><span class="kw">reg</span> salary roe </span>
<span id="cb34-4"><a></a><span class="kw">predict</span> salaryhat , <span class="kw">xb</span>              </span>
<span id="cb34-5"><a></a><span class="kw">predict</span> uhat, <span class="kw">resid</span>                 </span>
<span id="cb34-6"><a></a><span class="kw">egen</span> salarymean = <span class="kw">mean</span>(salary)      </span>
<span id="cb34-7"><a></a></span>
<span id="cb34-8"><a></a><span class="kw">twoway</span> (<span class="kw">scatter</span> salary roe) (<span class="kw">lfit</span> salary roe) (<span class="kw">lfit</span> salarymean roe) </span>
<span id="cb34-9"><a></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"files/graph4_6.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img data-src="files/graph4_6.svg"></p>
</div>
</div>
</div>
</section>
<section id="goodness-of-fit-6" class="slide level2 smaller" data-background="#dff2c7">
<h2>Goodness-of-fit</h2>
<p>Manually calculating <span class="math inline">\(R^2\)</span></p>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">R</a></li><li><a href="#tabset-8-2">Python</a></li><li><a href="#tabset-8-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">library</span>(foreign) <span class="co"># importing dataset from a stata dta file</span></span>
<span id="cb35-2"><a></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb35-3"><a></a><span class="fu">attach</span>(mydata)</span>
<span id="cb35-4"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb35-5"><a></a>salaryhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)                      <span class="co"># Predict values for dependent variable</span></span>
<span id="cb35-6"><a></a>uhat <span class="ot">&lt;-</span> <span class="fu">resid</span>(model)                            <span class="co"># Predict regression residuals</span></span>
<span id="cb35-7"><a></a>salarymean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(salary),<span class="fu">length</span>(salary))  <span class="co"># Generating the mean of salary </span></span>
<span id="cb35-8"><a></a></span>
<span id="cb35-9"><a></a><span class="co"># r-squared is simply the ratio of portion explained over total that could be explained</span></span>
<span id="cb35-10"><a></a>ssr  <span class="ot">&lt;-</span> <span class="fu">sum</span>(uhat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-11"><a></a>ssrB <span class="ot">&lt;-</span> <span class="fu">sum</span>((salary    <span class="sc">-</span> salaryhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-12"><a></a>sst  <span class="ot">&lt;-</span> <span class="fu">sum</span>((salary    <span class="sc">-</span> salarymean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-13"><a></a>sse  <span class="ot">&lt;-</span> <span class="fu">sum</span>((salaryhat <span class="sc">-</span> salarymean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-14"><a></a>sse <span class="sc">/</span> sst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01318862</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb37-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb37-4"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb37-5"><a></a>X <span class="op">=</span> data[<span class="st">'roe'</span>]</span>
<span id="cb37-6"><a></a>y <span class="op">=</span> data[<span class="st">'salary'</span>]</span>
<span id="cb37-7"><a></a>X <span class="op">=</span> sm.add_constant(X)  <span class="co"># Add a constant term (intercept)</span></span>
<span id="cb37-8"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb37-9"><a></a>salaryhat <span class="op">=</span> model.fittedvalues</span>
<span id="cb37-10"><a></a>uhat <span class="op">=</span> model.resid</span>
<span id="cb37-11"><a></a>salarymean <span class="op">=</span> np.repeat(y.mean(), <span class="bu">len</span>(y))</span>
<span id="cb37-12"><a></a><span class="co"># Calculate R-squared</span></span>
<span id="cb37-13"><a></a>ssr <span class="op">=</span> np.<span class="bu">sum</span>(uhat<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb37-14"><a></a>ssrB <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> salaryhat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb37-15"><a></a>sst <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> salarymean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb37-16"><a></a>sse <span class="op">=</span> np.<span class="bu">sum</span>((salaryhat <span class="op">-</span> salarymean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb37-17"><a></a>rsquared <span class="op">=</span> sse <span class="op">/</span> sst</span>
<span id="cb37-18"><a></a><span class="bu">print</span>(rsquared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.013188624081034118</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb39-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb39-2"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe </span>
<span id="cb39-3"><a></a><span class="kw">predict</span> salaryhat , <span class="kw">xb</span>              </span>
<span id="cb39-4"><a></a><span class="kw">predict</span> uhat, <span class="kw">resid</span>                 </span>
<span id="cb39-5"><a></a><span class="kw">egen</span> salarymean = <span class="kw">mean</span>(salary)      </span>
<span id="cb39-6"><a></a><span class="kw">egen</span> sst  = <span class="kw">total</span>((salary    - salarymean)^2)  </span>
<span id="cb39-7"><a></a><span class="kw">egen</span> ssr  = <span class="kw">total</span>((salary    - salaryhat)^2)</span>
<span id="cb39-8"><a></a><span class="kw">egen</span> ssrB = <span class="kw">total</span>(uhat^2)                   </span>
<span id="cb39-9"><a></a><span class="kw">egen</span> sse  = <span class="kw">total</span>((salaryhat - salarymean)^2)   </span>
<span id="cb39-10"><a></a><span class="kw">di</span> sse / sst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>.01318862</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="variance-of-coefficients" class="title-slide slide level1 smaller center" data-background="#c4f5d7">
<h1>Variance of coefficients</h1>

</section>
<section id="variance-of-coefficients-1" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p>When we estimate coefficients we have some ‚Äúerror of estimation‚Äù.</p>
<ul>
<li><p>Basically, you are searching the ‚Äútrue‚Äù coefficient using a sample, which should be representative of the population but it is not the population itself.</p></li>
<li><p>This means that the coefficient estimated is estimated with error.</p></li>
<li><p>We would like (e.g., we will need) to impose some ‚Äústructure‚Äù to that error.</p></li>
</ul>
</section>
<section id="variance-of-coefficients-2" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p><strong>Standard error and T-stat</strong></p>
<p>To assess if the variables are significantly related, you need to assess the significance of <span class="math inline">\(\beta\)</span> coefficients.</p>
<p>Using the example from Wooldridge, we know that the Beta of ROE is <code>18.591</code>, while the standard error of ROE is <code>11.123</code>.</p>
<div class="fragment">
<ul>
<li><p>The standard error is a measure of the accuracy of your estimate. If you find a large standard error, your estimate does not have good accuracy.</p></li>
<li><p>Ideally, you would find small standard errors, meaning that your coefficient is accurately estimated.</p></li>
<li><p>However, you do not have good control over the magnitude of the standard errors.</p></li>
</ul>
</div>
</section>
<section id="variance-of-coefficients-3" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p><strong>Standard error and T-stat</strong></p>
<p>If you have a large standard error, probably you coefficient will not be significantly different from zero. You can test whether your coefficient is significantly different from zero computing the t-statistics as follows:</p>
<p><span class="math display">\[t_{\beta} = \frac{\hat{\beta}}{se(\hat{\beta})}\]</span></p>
<p>If <span class="math inline">\(t_{\beta}\)</span> is large enough, you can say that <span class="math inline">\(\beta\)</span> is significantly different from zero. Usually, <span class="math inline">\(t_{\beta}\)</span> larger than 2 is enough to be significant.</p>
</section>
<section id="variance-of-coefficients-4" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p>In the previous example, you can find the t-stat manually as follows (<span class="math inline">\(t_{\beta} =\frac{\hat{\beta}}{se(\hat{\beta})}\)</span>):</p>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">R</a></li><li><a href="#tabset-9-2">Python</a></li><li><a href="#tabset-9-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a><span class="fu">library</span>(foreign) <span class="co"># importing dataset from a stata dta file</span></span>
<span id="cb41-2"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb41-3"><a></a><span class="fu">attach</span>(data)</span>
<span id="cb41-4"><a></a><span class="co"># OLS model</span></span>
<span id="cb41-5"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb41-6"><a></a><span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.663289</code></pre>
</div>
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.663289</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb45-2"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb45-3"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb45-4"><a></a><span class="co"># OLS model</span></span>
<span id="cb45-5"><a></a>X <span class="op">=</span> data[<span class="st">'roe'</span>]</span>
<span id="cb45-6"><a></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb45-7"><a></a>y <span class="op">=</span> data[<span class="st">'salary'</span>]</span>
<span id="cb45-8"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()  </span>
<span id="cb45-9"><a></a><span class="co"># Extract and calculate specific coefficients</span></span>
<span id="cb45-10"><a></a>coef_beta <span class="op">=</span> model.params[<span class="st">'roe'</span>]</span>
<span id="cb45-11"><a></a>coef_std_error <span class="op">=</span> model.bse[<span class="st">'roe'</span>]</span>
<span id="cb45-12"><a></a><span class="co"># Calculate t-value</span></span>
<span id="cb45-13"><a></a>t_value <span class="op">=</span> coef_beta <span class="op">/</span> coef_std_error</span>
<span id="cb45-14"><a></a><span class="co"># Print the coefficient and t-value</span></span>
<span id="cb45-15"><a></a><span class="bu">print</span>(<span class="st">"Coefficient (beta):"</span>, coef_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient (beta): 18.501186345214933</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a></a><span class="bu">print</span>(<span class="st">"Standard Error:"</span>, coef_std_error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error: 11.123250903287634</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a><span class="bu">print</span>(<span class="st">"t-value:"</span>, t_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>t-value: 1.6632894920806511</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb51-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb51-2"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe </span>
<span id="cb51-3"><a></a><span class="kw">local</span> beta = _b[roe]</span>
<span id="cb51-4"><a></a><span class="kw">local</span> std_error = _se[roe]</span>
<span id="cb51-5"><a></a><span class="kw">local</span> t_value = <span class="ot">`beta'</span> / <span class="ot">`std_error'</span></span>
<span id="cb51-6"><a></a><span class="kw">display</span> <span class="st">"Coefficient (beta): "</span> <span class="ot">`beta'</span></span>
<span id="cb51-7"><a></a><span class="kw">display</span> <span class="st">"Standard Error: "</span> <span class="ot">`std_error'</span></span>
<span id="cb51-8"><a></a><span class="kw">display</span> <span class="st">"t-value: "</span> <span class="ot">`t_value'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient (beta): 18.501186

Standard Error: 11.123251

t-value: 1.6632895</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="variance-of-coefficients-5" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p>Naturally, the previous analysis requires an estimate of <span class="math inline">\(\beta\)</span> and an estimate of the <span class="math inline">\(\beta\)</span>‚Äôs standard error.</p>
<p>The standard error can be defined as:</p>
<p><span class="math display">\[se(\hat{\beta_1})=\frac{\hat{\sigma}}{\sqrt{SST_x}}\]</span></p>
<ul>
<li>Where <span class="math inline">\(\hat{\sigma}\)</span> is the standard deviation of the error term in the regression, which can be calculated as:</li>
</ul>
<p><span class="math display">\[\hat{\sigma} = \sqrt{\frac{SSR}{n-2}}\]</span></p>
<pre><code>- The $n-2$ here is an adjustment for the degrees of freedom in the regression.</code></pre>
<ul>
<li>SST is defined as before <span class="math inline">\(\sum_i^n(y_i-\hat{y_i})^2\)</span></li>
</ul>
</section>
<section id="variance-of-coefficients-6" class="slide level2 smaller" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1">R</a></li><li><a href="#tabset-10-2">Python</a></li><li><a href="#tabset-10-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a><span class="fu">library</span>(foreign) <span class="co"># importing dataset from a stata dta file</span></span>
<span id="cb54-2"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb54-3"><a></a><span class="fu">attach</span>(data)</span>
<span id="cb54-4"><a></a><span class="co"># OLS model</span></span>
<span id="cb54-5"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe)</span>
<span id="cb54-6"><a></a><span class="co"># Extract the standard error of the coefficient for 'roe'</span></span>
<span id="cb54-7"><a></a><span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[<span class="st">"roe"</span>, <span class="st">"Std. Error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.12325</code></pre>
</div>
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a><span class="co">#calculating manually</span></span>
<span id="cb56-2"><a></a><span class="co"># Extract the residuals</span></span>
<span id="cb56-3"><a></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(model)</span>
<span id="cb56-4"><a></a><span class="co"># Number of observations (n)</span></span>
<span id="cb56-5"><a></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(residuals)</span>
<span id="cb56-6"><a></a><span class="co"># Calculate the mean of the independent variable (roe)</span></span>
<span id="cb56-7"><a></a>roe_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(roe)</span>
<span id="cb56-8"><a></a><span class="co"># Calculate the sum of squared deviations of roe from its mean (SXX)</span></span>
<span id="cb56-9"><a></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((roe <span class="sc">-</span> roe_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-10"><a></a><span class="co"># Calculate the sum of squared errors (SSE)</span></span>
<span id="cb56-11"><a></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-12"><a></a><span class="co"># Calculate the standard error of beta</span></span>
<span id="cb56-13"><a></a>Sd_beta <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(SSR <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">2</span>)))</span>
<span id="cb56-14"><a></a><span class="co"># Calculate S.E</span></span>
<span id="cb56-15"><a></a>Se_beta <span class="ot">&lt;-</span> Sd_beta <span class="sc">/</span> <span class="fu">sqrt</span>(SST)</span>
<span id="cb56-16"><a></a><span class="co"># Print the standard error of beta</span></span>
<span id="cb56-17"><a></a><span class="fu">print</span>(Se_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.12325</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb58-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb58-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb58-4"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.dta"</span>)</span>
<span id="cb58-5"><a></a>X <span class="op">=</span> data[<span class="st">'roe'</span>]</span>
<span id="cb58-6"><a></a>y <span class="op">=</span> data[<span class="st">'salary'</span>]</span>
<span id="cb58-7"><a></a>X <span class="op">=</span> sm.add_constant(X)  </span>
<span id="cb58-8"><a></a>model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb58-9"><a></a><span class="co"># Extract the standard error of the coefficient for 'roe'</span></span>
<span id="cb58-10"><a></a>beta_se_summary <span class="op">=</span> model.bse[<span class="st">'roe'</span>]</span>
<span id="cb58-11"><a></a><span class="bu">print</span>(<span class="st">"Standard Error (from summary):"</span>, beta_se_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (from summary): 11.123250903287634</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a></a><span class="co"># Calculate it manually</span></span>
<span id="cb60-2"><a></a><span class="co"># Extract the residuals</span></span>
<span id="cb60-3"><a></a>residuals <span class="op">=</span> model.resid</span>
<span id="cb60-4"><a></a><span class="co"># Number of observations (n)</span></span>
<span id="cb60-5"><a></a>n <span class="op">=</span> <span class="bu">len</span>(residuals)</span>
<span id="cb60-6"><a></a><span class="co"># Calculate the mean of the independent variable (roe)</span></span>
<span id="cb60-7"><a></a>roe_mean <span class="op">=</span> X[<span class="st">'roe'</span>].mean()</span>
<span id="cb60-8"><a></a><span class="co"># Calculate the sum of squared deviations of roe from its mean (SST)</span></span>
<span id="cb60-9"><a></a>SST <span class="op">=</span> np.<span class="bu">sum</span>((X[<span class="st">'roe'</span>] <span class="op">-</span> roe_mean) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb60-10"><a></a><span class="co"># Calculate the sum of squared errors (SSE)</span></span>
<span id="cb60-11"><a></a>SSE <span class="op">=</span> np.<span class="bu">sum</span>(residuals <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb60-12"><a></a><span class="co"># Calculate the standard error of beta (Sd_beta)</span></span>
<span id="cb60-13"><a></a>Sd_beta <span class="op">=</span> np.sqrt(SSE <span class="op">/</span> (n <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb60-14"><a></a><span class="co"># Calculate SE_beta</span></span>
<span id="cb60-15"><a></a>SE_beta <span class="op">=</span> Sd_beta <span class="op">/</span> np.sqrt(SST)</span>
<span id="cb60-16"><a></a><span class="bu">print</span>(<span class="st">"Standard Error (manually calculated):"</span>, SE_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (manually calculated): 11.123250601798315</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb62-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb62-2"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe </span>
<span id="cb62-3"><a></a><span class="kw">gen</span> beta_se_summary = _se[roe]</span>
<span id="cb62-4"><a></a><span class="kw">gen</span> n = _N</span>
<span id="cb62-5"><a></a><span class="kw">predict</span> residuals, residuals</span>
<span id="cb62-6"><a></a><span class="kw">sum</span> roe, <span class="kw">meanonly</span></span>
<span id="cb62-7"><a></a><span class="kw">gen</span> roe_diff = roe - <span class="fu">r</span>(<span class="kw">mean</span>)</span>
<span id="cb62-8"><a></a><span class="kw">egen</span> roe_diff_sq = <span class="kw">total</span>(roe_diff^2)</span>
<span id="cb62-9"><a></a><span class="kw">gen</span> residuals_sq = residuals^2</span>
<span id="cb62-10"><a></a><span class="kw">egen</span> residuals_sq_sum = <span class="kw">total</span>(residuals_sq)</span>
<span id="cb62-11"><a></a><span class="kw">gen</span> Sd_beta = <span class="fu">sqrt</span>(residuals_sq_sum / (n - 2))</span>
<span id="cb62-12"><a></a><span class="kw">gen</span> SE_beta = Sd_beta / <span class="fu">sqrt</span>(roe_diff_sq)</span>
<span id="cb62-13"><a></a><span class="kw">display</span> <span class="st">"Standard Error (from summary): "</span> <span class="kw">sum</span>(beta_se_summary)</span>
<span id="cb62-14"><a></a><span class="kw">display</span> <span class="st">"Standard Error (manually calculated): "</span> <span class="kw">sum</span>(SE_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (from summary): 11.123251

Standard Error (manually calculated): 11.123251</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="variance-of-coefficients-7" class="slide level2 smaller scrollable" data-background="#c4f5d7">
<h2>Variance of coefficients</h2>
<p><strong>Another comment:</strong></p>
<p><span class="math display">\[se(\hat{\beta_1})=\frac{\hat{\sigma}}{\sqrt{SST_x}}\]</span></p>
<ol type="1">
<li><p>The larger <span class="math inline">\(\hat{\sigma}\)</span> is, the larger the variance of <span class="math inline">\(\beta\)</span>. That is, the more ‚Äúnoise‚Äù in the association between x and Y, the harder it is to learn something about <span class="math inline">\(\beta\)</span>.</p></li>
<li><p>However, more variation in x, the larger the SST, so the smaller is the variance of <span class="math inline">\(\beta\)</span>.</p></li>
</ol>
</section></section>
<section>
<section id="robust-standard-errors" class="title-slide slide level1 smaller center" data-background="#e0cafc">
<h1>Robust standard errors</h1>

</section>
<section id="robust-standard-errors-1" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p>Looking at both equations below:</p>
<p><span class="math display">\[t_{\beta} = \frac{\hat{\beta}}{se(\hat{\beta})}\]</span></p>
<p><span class="math display">\[se(\hat{\beta_1})=\frac{\hat{\sigma}}{\sqrt{SST_x}}\]</span></p>
<p><strong>What happens if <span class="math inline">\(\hat{\sigma}\)</span> is not constant (for the values of x)?</strong></p>
<p><strong>In other words, how realistic is to assume that the variance in the errors is the same for all slices of x?</strong></p>
<p><strong>Can you think of an example where that may happen?</strong></p>
</section>
<section id="robust-standard-errors-2" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p><strong>Earnings = f(education)</strong></p>
<p>PhD have a higher variance of earnings than non-educated people.</p>
<div class="fragment">
<p><strong>Leveragge=f(Size)</strong></p>
<p>It is quite possible that small firms will have less options of leverage than large companies.</p>
<p>This means that a sub-sample of large companies will have higher variance in the leverage decisions (and thus the error terms) than the sub-sample of small firms</p>
</div>
</section>
<section id="robust-standard-errors-3" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p>One of the key assumptions in OLS estimators is homoscedasticity</p>
<p>That is, the assumption is that the variance of the errors is homoscedastic (constant variance in all slices of X).</p>
<p>It means that throughout all observations, the error term shows the <strong>same variance</strong>.</p>
<p>If errors are not homoscedastic, we have the heteroscedasticity problem.</p>
<div class="fragment">
<p>Heteroskedasticity <strong>does not cause bias or inconsistency in the OLS estimators</strong> of the <span class="math inline">\(\beta\)</span> like the OVB would.</p>
<p>It also does not affect the <span class="math inline">\(R^2\)</span>.</p>
<p><strong>What Heteroscedasticity does is to bias the standard errors of the estimates.</strong></p>
</div>
</section>
<section id="robust-standard-errors-4" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>

<img data-src="files/homoscedasticity.png" class="r-stretch"></section>
<section id="robust-standard-errors-5" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>

<img data-src="files/heteroscedasticity.png" class="r-stretch"></section>
<section id="robust-standard-errors-6" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p><strong>Homoskedascticity</strong> = Constant <span class="math inline">\(\hat{\sigma}\)</span> to all slices of X.</p>
<p><strong>Heteroskedascticity</strong> = Non-constant <span class="math inline">\(\hat{\sigma}\)</span> to all slices of X.</p>
<p><strong>Without homoskedascticity, OLS no longer has the minimum mean squared errors</strong>, which means that the <em>estimated standard errors are biased</em>, which in turn creates bias in the t-stat and the inference you‚Äôll make with your model.</p>
<div class="fragment">
<p>Fortunately, we have an easy solution for that.</p>
<p><span class="math display">\[Var(\hat{\beta_1}) = \frac{\sum_i^n(x_i-\bar{x})^2\hat{\mu}^2}{SST^2_x}\]</span></p>
<p>This formula simply ‚Äúincludes‚Äù the heteroskedascticity in the calculation of <span class="math inline">\(Var(\hat{\beta_1})\)</span>, meaning this correct the estimated standard deviation to heteroskedascticity.</p>
<p>We call this correction as <strong>Robust Standard Errors</strong> (White Robust).</p>
</div>
<div class="fragment">
<p>In other words, you should always use Robust Standard Errors. It is easy to use it with R.</p>
</div>
</section>
<section id="robust-standard-errors-7" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p><strong>Using Robust Standard-errors.</strong></p>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1">R</a></li><li><a href="#tabset-11-2">Python</a></li><li><a href="#tabset-11-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a></a><span class="fu">library</span>(sandwich)</span>
<span id="cb64-2"><a></a><span class="fu">library</span>(foreign) </span>
<span id="cb64-3"><a></a><span class="fu">library</span>(lmtest)</span>
<span id="cb64-4"><a></a></span>
<span id="cb64-5"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.DTA"</span>)</span>
<span id="cb64-6"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe, <span class="at">data =</span> data)</span>
<span id="cb64-7"><a></a>robust_model <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">"HC3"</span>))</span>
<span id="cb64-8"><a></a>SE_beta_robust <span class="ot">&lt;-</span> robust_model[<span class="st">"roe"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb64-9"><a></a><span class="fu">cat</span>(<span class="st">"Robust Standard Error :"</span>, SE_beta_robust, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Robust Standard Error : 6.899434 </code></pre>
</div>
</div>
</div>
<div id="tabset-11-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb66-2"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb66-3"><a></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb66-4"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.DTA"</span>)</span>
<span id="cb66-5"><a></a>model <span class="op">=</span> smf.ols(<span class="st">"salary ~ roe"</span>, data<span class="op">=</span>data)</span>
<span id="cb66-6"><a></a>results <span class="op">=</span> model.fit(cov_type<span class="op">=</span><span class="st">'HC3'</span>)  </span>
<span id="cb66-7"><a></a>SE_beta_robust <span class="op">=</span> results.bse[<span class="st">'roe'</span>]</span>
<span id="cb66-8"><a></a><span class="bu">print</span>(<span class="st">"Robust Standard Error :"</span>, SE_beta_robust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Robust Standard Error : 6.899433834797476</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb68-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb68-2"><a></a></span>
<span id="cb68-3"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe </span>
<span id="cb68-4"><a></a><span class="kw">gen</span> beta_se_non = _se[roe]</span>
<span id="cb68-5"><a></a></span>
<span id="cb68-6"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe , <span class="kw">robust</span></span>
<span id="cb68-7"><a></a><span class="kw">gen</span> beta_se_summary = _se[roe]</span>
<span id="cb68-8"><a></a></span>
<span id="cb68-9"><a></a><span class="kw">di</span> <span class="st">"Standard Error (non-robust): "</span> <span class="kw">sum</span>(beta_se_non)</span>
<span id="cb68-10"><a></a><span class="kw">di</span> <span class="st">"Standard Error (robust): "</span> <span class="kw">sum</span>(beta_se_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (non-robust): 11.123251

Standard Error (robust): 6.8294482</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="robust-standard-errors-8" class="slide level2 smaller" data-background="#e0cafc">
<h2>Robust standard errors</h2>
<p>Notice that the standard errors have changed quite significantly in this example.</p>
<p>Usually, the robust standard errors are larger than the traditional ones in empirical works.</p>
<p><strong>But, in this example, they are smaller.</strong></p>
<div class="fragment">
<p>Perhaps more importantly:</p>
<p><strong>Once the S.e. change, you should expect that the t-stat of the estimates also change.</strong></p>
</div>
<div class="fragment">
<p><strong>Final comment</strong>: robust standard errors are robust in the case of homoskedasticity.</p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Thus, you should always use robust S.E.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="clustered-standard-errors" class="title-slide slide level1 smaller center" data-background="#edc5d1">
<h1>Clustered standard errors</h1>

</section>
<section id="clustered-standard-errors-1" class="slide level2 smaller" data-background="#edc5d1">
<h2>Clustered standard errors</h2>
<p>Almost always, someone will ask you whether you clustered your standard errors.</p>
<p><strong>The intuition is the following:</strong></p>
<ul>
<li><p>When you do not cluster, you are assuming that all observations are independently and identically distributed (i.i.d.), which may or may not be true.</p></li>
<li><p>Imagine you are studying the effect of class size on students achievement.</p></li>
<li><p>How much of a effect would <strong>have the teacher of a class</strong>?</p></li>
</ul>
<div class="fragment">
<ul>
<li><p>In this design, the teacher influences the achievement of all the students in the same class, and one teacher cannot be at two classes at the same time.</p></li>
<li><p>Thus, it would be wise to cluster the errors at the class-level. This assumes that the residual of each individual is clustered with the other individuals in the same class.</p></li>
</ul>
</div>
<div class="fragment">
<p>In principle, clustering solves any form of dependence of the residuals in your data.</p>
</div>
</section>
<section id="clustered-standard-errors-2" class="slide level2 smaller" data-background="#edc5d1">
<h2>Clustered standard errors</h2>
<p>In corporate finance/accounting research panel data research, the tradition is to cluster at the <strong>firm-level</strong>.</p>
<ul>
<li>The reason is that the observations of the same firm are not independent trough time, thus are correlated.</li>
</ul>
<p>But, there is a lot of debate about this decision.</p>
<div class="fragment">
<p>The tip is to cluster where the <strong>randomness exist</strong>. That is quite subjective. In the class size example, the <strong>randomness</strong> comes out of the teacher, since each teacher has their own ways of teaching (materials, resources, etc.).</p>
</div>
<div class="fragment">
<p>But, it is a good practice to stress this decision a bit in your own research by <strong>also showing results with clustered s.e. at the industry-level</strong>.</p>
</div>
<div class="fragment">
<p><strong>Final tip</strong>: usually the minimum number of cluster is about 30. Less than that might be insufficient (but, again, the guidance in this topic is very subjective).</p>
</div>
</section>
<section id="clustered-standard-errors-3" class="slide level2 smaller" data-background="#edc5d1">
<h2>Clustered standard errors</h2>
<p>The clustered standard errors are different because I am fabricating the clusters here for the sake of the coding.</p>
<p>In your real research, you would have the cluster at hands.</p>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1">R</a></li><li><a href="#tabset-12-2">Python</a></li><li><a href="#tabset-12-3">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a></a><span class="fu">library</span>(sandwich)</span>
<span id="cb70-2"><a></a><span class="fu">library</span>(foreign) </span>
<span id="cb70-3"><a></a><span class="fu">library</span>(lmtest)</span>
<span id="cb70-4"><a></a><span class="fu">library</span>(plm)</span>
<span id="cb70-5"><a></a></span>
<span id="cb70-6"><a></a>data <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"files/CEOSAL1.DTA"</span>)</span>
<span id="cb70-7"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> roe, <span class="at">data =</span> data)</span>
<span id="cb70-8"><a></a>robust_model <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">"HC3"</span>))</span>
<span id="cb70-9"><a></a><span class="co">#clustered</span></span>
<span id="cb70-10"><a></a>data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>, <span class="at">length.out =</span> <span class="fu">nrow</span>(data))</span>
<span id="cb70-11"><a></a>model <span class="ot">&lt;-</span> <span class="fu">plm</span>(salary <span class="sc">~</span> roe, <span class="at">data =</span> data, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"cluster"</span>))</span>
<span id="cb70-12"><a></a></span>
<span id="cb70-13"><a></a>clustered_se <span class="ot">&lt;-</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">"HC3"</span>, <span class="at">cluster =</span> <span class="st">"group"</span>)</span>
<span id="cb70-14"><a></a>SE_beta_clustered <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(clustered_se[<span class="st">"roe"</span>, <span class="st">"roe"</span>])</span>
<span id="cb70-15"><a></a></span>
<span id="cb70-16"><a></a><span class="fu">cat</span>(<span class="st">"Standard Error (robust):"</span>, SE_beta_robust, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (robust): 6.899434 </code></pre>
</div>
<details class="code-fold">
<summary>R</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a></a><span class="fu">cat</span>(<span class="st">"Standard Error (clustered)::"</span>, SE_beta_clustered, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (clustered):: 12.98492 </code></pre>
</div>
</div>
</div>
<div id="tabset-12-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb74-2"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb74-3"><a></a></span>
<span id="cb74-4"><a></a><span class="co"># Read the dataset</span></span>
<span id="cb74-5"><a></a>data <span class="op">=</span> pd.read_stata(<span class="st">"files/CEOSAL1.DTA"</span>)</span>
<span id="cb74-6"><a></a></span>
<span id="cb74-7"><a></a><span class="co"># Create a new variable 'cluster' with cluster numbers ranging from 1 to 35</span></span>
<span id="cb74-8"><a></a>data[<span class="st">'cluster'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">36</span>)) <span class="op">*</span> (<span class="bu">len</span>(data) <span class="op">//</span> <span class="dv">35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Length of values (175) does not match length of index (209)</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a></a><span class="co"># Fit the linear regression model</span></span>
<span id="cb76-2"><a></a>model <span class="op">=</span> sm.OLS(data[<span class="st">'salary'</span>], sm.add_constant(data[<span class="st">'roe'</span>])).fit()</span>
<span id="cb76-3"><a></a></span>
<span id="cb76-4"><a></a><span class="co"># Compute robust standard errors</span></span>
<span id="cb76-5"><a></a>robust_model <span class="op">=</span> model.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC3'</span>)</span>
<span id="cb76-6"><a></a>SE_beta_robust <span class="op">=</span> robust_model.cov_params().loc[<span class="st">'roe'</span>, <span class="st">'roe'</span>] <span class="op">**</span> <span class="fl">0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>'numpy.ndarray' object has no attribute 'loc'</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a></a><span class="co"># Fit the linear regression model with clustered standard errors</span></span>
<span id="cb78-2"><a></a>model_clustered <span class="op">=</span> sm.OLS(data[<span class="st">'salary'</span>], sm.add_constant(data[<span class="st">'roe'</span>])).fit(cov_type<span class="op">=</span><span class="st">'cluster'</span>, cov_kwds<span class="op">=</span>{<span class="st">'groups'</span>: data[<span class="st">'cluster'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>'cluster'</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a></a><span class="co"># Extract the clustered standard errors for 'roe'</span></span>
<span id="cb80-2"><a></a>clustered_se <span class="op">=</span> model_clustered.HC3_se.loc[<span class="st">'roe'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>name 'model_clustered' is not defined</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a></a><span class="bu">print</span>(<span class="st">"Robust Standard Error (HC3):"</span>, SE_beta_robust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Robust Standard Error (HC3): 6.899433834797476</code></pre>
</div>
<details class="code-fold">
<summary>Python</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a></a><span class="bu">print</span>(<span class="st">"Clustered Standard Error (HC3):"</span>, clustered_se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>name 'clustered_se' is not defined</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Stata</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb86-1"><a></a><span class="kw">use</span> <span class="st">"files/CEOSAL1.DTA"</span> , <span class="kw">replace</span></span>
<span id="cb86-2"><a></a></span>
<span id="cb86-3"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe </span>
<span id="cb86-4"><a></a><span class="kw">gen</span> beta_se_non = _se[roe]</span>
<span id="cb86-5"><a></a></span>
<span id="cb86-6"><a></a><span class="kw">qui</span> <span class="kw">reg</span> salary roe , <span class="kw">robust</span></span>
<span id="cb86-7"><a></a><span class="kw">gen</span> beta_se_summary = _se[roe]</span>
<span id="cb86-8"><a></a></span>
<span id="cb86-9"><a></a><span class="kw">egen</span> <span class="kw">cluster</span> = <span class="fu">seq</span>(), block(6)</span>
<span id="cb86-10"><a></a><span class="kw">qui</span> <span class="kw">regress</span> salary roe , <span class="kw">vce</span>(<span class="kw">cluster</span> <span class="kw">cluster</span>)</span>
<span id="cb86-11"><a></a><span class="kw">gen</span> SE_beta_clustered = _se[roe]</span>
<span id="cb86-12"><a></a></span>
<span id="cb86-13"><a></a><span class="kw">di</span> <span class="st">"Standard Error (non-robust): "</span> <span class="kw">sum</span>(beta_se_non)</span>
<span id="cb86-14"><a></a><span class="kw">di</span> <span class="st">"Standard Error (robust): "</span> <span class="kw">sum</span>(beta_se_summary)</span>
<span id="cb86-15"><a></a><span class="kw">di</span> <span class="st">"Standard Error (clustered): "</span> <span class="kw">sum</span>(SE_beta_clustered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error (non-robust): 11.123251

Standard Error (robust): 6.8294482

Standard Error (clustered): 6.4122176</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="thank-you" class="slide level2" data-background="#b1cafa">
<h2><strong>THANK YOU!</strong></h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>QUESTIONS?</strong></p>
<p><img data-src="figs/qa2.png" style="width:150.0%" data-heigth="150%"></p>
</div><div class="column" style="width:40%;">
<p><strong>Henrique C. Martins</strong></p>
<ul>
<li><a href="https://eaesp.fgv.br/en/people/henrique-castro-martins">FGV/EAESP</a></li>
<li><a href="https://henriquemartins.net/">Personal Website</a></li>
<li><a href="https://www.linkedin.com/in/henriquecastror/">LinkedIn</a></li>
<li><a href="http://lattes.cnpq.br/6076997472159785">Lattes</a></li>
<li><a href="https://scholar.google.com.br/citations?user=7gIfkRMAAAAJ&amp;hl=pt-BR&amp;oi=ao">Scholar</a><br>
</li>
</ul>
</div>
</div>
<div class="footer">

</div>

<div class="quarto-auto-generated-content">
<p><img src="figs/background8.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><strong>[<strong>Henrique C. Martins</strong>] [<a href="mailto:henrique.martins@fgv.br">henrique.martins@fgv.br</a>][Do not use without permission]</strong></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17260838442797754064","id":"9bfdc5e5d3b19473","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script type="text/javascript">
      Reveal.on('ready', event => {
        if (event.indexh === 0) {
          document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        }
      });
      Reveal.addEventListener('slidechanged', (event) => {
        if (event.indexh === 0) {
          Reveal.configure({ slideNumber: null });
          document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        }
        if (event.indexh === 1) {
          Reveal.configure({ slideNumber: 'c' });
          document.querySelector("div.has-logo > img.slide-logo").style.display = null;
        }
      });
    </script>
    

</body></html>